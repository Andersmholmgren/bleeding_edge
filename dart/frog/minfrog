#!/usr/bin/env node
//  ********** Library dart:core **************
//  ********** Natives dart:core **************
function $throw(e) {
  // If e is not a value, we can use V8's captureStackTrace utility method.
  // TODO(jmesserly): capture the stack trace on other JS engines.
  if (e && (typeof e == 'object') && Error.captureStackTrace) {
    // TODO(jmesserly): this will clobber the e.stack property
    Error.captureStackTrace(e, $throw);
  }
  throw e;
}
Object.defineProperty(Object.prototype, '$index', { value: function(i) {
  var proto = Object.getPrototypeOf(this);
  if (proto !== Object) {
    proto.$index = function(i) { return this[i]; }
  }
  return this[i];
}, enumerable: false, configurable: true});
Object.defineProperty(Array.prototype, '$index', { value: function(i) { 
  return this[i]; 
}, enumerable: false, configurable: true});
Object.defineProperty(String.prototype, '$index', { value: function(i) { 
  return this[i]; 
}, enumerable: false, configurable: true});
Object.defineProperty(Object.prototype, '$setindex', { value: function(i, value) {
  var proto = Object.getPrototypeOf(this);
  if (proto !== Object) {
    proto.$setindex = function(i, value) { return this[i] = value; }
  }
  return this[i] = value;
}, enumerable: false, configurable: true});
Object.defineProperty(Array.prototype, '$setindex', { value: function(i, value) { 
  return this[i] = value; }, enumerable: false, configurable: true});
function $eq(x, y) {
  if (x == null) return y == null;
  return (typeof(x) == 'number' && typeof(y) == 'number') ||
         (typeof(x) == 'boolean' && typeof(y) == 'boolean') ||
         (typeof(x) == 'string' && typeof(y) == 'string')
    ? x == y : x.$eq(y);
}
// TODO(jimhug): Should this or should it not match equals?
Object.defineProperty(Object.prototype, '$eq', { value: function(other) { 
  return this === other; 
}, enumerable: false, configurable: true });
function $mod(x, y) {
  if (typeof(x) == 'number' && typeof(y) == 'number') {
    var result = x % y;
    if (result == 0) {
      return 0;  // Make sure we don't return -0.0.
    } else if (result < 0) {
      if (y < 0) {
        return result - y;
      } else {
        return result + y;
      }
    }
    return result;
  } else {
    return x.$mod(y);
  }
}
function $ne(x, y) {
  if (x == null) return y != null;
  return (typeof(x) == 'number' && typeof(y) == 'number') ||
         (typeof(x) == 'boolean' && typeof(y) == 'boolean') ||
         (typeof(x) == 'string' && typeof(y) == 'string')
    ? x != y : !x.$eq(y);
}
function $truncdiv(x, y) {
  if (typeof(x) == 'number' && typeof(y) == 'number') {
    if (y == 0) $throw(new IntegerDivisionByZeroException());
    var tmp = x / y;
    return (tmp < 0) ? Math.ceil(tmp) : Math.floor(tmp);
  } else {
    return x.$truncdiv(y);
  }
}
// ********** Code for Object **************
Object.defineProperty(Object.prototype, "get$dynamic", { value: function() {
  "use strict"; return this;
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "noSuchMethod", { value: function(name, args) {
  $throw(new NoSuchMethodException(this, name, args));
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "_checkExtends$0", { value: function() {
  return this.noSuchMethod("_checkExtends", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "_checkNonStatic$1", { value: function($0) {
  return this.noSuchMethod("_checkNonStatic", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "_evalConstConstructor$2", { value: function($0, $1) {
  return this.noSuchMethod("_evalConstConstructor", [$0, $1]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "_get$3", { value: function($0, $1, $2) {
  return this.noSuchMethod("_get", [$0, $1, $2]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "_get$3$isDynamic", { value: function($0, $1, $2, isDynamic) {
  return this.noSuchMethod("_get", [$0, $1, $2, isDynamic]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "_get$4", { value: function($0, $1, $2, $3) {
  return this.noSuchMethod("_get", [$0, $1, $2, $3]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "_pushBlock$1", { value: function($0) {
  return this.noSuchMethod("_pushBlock", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "_set$4", { value: function($0, $1, $2, $3) {
  return this.noSuchMethod("_set", [$0, $1, $2, $3]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "_set$4$isDynamic", { value: function($0, $1, $2, $3, isDynamic) {
  return this.noSuchMethod("_set", [$0, $1, $2, $3, isDynamic]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "_set$5", { value: function($0, $1, $2, $3, $4) {
  return this.noSuchMethod("_set", [$0, $1, $2, $3, $4]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "_setindex$2", { value: function($0, $1) {
  return this.noSuchMethod("_setindex", [$0, $1]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "add$1", { value: function($0) {
  return this.noSuchMethod("add", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "addAll$1", { value: function($0) {
  return this.noSuchMethod("addAll", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "addDirectSubtype$1", { value: function($0) {
  return this.noSuchMethod("addDirectSubtype", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "addLast$1", { value: function($0) {
  return this.noSuchMethod("addLast", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "addMethod$2", { value: function($0, $1) {
  return this.noSuchMethod("addMethod", [$0, $1]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "addSource$1", { value: function($0) {
  return this.noSuchMethod("addSource", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "binop$4", { value: function($0, $1, $2, $3) {
  return this.noSuchMethod("binop", [$0, $1, $2, $3]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "block$0", { value: function() {
  return this.noSuchMethod("block", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "canInvoke$2", { value: function($0, $1) {
  return this.noSuchMethod("canInvoke", [$0, $1]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "checkFirstClass$1", { value: function($0) {
  return this.noSuchMethod("checkFirstClass", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "compareTo$1", { value: function($0) {
  return this.noSuchMethod("compareTo", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "compilationUnit$0", { value: function() {
  return this.noSuchMethod("compilationUnit", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "computeValue$0", { value: function() {
  return this.noSuchMethod("computeValue", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "contains$1", { value: function($0) {
  return this.noSuchMethod("contains", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "containsKey$1", { value: function($0) {
  return this.noSuchMethod("containsKey", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "convertTo$2", { value: function($0, $1) {
  return this.noSuchMethod("convertTo", [$0, $1]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "convertTo$3", { value: function($0, $1, $2) {
  return this.noSuchMethod("convertTo", [$0, $1, $2]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "copyWithNewType$2", { value: function($0, $1) {
  return this.noSuchMethod("copyWithNewType", [$0, $1]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "create$3$isFinal", { value: function($0, $1, $2, isFinal) {
  return this.noSuchMethod("create", [$0, $1, $2, isFinal]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "elapsedInMs$0", { value: function() {
  return this.noSuchMethod("elapsedInMs", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "end$0", { value: function() {
  return this.noSuchMethod("end", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "endsWith$1", { value: function($0) {
  return this.noSuchMethod("endsWith", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "ensureSubtypeOf$3", { value: function($0, $1, $2) {
  return this.noSuchMethod("ensureSubtypeOf", [$0, $1, $2]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "evalBody$2", { value: function($0, $1) {
  return this.noSuchMethod("evalBody", [$0, $1]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "every$1", { value: function($0) {
  return this.noSuchMethod("every", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "filter$1", { value: function($0) {
  return this.noSuchMethod("filter", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "findTypeByName$1", { value: function($0) {
  return this.noSuchMethod("findTypeByName", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "forEach$1", { value: function($0) {
  return this.noSuchMethod("forEach", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "genValue$2", { value: function($0, $1) {
  return this.noSuchMethod("genValue", [$0, $1]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "generate$1", { value: function($0) {
  return this.noSuchMethod("generate", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "getColumn$2", { value: function($0, $1) {
  return this.noSuchMethod("getColumn", [$0, $1]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "getConstructor$1", { value: function($0) {
  return this.noSuchMethod("getConstructor", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "getFactory$2", { value: function($0, $1) {
  return this.noSuchMethod("getFactory", [$0, $1]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "getGlobalValue$0", { value: function() {
  return this.noSuchMethod("getGlobalValue", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "getKeys$0", { value: function() {
  return this.noSuchMethod("getKeys", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "getLine$1", { value: function($0) {
  return this.noSuchMethod("getLine", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "getMember$1", { value: function($0) {
  return this.noSuchMethod("getMember", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "getOrMakeConcreteType$1", { value: function($0) {
  return this.noSuchMethod("getOrMakeConcreteType", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "getValues$0", { value: function() {
  return this.noSuchMethod("getValues", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "get_$3", { value: function($0, $1, $2) {
  return this.noSuchMethod("get_", [$0, $1, $2]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "hasNext$0", { value: function() {
  return this.noSuchMethod("hasNext", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "hashCode$0", { value: function() {
  return this.noSuchMethod("hashCode", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "indexOf$1", { value: function($0) {
  return this.noSuchMethod("indexOf", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "initFields$0", { value: function() {
  return this.noSuchMethod("initFields", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "instanceOf$3$isTrue$forceCheck", { value: function($0, $1, $2, isTrue, forceCheck) {
  return this.noSuchMethod("instanceOf", [$0, $1, $2, isTrue, forceCheck]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "instanceOf$4", { value: function($0, $1, $2, $3) {
  return this.noSuchMethod("instanceOf", [$0, $1, $2, $3]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "invoke$4", { value: function($0, $1, $2, $3) {
  return this.noSuchMethod("invoke", [$0, $1, $2, $3]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "invoke$4$isDynamic", { value: function($0, $1, $2, $3, isDynamic) {
  return this.noSuchMethod("invoke", [$0, $1, $2, $3, isDynamic]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "invoke$5", { value: function($0, $1, $2, $3, $4) {
  return this.noSuchMethod("invoke", [$0, $1, $2, $3, $4]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "invokeNoSuchMethod$4", { value: function($0, $1, $2, $3) {
  return this.noSuchMethod("invokeNoSuchMethod", [$0, $1, $2, $3]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "is$List", { value: function() {
  return false;
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "is$RegExp", { value: function() {
  return false;
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "isAssignable$1", { value: function($0) {
  return this.noSuchMethod("isAssignable", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "isEmpty$0", { value: function() {
  return this.noSuchMethod("isEmpty", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "isSubtypeOf$1", { value: function($0) {
  return this.noSuchMethod("isSubtypeOf", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "iterator$0", { value: function() {
  return this.noSuchMethod("iterator", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "last$0", { value: function() {
  return this.noSuchMethod("last", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "lookup$2", { value: function($0, $1) {
  return this.noSuchMethod("lookup", [$0, $1]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "markUsed$0", { value: function() {
  return this.noSuchMethod("markUsed", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "namesInOrder$1", { value: function($0) {
  return this.noSuchMethod("namesInOrder", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "needsConversion$1", { value: function($0) {
  return this.noSuchMethod("needsConversion", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "next$0", { value: function() {
  return this.noSuchMethod("next", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "postResolveChecks$0", { value: function() {
  return this.noSuchMethod("postResolveChecks", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "provideFieldSyntax$0", { value: function() {
  return this.noSuchMethod("provideFieldSyntax", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "providePropertySyntax$0", { value: function() {
  return this.noSuchMethod("providePropertySyntax", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "removeLast$0", { value: function() {
  return this.noSuchMethod("removeLast", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "replaceFirst$2", { value: function($0, $1) {
  return this.noSuchMethod("replaceFirst", [$0, $1]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "resolve$0", { value: function() {
  return this.noSuchMethod("resolve", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "resolveType$2", { value: function($0, $1) {
  return this.noSuchMethod("resolveType", [$0, $1]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "resolveTypeParams$1", { value: function($0) {
  return this.noSuchMethod("resolveTypeParams", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "run$0", { value: function() {
  return this.noSuchMethod("run", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "setDefinition$1", { value: function($0) {
  return this.noSuchMethod("setDefinition", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "set_$4", { value: function($0, $1, $2, $3) {
  return this.noSuchMethod("set_", [$0, $1, $2, $3]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "some$1", { value: function($0) {
  return this.noSuchMethod("some", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "sort$1", { value: function($0) {
  return this.noSuchMethod("sort", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "start$0", { value: function() {
  return this.noSuchMethod("start", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "startsWith$1", { value: function($0) {
  return this.noSuchMethod("startsWith", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "stop$0", { value: function() {
  return this.noSuchMethod("stop", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "substring$1", { value: function($0) {
  return this.noSuchMethod("substring", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "substring$2", { value: function($0, $1) {
  return this.noSuchMethod("substring", [$0, $1]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "toRadixString$1", { value: function($0) {
  return this.noSuchMethod("toRadixString", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "toString$0", { value: function() {
  return this.toString();
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "unop$3", { value: function($0, $1, $2) {
  return this.noSuchMethod("unop", [$0, $1, $2]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "visit$1", { value: function($0) {
  return this.noSuchMethod("visit", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "visitBinaryExpression$1", { value: function($0) {
  return this.noSuchMethod("visitBinaryExpression", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "visitPostfixExpression$1", { value: function($0) {
  return this.noSuchMethod("visitPostfixExpression", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "visitSources$0", { value: function() {
  return this.noSuchMethod("visitSources", []);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "write$1", { value: function($0) {
  return this.noSuchMethod("write", [$0]);
}, enumerable: false, configurable: true });
Object.defineProperty(Object.prototype, "writeDefinition$2", { value: function($0, $1) {
  return this.noSuchMethod("writeDefinition", [$0, $1]);
}, enumerable: false, configurable: true });
// ********** Code for Clock **************
function Clock() {}
Clock.now = function() {
  return new Date().getTime();
}
Clock.frequency = function() {
  return (1000);
}
// ********** Code for IllegalAccessException **************
function IllegalAccessException() {

}
IllegalAccessException.prototype.toString = function() {
  return "Attempt to modify an immutable object";
}
IllegalAccessException.prototype.toString$0 = IllegalAccessException.prototype.toString;
// ********** Code for NoSuchMethodException **************
function NoSuchMethodException(_receiver, _functionName, _arguments) {
  this._receiver = _receiver;
  this._functionName = _functionName;
  this._arguments = _arguments;
}
NoSuchMethodException.prototype.toString = function() {
  var sb = new StringBufferImpl("");
  for (var i = (0);
   i < this._arguments.get$length(); i++) {
    if (i > (0)) {
      sb.add(", ");
    }
    sb.add(this._arguments.$index(i));
  }
  sb.add("]");
  return ("NoSuchMethodException - receiver: '" + this._receiver + "' ") + ("function name: '" + this._functionName + "' arguments: [" + sb + "]");
}
NoSuchMethodException.prototype.toString$0 = NoSuchMethodException.prototype.toString;
// ********** Code for ClosureArgumentMismatchException **************
function ClosureArgumentMismatchException() {

}
ClosureArgumentMismatchException.prototype.toString = function() {
  return "Closure argument mismatch";
}
ClosureArgumentMismatchException.prototype.toString$0 = ClosureArgumentMismatchException.prototype.toString;
// ********** Code for ObjectNotClosureException **************
function ObjectNotClosureException() {

}
ObjectNotClosureException.prototype.toString = function() {
  return "Object is not closure";
}
ObjectNotClosureException.prototype.toString$0 = ObjectNotClosureException.prototype.toString;
// ********** Code for StackOverflowException **************
function StackOverflowException() {

}
StackOverflowException.prototype.toString = function() {
  return "Stack Overflow";
}
StackOverflowException.prototype.toString$0 = StackOverflowException.prototype.toString;
// ********** Code for BadNumberFormatException **************
function BadNumberFormatException(_s) {
  this._s = _s;
}
BadNumberFormatException.prototype.toString = function() {
  return ("BadNumberFormatException: '" + this._s + "'");
}
BadNumberFormatException.prototype.toString$0 = BadNumberFormatException.prototype.toString;
// ********** Code for NullPointerException **************
function NullPointerException() {

}
NullPointerException.prototype.toString = function() {
  return "NullPointerException";
}
NullPointerException.prototype.toString$0 = NullPointerException.prototype.toString;
// ********** Code for NoMoreElementsException **************
function NoMoreElementsException() {

}
NoMoreElementsException.prototype.toString = function() {
  return "NoMoreElementsException";
}
NoMoreElementsException.prototype.toString$0 = NoMoreElementsException.prototype.toString;
// ********** Code for EmptyQueueException **************
function EmptyQueueException() {

}
EmptyQueueException.prototype.toString = function() {
  return "EmptyQueueException";
}
EmptyQueueException.prototype.toString$0 = EmptyQueueException.prototype.toString;
// ********** Code for dart_core_Function **************
Function.prototype.to$call$0 = function() {
  this.call$0 = this._genStub(0);
  this.to$call$0 = function() { return this.call$0; };
  return this.call$0;
};
Function.prototype.call$0 = function() {
  return this.to$call$0()();
};
function to$call$0(f) { return f && f.to$call$0(); }
Function.prototype.to$call$1 = function() {
  this.call$1 = this._genStub(1);
  this.to$call$1 = function() { return this.call$1; };
  return this.call$1;
};
Function.prototype.call$1 = function($0) {
  return this.to$call$1()($0);
};
function to$call$1(f) { return f && f.to$call$1(); }
Function.prototype.to$call$2 = function() {
  this.call$2 = this._genStub(2);
  this.to$call$2 = function() { return this.call$2; };
  return this.call$2;
};
Function.prototype.call$2 = function($0, $1) {
  return this.to$call$2()($0, $1);
};
function to$call$2(f) { return f && f.to$call$2(); }
// ********** Code for Math **************
Math.parseInt = function(str) {
  var ret = parseInt(str);
    if (isNaN(ret)) $throw(new BadNumberFormatException(str));
    return ret;
}
Math.parseDouble = function(str) {
  var ret = parseFloat(str);
    if (isNaN(ret) && str != 'NaN') $throw(new BadNumberFormatException(str));
    return ret;
}
Math.min = function(a, b) {
  if (a == b) return a;
    if (a < b) {
      if (isNaN(b)) return b;
      else return a;
    }
    if (isNaN(a)) return a;
    else return b;
}
// ********** Code for Strings **************
function Strings() {}
Strings.String$fromCharCodes$factory = function(charCodes) {
  return StringBase.createFromCharCodes(charCodes);
}
Strings.join = function(strings, separator) {
  return StringBase.join(strings, separator);
}
// ********** Code for top level **************
function print(obj) {
  return _print(obj);
}
function _print(obj) {
  if (typeof console == 'object') {
    if (obj) obj = obj.toString();
    console.log(obj);
  } else {
    write(obj);
    write('\n');
  }
}
function _toDartException(e) {
  function attachStack(dartEx) {
    // TODO(jmesserly): setting the stack property is not a long term solution.
    var stack = e.stack;
    // The stack contains the error message, and the stack is all that is
    // printed (the exception's toString() is never called).  Make the Dart
    // exception's toString() be the dominant message.
    if (typeof stack == 'string') {
      var message = dartEx.toString();
      if (/^(Type|Range)Error:/.test(stack)) {
        // Indent JS message (it can be helpful) so new message stands out.
        stack = '    (' + stack.substring(0, stack.indexOf('\n')) + ')\n' +
                stack.substring(stack.indexOf('\n') + 1);
      }
      stack = message + '\n' + stack;
    }
    dartEx.stack = stack;
    return dartEx;
  }

  if (e instanceof TypeError) {
    switch(e.type) {
      case 'property_not_function':
      case 'called_non_callable':
        if (e.arguments[0] == null) {
          return attachStack(new NullPointerException());
        } else {
          return attachStack(new ObjectNotClosureException());
        }
        break;
      case 'non_object_property_call':
      case 'non_object_property_load':
        return attachStack(new NullPointerException());
        break;
      case 'undefined_method':
        var mname = e.arguments[0];
        if (typeof(mname) == 'string' && (mname.indexOf('call$') == 0
            || mname == 'call' || mname == 'apply')) {
          return attachStack(new ObjectNotClosureException());
        } else {
          // TODO(jmesserly): fix noSuchMethod on operators so we don't hit this
          return attachStack(new NoSuchMethodException('', e.arguments[0], []));
        }
        break;
    }
  } else if (e instanceof RangeError) {
    if (e.message.indexOf('call stack') >= 0) {
      return attachStack(new StackOverflowException());
    }
  }
  return e;
}
//  ********** Library dart:coreimpl **************
// ********** Code for ListFactory **************
ListFactory = Array;
Object.defineProperty(ListFactory.prototype, "is$List", { value: function(){return true}, enumerable: false, configurable: true });
ListFactory.ListFactory$from$factory = function(other) {
  var list = [];
  for (var $$i = other.iterator(); $$i.hasNext$0(); ) {
    var e = $$i.next$0();
    list.add$1(e);
  }
  return list;
}
Object.defineProperty(ListFactory.prototype, "get$length", { value: function() { return this.length; }, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "set$length", { value: function(value) { return this.length = value; }, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "add", { value: function(value) {
  this.push(value);
}, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "addLast", { value: function(value) {
  this.push(value);
}, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "addAll", { value: function(collection) {
  for (var $$i = collection.iterator(); $$i.hasNext$0(); ) {
    var item = $$i.next$0();
    this.add(item);
  }
}, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "clear", { value: function() {
  this.set$length((0));
}, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "removeLast", { value: function() {
  return this.pop();
}, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "last", { value: function() {
  return this[this.get$length() - (1)];
}, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "getRange", { value: function(start, length) {
  return this.slice(start, start + length);
}, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "isEmpty", { value: function() {
  return this.get$length() == (0);
}, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "iterator", { value: function() {
  return new ListIterator(this);
}, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "add$1", { value: ListFactory.prototype.add, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "addAll$1", { value: ListFactory.prototype.addAll, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "addLast$1", { value: ListFactory.prototype.addLast, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "every$1", { value: function($0) {
  return this.every(to$call$1($0));
}, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "filter$1", { value: function($0) {
  return this.filter(to$call$1($0));
}, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "forEach$1", { value: function($0) {
  return this.forEach(to$call$1($0));
}, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "indexOf$1", { value: ListFactory.prototype.indexOf, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "isEmpty$0", { value: ListFactory.prototype.isEmpty, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "iterator$0", { value: ListFactory.prototype.iterator, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "last$0", { value: ListFactory.prototype.last, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "removeLast$0", { value: ListFactory.prototype.removeLast, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "some$1", { value: function($0) {
  return this.some(to$call$1($0));
}, enumerable: false, configurable: true });
Object.defineProperty(ListFactory.prototype, "sort$1", { value: function($0) {
  return this.sort(to$call$2($0));
}, enumerable: false, configurable: true });
ListFactory_E = ListFactory;
ListFactory_Expression = ListFactory;
ListFactory_K = ListFactory;
ListFactory_dart_core_String = ListFactory;
ListFactory_V = ListFactory;
ListFactory_Value = ListFactory;
ListFactory_int = ListFactory;
// ********** Code for ListIterator **************
function ListIterator(array) {
  this._array = array;
  this._pos = (0);
}
ListIterator.prototype.hasNext = function() {
  return this._array.get$length() > this._pos;
}
ListIterator.prototype.next = function() {
  if (!this.hasNext()) {
    $throw(const$0005);
  }
  return this._array.$index(this._pos++);
}
ListIterator.prototype.hasNext$0 = ListIterator.prototype.hasNext;
ListIterator.prototype.next$0 = ListIterator.prototype.next;
// ********** Code for ImmutableList **************
/** Implements extends for Dart classes on JavaScript prototypes. */
function $inherits(child, parent) {
  if (child.prototype.__proto__) {
    child.prototype.__proto__ = parent.prototype;
  } else {
    function tmp() {};
    tmp.prototype = parent.prototype;
    child.prototype = new tmp();
    child.prototype.constructor = child;
  }
}
$inherits(ImmutableList, ListFactory_E);
function ImmutableList(length) {
  this._length = length;
  Array.call(this, length);
}
ImmutableList.ImmutableList$from$factory = function(other) {
  var list = new ImmutableList(other.get$length());
  for (var i = (0);
   i < other.get$length(); i++) {
    list._setindex$2(i, other.$index(i));
  }
  return list;
}
ImmutableList.prototype.get$length = function() {
  return this._length;
}
ImmutableList.prototype.set$length = function(length) {
  $throw(const$0007);
}
Object.defineProperty(ImmutableList.prototype, "length", {
  get: ImmutableList.prototype.get$length,
  set: ImmutableList.prototype.set$length
});
ImmutableList.prototype._setindex = function(index, value) {
  return this[index] = value;
}
ImmutableList.prototype.$setindex = function(index, value) {
  $throw(const$0007);
}
ImmutableList.prototype.sort = function(compare) {
  $throw(const$0007);
}
ImmutableList.prototype.add = function(element) {
  $throw(const$0007);
}
ImmutableList.prototype.addLast = function(element) {
  $throw(const$0007);
}
ImmutableList.prototype.addAll = function(elements) {
  $throw(const$0007);
}
ImmutableList.prototype.clear = function() {
  $throw(const$0007);
}
ImmutableList.prototype.removeLast = function() {
  $throw(const$0007);
}
ImmutableList.prototype.toString = function() {
  return ListFactory.ListFactory$from$factory(this).toString();
}
ImmutableList.prototype._setindex$2 = ImmutableList.prototype._setindex;
ImmutableList.prototype.add$1 = ImmutableList.prototype.add;
ImmutableList.prototype.addAll$1 = ImmutableList.prototype.addAll;
ImmutableList.prototype.addLast$1 = ImmutableList.prototype.addLast;
ImmutableList.prototype.removeLast$0 = ImmutableList.prototype.removeLast;
ImmutableList.prototype.sort$1 = function($0) {
  return this.sort(to$call$2($0));
};
ImmutableList.prototype.toString$0 = ImmutableList.prototype.toString;
// ********** Code for NumImplementation **************
NumImplementation = Number;
NumImplementation.prototype.isNaN = function() {
  'use strict'; return isNaN(this);
}
NumImplementation.prototype.isNegative = function() {
  'use strict'; return this == 0 ? (1 / this) < 0 : this < 0;
}
NumImplementation.prototype.hashCode = function() {
  'use strict'; return this & 0x1FFFFFFF;
}
NumImplementation.prototype.toDouble = function() {
  'use strict'; return this + 0;
}
NumImplementation.prototype.toRadixString = function(radix) {
  'use strict'; return this.toString(radix)
}
NumImplementation.prototype.compareTo = function(other) {
  var thisValue = this.toDouble();
  if (thisValue < other) {
    return (-1);
  }
  else if (thisValue > other) {
    return (1);
  }
  else if (thisValue == other) {
    if (thisValue == (0)) {
      var thisIsNegative = this.isNegative();
      var otherIsNegative = other.isNegative();
      if ($eq(thisIsNegative, otherIsNegative)) return (0);
      if (thisIsNegative) return (-1);
      return (1);
    }
    return (0);
  }
  else if (this.isNaN()) {
    if (other.isNaN()) {
      return (0);
    }
    return (1);
  }
  else {
    return (-1);
  }
}
NumImplementation.prototype.compareTo$1 = NumImplementation.prototype.compareTo;
NumImplementation.prototype.hashCode$0 = NumImplementation.prototype.hashCode;
NumImplementation.prototype.toRadixString$1 = NumImplementation.prototype.toRadixString;
// ********** Code for HashMapImplementation **************
function HashMapImplementation() {
  this._numberOfEntries = (0);
  this._numberOfDeleted = (0);
  this._loadLimit = HashMapImplementation._computeLoadLimit((8));
  this._keys = new Array((8));
  this._values = new Array((8));
}
HashMapImplementation.HashMapImplementation$from$factory = function(other) {
  var result = new HashMapImplementation_K$V();
  other.forEach((function (key, value) {
    result.$setindex(key, value);
  })
  );
  return result;
}
HashMapImplementation._computeLoadLimit = function(capacity) {
  return $truncdiv((capacity * (3)), (4));
}
HashMapImplementation._firstProbe = function(hashCode, length) {
  return hashCode & (length - (1));
}
HashMapImplementation._nextProbe = function(currentProbe, numberOfProbes, length) {
  return (currentProbe + numberOfProbes) & (length - (1));
}
HashMapImplementation.prototype._probeForAdding = function(key) {
  var hash = HashMapImplementation._firstProbe(key.hashCode$0(), this._keys.get$length());
  var numberOfProbes = (1);
  var initialHash = hash;
  var insertionIndex = (-1);
  while (true) {
    var existingKey = this._keys.$index(hash);
    if (existingKey == null) {
      if (insertionIndex < (0)) return hash;
      return insertionIndex;
    }
    else if ($eq(existingKey, key)) {
      return hash;
    }
    else if ((insertionIndex < (0)) && (const$0001 == existingKey)) {
      insertionIndex = hash;
    }
    hash = HashMapImplementation._nextProbe(hash, numberOfProbes++, this._keys.get$length());
  }
}
HashMapImplementation.prototype._probeForLookup = function(key) {
  var hash = HashMapImplementation._firstProbe(key.hashCode$0(), this._keys.get$length());
  var numberOfProbes = (1);
  var initialHash = hash;
  while (true) {
    var existingKey = this._keys.$index(hash);
    if (existingKey == null) return (-1);
    if ($eq(existingKey, key)) return hash;
    hash = HashMapImplementation._nextProbe(hash, numberOfProbes++, this._keys.get$length());
  }
}
HashMapImplementation.prototype._ensureCapacity = function() {
  var newNumberOfEntries = this._numberOfEntries + (1);
  if (newNumberOfEntries >= this._loadLimit) {
    this._grow(this._keys.get$length() * (2));
    return;
  }
  var capacity = this._keys.get$length();
  var numberOfFreeOrDeleted = capacity - newNumberOfEntries;
  var numberOfFree = numberOfFreeOrDeleted - this._numberOfDeleted;
  if (this._numberOfDeleted > numberOfFree) {
    this._grow(this._keys.get$length());
  }
}
HashMapImplementation._isPowerOfTwo = function(x) {
  return ((x & (x - (1))) == (0));
}
HashMapImplementation.prototype._grow = function(newCapacity) {
  var capacity = this._keys.get$length();
  this._loadLimit = HashMapImplementation._computeLoadLimit(newCapacity);
  var oldKeys = this._keys;
  var oldValues = this._values;
  this._keys = new Array(newCapacity);
  this._values = new Array(newCapacity);
  for (var i = (0);
   i < capacity; i++) {
    var key = oldKeys.$index(i);
    if (key == null || key == const$0001) {
      continue;
    }
    var value = oldValues.$index(i);
    var newIndex = this._probeForAdding(key);
    this._keys.$setindex(newIndex, key);
    this._values.$setindex(newIndex, value);
  }
  this._numberOfDeleted = (0);
}
HashMapImplementation.prototype.$setindex = function(key, value) {
  this._ensureCapacity();
  var index = this._probeForAdding(key);
  if ((this._keys.$index(index) == null) || (this._keys.$index(index) == const$0001)) {
    this._numberOfEntries++;
  }
  this._keys.$setindex(index, key);
  this._values.$setindex(index, value);
}
HashMapImplementation.prototype.$index = function(key) {
  var index = this._probeForLookup(key);
  if (index < (0)) return null;
  return this._values.$index(index);
}
HashMapImplementation.prototype.putIfAbsent = function(key, ifAbsent) {
  var index = this._probeForLookup(key);
  if (index >= (0)) return this._values.$index(index);
  var value = ifAbsent();
  this.$setindex(key, value);
  return value;
}
HashMapImplementation.prototype.remove = function(key) {
  var index = this._probeForLookup(key);
  if (index >= (0)) {
    this._numberOfEntries--;
    var value = this._values.$index(index);
    this._values.$setindex(index);
    this._keys.$setindex(index, const$0001);
    this._numberOfDeleted++;
    return value;
  }
  return null;
}
HashMapImplementation.prototype.isEmpty = function() {
  return this._numberOfEntries == (0);
}
HashMapImplementation.prototype.get$length = function() {
  return this._numberOfEntries;
}
HashMapImplementation.prototype.forEach = function(f) {
  var length = this._keys.get$length();
  for (var i = (0);
   i < length; i++) {
    if ((this._keys.$index(i) != null) && (this._keys.$index(i) != const$0001)) {
      f(this._keys.$index(i), this._values.$index(i));
    }
  }
}
HashMapImplementation.prototype.getKeys = function() {
  var list = new Array(this.get$length());
  var i = (0);
  this.forEach(function _(key, value) {
    list.$setindex(i++, key);
  }
  );
  return list;
}
HashMapImplementation.prototype.getValues = function() {
  var list = new Array(this.get$length());
  var i = (0);
  this.forEach(function _(key, value) {
    list.$setindex(i++, value);
  }
  );
  return list;
}
HashMapImplementation.prototype.containsKey = function(key) {
  return (this._probeForLookup(key) != (-1));
}
HashMapImplementation.prototype.containsKey$1 = HashMapImplementation.prototype.containsKey;
HashMapImplementation.prototype.forEach$1 = function($0) {
  return this.forEach(to$call$2($0));
};
HashMapImplementation.prototype.getKeys$0 = HashMapImplementation.prototype.getKeys;
HashMapImplementation.prototype.getValues$0 = HashMapImplementation.prototype.getValues;
HashMapImplementation.prototype.isEmpty$0 = HashMapImplementation.prototype.isEmpty;
// ********** Code for HashMapImplementation_E$E **************
$inherits(HashMapImplementation_E$E, HashMapImplementation);
function HashMapImplementation_E$E() {
  this._numberOfEntries = (0);
  this._numberOfDeleted = (0);
  this._loadLimit = HashMapImplementation._computeLoadLimit((8));
  this._keys = new Array((8));
  this._values = new Array((8));
}
HashMapImplementation_E$E._computeLoadLimit = function(capacity) {
  return $truncdiv((capacity * (3)), (4));
}
HashMapImplementation_E$E._firstProbe = function(hashCode, length) {
  return hashCode & (length - (1));
}
HashMapImplementation_E$E._nextProbe = function(currentProbe, numberOfProbes, length) {
  return (currentProbe + numberOfProbes) & (length - (1));
}
HashMapImplementation_E$E.prototype._probeForAdding = function(key) {
  var hash = HashMapImplementation._firstProbe(key.hashCode$0(), this._keys.get$length());
  var numberOfProbes = (1);
  var initialHash = hash;
  var insertionIndex = (-1);
  while (true) {
    var existingKey = this._keys.$index(hash);
    if (existingKey == null) {
      if (insertionIndex < (0)) return hash;
      return insertionIndex;
    }
    else if ($eq(existingKey, key)) {
      return hash;
    }
    else if ((insertionIndex < (0)) && (const$0001 == existingKey)) {
      insertionIndex = hash;
    }
    hash = HashMapImplementation._nextProbe(hash, numberOfProbes++, this._keys.get$length());
  }
}
HashMapImplementation_E$E.prototype._probeForLookup = function(key) {
  var hash = HashMapImplementation._firstProbe(key.hashCode$0(), this._keys.get$length());
  var numberOfProbes = (1);
  var initialHash = hash;
  while (true) {
    var existingKey = this._keys.$index(hash);
    if (existingKey == null) return (-1);
    if ($eq(existingKey, key)) return hash;
    hash = HashMapImplementation._nextProbe(hash, numberOfProbes++, this._keys.get$length());
  }
}
HashMapImplementation_E$E.prototype._ensureCapacity = function() {
  var newNumberOfEntries = this._numberOfEntries + (1);
  if (newNumberOfEntries >= this._loadLimit) {
    this._grow(this._keys.get$length() * (2));
    return;
  }
  var capacity = this._keys.get$length();
  var numberOfFreeOrDeleted = capacity - newNumberOfEntries;
  var numberOfFree = numberOfFreeOrDeleted - this._numberOfDeleted;
  if (this._numberOfDeleted > numberOfFree) {
    this._grow(this._keys.get$length());
  }
}
HashMapImplementation_E$E._isPowerOfTwo = function(x) {
  return ((x & (x - (1))) == (0));
}
HashMapImplementation_E$E.prototype._grow = function(newCapacity) {
  var capacity = this._keys.get$length();
  this._loadLimit = HashMapImplementation._computeLoadLimit(newCapacity);
  var oldKeys = this._keys;
  var oldValues = this._values;
  this._keys = new Array(newCapacity);
  this._values = new Array(newCapacity);
  for (var i = (0);
   i < capacity; i++) {
    var key = oldKeys.$index(i);
    if (key == null || key == const$0001) {
      continue;
    }
    var value = oldValues.$index(i);
    var newIndex = this._probeForAdding(key);
    this._keys.$setindex(newIndex, key);
    this._values.$setindex(newIndex, value);
  }
  this._numberOfDeleted = (0);
}
HashMapImplementation_E$E.prototype.$setindex = function(key, value) {
  this._ensureCapacity();
  var index = this._probeForAdding(key);
  if ((this._keys.$index(index) == null) || (this._keys.$index(index) == const$0001)) {
    this._numberOfEntries++;
  }
  this._keys.$setindex(index, key);
  this._values.$setindex(index, value);
}
HashMapImplementation_E$E.prototype.remove = function(key) {
  var index = this._probeForLookup(key);
  if (index >= (0)) {
    this._numberOfEntries--;
    var value = this._values.$index(index);
    this._values.$setindex(index);
    this._keys.$setindex(index, const$0001);
    this._numberOfDeleted++;
    return value;
  }
  return null;
}
HashMapImplementation_E$E.prototype.isEmpty = function() {
  return this._numberOfEntries == (0);
}
HashMapImplementation_E$E.prototype.forEach = function(f) {
  var length = this._keys.get$length();
  for (var i = (0);
   i < length; i++) {
    if ((this._keys.$index(i) != null) && (this._keys.$index(i) != const$0001)) {
      f(this._keys.$index(i), this._values.$index(i));
    }
  }
}
HashMapImplementation_E$E.prototype.getKeys = function() {
  var list = new Array(this.get$length());
  var i = (0);
  this.forEach(function _(key, value) {
    list.$setindex(i++, key);
  }
  );
  return list;
}
HashMapImplementation_E$E.prototype.containsKey = function(key) {
  return (this._probeForLookup(key) != (-1));
}
// ********** Code for HashMapImplementation_K$DoubleLinkedQueueEntry_KeyValuePair_K$V **************
$inherits(HashMapImplementation_K$DoubleLinkedQueueEntry_KeyValuePair_K$V, HashMapImplementation);
function HashMapImplementation_K$DoubleLinkedQueueEntry_KeyValuePair_K$V() {}
// ********** Code for HashMapImplementation_K$V **************
$inherits(HashMapImplementation_K$V, HashMapImplementation);
function HashMapImplementation_K$V() {
  this._numberOfEntries = (0);
  this._numberOfDeleted = (0);
  this._loadLimit = HashMapImplementation._computeLoadLimit((8));
  this._keys = new Array((8));
  this._values = new Array((8));
}
HashMapImplementation_K$V._computeLoadLimit = function(capacity) {
  return $truncdiv((capacity * (3)), (4));
}
HashMapImplementation_K$V._firstProbe = function(hashCode, length) {
  return hashCode & (length - (1));
}
HashMapImplementation_K$V._nextProbe = function(currentProbe, numberOfProbes, length) {
  return (currentProbe + numberOfProbes) & (length - (1));
}
HashMapImplementation_K$V.prototype._probeForAdding = function(key) {
  var hash = HashMapImplementation._firstProbe(key.hashCode$0(), this._keys.get$length());
  var numberOfProbes = (1);
  var initialHash = hash;
  var insertionIndex = (-1);
  while (true) {
    var existingKey = this._keys.$index(hash);
    if (existingKey == null) {
      if (insertionIndex < (0)) return hash;
      return insertionIndex;
    }
    else if ($eq(existingKey, key)) {
      return hash;
    }
    else if ((insertionIndex < (0)) && (const$0001 == existingKey)) {
      insertionIndex = hash;
    }
    hash = HashMapImplementation._nextProbe(hash, numberOfProbes++, this._keys.get$length());
  }
}
HashMapImplementation_K$V.prototype._probeForLookup = function(key) {
  var hash = HashMapImplementation._firstProbe(key.hashCode$0(), this._keys.get$length());
  var numberOfProbes = (1);
  var initialHash = hash;
  while (true) {
    var existingKey = this._keys.$index(hash);
    if (existingKey == null) return (-1);
    if ($eq(existingKey, key)) return hash;
    hash = HashMapImplementation._nextProbe(hash, numberOfProbes++, this._keys.get$length());
  }
}
HashMapImplementation_K$V.prototype._ensureCapacity = function() {
  var newNumberOfEntries = this._numberOfEntries + (1);
  if (newNumberOfEntries >= this._loadLimit) {
    this._grow(this._keys.get$length() * (2));
    return;
  }
  var capacity = this._keys.get$length();
  var numberOfFreeOrDeleted = capacity - newNumberOfEntries;
  var numberOfFree = numberOfFreeOrDeleted - this._numberOfDeleted;
  if (this._numberOfDeleted > numberOfFree) {
    this._grow(this._keys.get$length());
  }
}
HashMapImplementation_K$V._isPowerOfTwo = function(x) {
  return ((x & (x - (1))) == (0));
}
HashMapImplementation_K$V.prototype._grow = function(newCapacity) {
  var capacity = this._keys.get$length();
  this._loadLimit = HashMapImplementation._computeLoadLimit(newCapacity);
  var oldKeys = this._keys;
  var oldValues = this._values;
  this._keys = new Array(newCapacity);
  this._values = new Array(newCapacity);
  for (var i = (0);
   i < capacity; i++) {
    var key = oldKeys.$index(i);
    if (key == null || key == const$0001) {
      continue;
    }
    var value = oldValues.$index(i);
    var newIndex = this._probeForAdding(key);
    this._keys.$setindex(newIndex, key);
    this._values.$setindex(newIndex, value);
  }
  this._numberOfDeleted = (0);
}
HashMapImplementation_K$V.prototype.$setindex = function(key, value) {
  this._ensureCapacity();
  var index = this._probeForAdding(key);
  if ((this._keys.$index(index) == null) || (this._keys.$index(index) == const$0001)) {
    this._numberOfEntries++;
  }
  this._keys.$setindex(index, key);
  this._values.$setindex(index, value);
}
HashMapImplementation_K$V.prototype.$index = function(key) {
  var index = this._probeForLookup(key);
  if (index < (0)) return null;
  return this._values.$index(index);
}
HashMapImplementation_K$V.prototype.putIfAbsent = function(key, ifAbsent) {
  var index = this._probeForLookup(key);
  if (index >= (0)) return this._values.$index(index);
  var value = ifAbsent();
  this.$setindex(key, value);
  return value;
}
HashMapImplementation_K$V.prototype.isEmpty = function() {
  return this._numberOfEntries == (0);
}
HashMapImplementation_K$V.prototype.forEach = function(f) {
  var length = this._keys.get$length();
  for (var i = (0);
   i < length; i++) {
    if ((this._keys.$index(i) != null) && (this._keys.$index(i) != const$0001)) {
      f(this._keys.$index(i), this._values.$index(i));
    }
  }
}
HashMapImplementation_K$V.prototype.getKeys = function() {
  var list = new Array(this.get$length());
  var i = (0);
  this.forEach(function _(key, value) {
    list.$setindex(i++, key);
  }
  );
  return list;
}
HashMapImplementation_K$V.prototype.getValues = function() {
  var list = new Array(this.get$length());
  var i = (0);
  this.forEach(function _(key, value) {
    list.$setindex(i++, value);
  }
  );
  return list;
}
HashMapImplementation_K$V.prototype.containsKey = function(key) {
  return (this._probeForLookup(key) != (-1));
}
// ********** Code for HashMapImplementation_dart_core_String$Value **************
$inherits(HashMapImplementation_dart_core_String$Value, HashMapImplementation);
function HashMapImplementation_dart_core_String$Value() {
  this._numberOfEntries = (0);
  this._numberOfDeleted = (0);
  this._loadLimit = HashMapImplementation._computeLoadLimit((8));
  this._keys = new Array((8));
  this._values = new Array((8));
}
HashMapImplementation_dart_core_String$Value._computeLoadLimit = function(capacity) {
  return $truncdiv((capacity * (3)), (4));
}
HashMapImplementation_dart_core_String$Value._firstProbe = function(hashCode, length) {
  return hashCode & (length - (1));
}
HashMapImplementation_dart_core_String$Value._nextProbe = function(currentProbe, numberOfProbes, length) {
  return (currentProbe + numberOfProbes) & (length - (1));
}
HashMapImplementation_dart_core_String$Value.prototype._probeForAdding = function(key) {
  var hash = HashMapImplementation._firstProbe(key.hashCode(), this._keys.get$length());
  var numberOfProbes = (1);
  var initialHash = hash;
  var insertionIndex = (-1);
  while (true) {
    var existingKey = this._keys.$index(hash);
    if (existingKey == null) {
      if (insertionIndex < (0)) return hash;
      return insertionIndex;
    }
    else if ($eq(existingKey, key)) {
      return hash;
    }
    else if ((insertionIndex < (0)) && (const$0001 == existingKey)) {
      insertionIndex = hash;
    }
    hash = HashMapImplementation._nextProbe(hash, numberOfProbes++, this._keys.get$length());
  }
}
HashMapImplementation_dart_core_String$Value.prototype._probeForLookup = function(key) {
  var hash = HashMapImplementation._firstProbe(key.hashCode(), this._keys.get$length());
  var numberOfProbes = (1);
  var initialHash = hash;
  while (true) {
    var existingKey = this._keys.$index(hash);
    if (existingKey == null) return (-1);
    if ($eq(existingKey, key)) return hash;
    hash = HashMapImplementation._nextProbe(hash, numberOfProbes++, this._keys.get$length());
  }
}
HashMapImplementation_dart_core_String$Value.prototype._ensureCapacity = function() {
  var newNumberOfEntries = this._numberOfEntries + (1);
  if (newNumberOfEntries >= this._loadLimit) {
    this._grow(this._keys.get$length() * (2));
    return;
  }
  var capacity = this._keys.get$length();
  var numberOfFreeOrDeleted = capacity - newNumberOfEntries;
  var numberOfFree = numberOfFreeOrDeleted - this._numberOfDeleted;
  if (this._numberOfDeleted > numberOfFree) {
    this._grow(this._keys.get$length());
  }
}
HashMapImplementation_dart_core_String$Value._isPowerOfTwo = function(x) {
  return ((x & (x - (1))) == (0));
}
HashMapImplementation_dart_core_String$Value.prototype._grow = function(newCapacity) {
  var capacity = this._keys.get$length();
  this._loadLimit = HashMapImplementation._computeLoadLimit(newCapacity);
  var oldKeys = this._keys;
  var oldValues = this._values;
  this._keys = new Array(newCapacity);
  this._values = new Array(newCapacity);
  for (var i = (0);
   i < capacity; i++) {
    var key = oldKeys.$index(i);
    if (key == null || key == const$0001) {
      continue;
    }
    var value = oldValues.$index(i);
    var newIndex = this._probeForAdding(key);
    this._keys.$setindex(newIndex, key);
    this._values.$setindex(newIndex, value);
  }
  this._numberOfDeleted = (0);
}
HashMapImplementation_dart_core_String$Value.prototype.$setindex = function(key, value) {
  this._ensureCapacity();
  var index = this._probeForAdding(key);
  if ((this._keys.$index(index) == null) || (this._keys.$index(index) == const$0001)) {
    this._numberOfEntries++;
  }
  this._keys.$setindex(index, key);
  this._values.$setindex(index, value);
}
HashMapImplementation_dart_core_String$Value.prototype.$index = function(key) {
  var index = this._probeForLookup(key);
  if (index < (0)) return null;
  return this._values.$index(index);
}
HashMapImplementation_dart_core_String$Value.prototype.forEach = function(f) {
  var length = this._keys.get$length();
  for (var i = (0);
   i < length; i++) {
    if ((this._keys.$index(i) != null) && (this._keys.$index(i) != const$0001)) {
      f(this._keys.$index(i), this._values.$index(i));
    }
  }
}
HashMapImplementation_dart_core_String$Value.prototype.containsKey = function(key) {
  return (this._probeForLookup(key) != (-1));
}
// ********** Code for HashSetImplementation **************
function HashSetImplementation() {
  this._backingMap = new HashMapImplementation_E$E();
}
HashSetImplementation.HashSetImplementation$from$factory = function(other) {
  var set = new HashSetImplementation_E();
  for (var $$i = other.iterator(); $$i.hasNext$0(); ) {
    var e = $$i.next$0();
    set.add(e);
  }
  return set;
}
HashSetImplementation.prototype.add = function(value) {
  this._backingMap.$setindex(value, value);
}
HashSetImplementation.prototype.contains = function(value) {
  return this._backingMap.containsKey(value);
}
HashSetImplementation.prototype.remove = function(value) {
  if (!this._backingMap.containsKey(value)) return false;
  this._backingMap.remove(value);
  return true;
}
HashSetImplementation.prototype.addAll = function(collection) {
  var $this = this; // closure support
  collection.forEach(function _(value) {
    $this.add(value);
  }
  );
}
HashSetImplementation.prototype.forEach = function(f) {
  this._backingMap.forEach(function _(key, value) {
    f(key);
  }
  );
}
HashSetImplementation.prototype.filter = function(f) {
  var result = new HashSetImplementation();
  this._backingMap.forEach(function _(key, value) {
    if (f(key)) result.add(key);
  }
  );
  return result;
}
HashSetImplementation.prototype.every = function(f) {
  var keys = this._backingMap.getKeys();
  return keys.every(f);
}
HashSetImplementation.prototype.some = function(f) {
  var keys = this._backingMap.getKeys();
  return keys.some(f);
}
HashSetImplementation.prototype.isEmpty = function() {
  return this._backingMap.isEmpty();
}
HashSetImplementation.prototype.get$length = function() {
  return this._backingMap.get$length();
}
HashSetImplementation.prototype.iterator = function() {
  return new HashSetIterator_E(this);
}
HashSetImplementation.prototype.add$1 = HashSetImplementation.prototype.add;
HashSetImplementation.prototype.addAll$1 = HashSetImplementation.prototype.addAll;
HashSetImplementation.prototype.contains$1 = HashSetImplementation.prototype.contains;
HashSetImplementation.prototype.every$1 = function($0) {
  return this.every(to$call$1($0));
};
HashSetImplementation.prototype.filter$1 = function($0) {
  return this.filter(to$call$1($0));
};
HashSetImplementation.prototype.forEach$1 = function($0) {
  return this.forEach(to$call$1($0));
};
HashSetImplementation.prototype.isEmpty$0 = HashSetImplementation.prototype.isEmpty;
HashSetImplementation.prototype.iterator$0 = HashSetImplementation.prototype.iterator;
HashSetImplementation.prototype.some$1 = function($0) {
  return this.some(to$call$1($0));
};
// ********** Code for HashSetImplementation_E **************
$inherits(HashSetImplementation_E, HashSetImplementation);
function HashSetImplementation_E() {
  this._backingMap = new HashMapImplementation_E$E();
}
// ********** Code for HashSetImplementation_Library **************
$inherits(HashSetImplementation_Library, HashSetImplementation);
function HashSetImplementation_Library() {}
// ********** Code for HashSetImplementation_dart_core_String **************
$inherits(HashSetImplementation_dart_core_String, HashSetImplementation);
function HashSetImplementation_dart_core_String() {}
// ********** Code for HashSetImplementation_Type **************
$inherits(HashSetImplementation_Type, HashSetImplementation);
function HashSetImplementation_Type() {}
// ********** Code for HashSetIterator **************
function HashSetIterator(set_) {
  this._entries = set_._backingMap._keys;
  this._nextValidIndex = (-1);
  this._advance();
}
HashSetIterator.prototype.hasNext = function() {
  if (this._nextValidIndex >= this._entries.get$length()) return false;
  if (this._entries.$index(this._nextValidIndex) == const$0001) {
    this._advance();
  }
  return this._nextValidIndex < this._entries.get$length();
}
HashSetIterator.prototype.next = function() {
  if (!this.hasNext()) {
    $throw(const$0005);
  }
  var res = this._entries.$index(this._nextValidIndex);
  this._advance();
  return res;
}
HashSetIterator.prototype._advance = function() {
  var length = this._entries.get$length();
  var entry;
  var deletedKey = const$0001;
  do {
    if (++this._nextValidIndex >= length) break;
    entry = this._entries.$index(this._nextValidIndex);
  }
  while ((entry == null) || (entry == deletedKey))
}
HashSetIterator.prototype.hasNext$0 = HashSetIterator.prototype.hasNext;
HashSetIterator.prototype.next$0 = HashSetIterator.prototype.next;
// ********** Code for HashSetIterator_E **************
$inherits(HashSetIterator_E, HashSetIterator);
function HashSetIterator_E(set_) {
  this._nextValidIndex = (-1);
  this._entries = set_._backingMap._keys;
  this._advance();
}
HashSetIterator_E.prototype._advance = function() {
  var length = this._entries.get$length();
  var entry;
  var deletedKey = const$0001;
  do {
    if (++this._nextValidIndex >= length) break;
    entry = this._entries.$index(this._nextValidIndex);
  }
  while ((entry == null) || (entry == deletedKey))
}
// ********** Code for _DeletedKeySentinel **************
function _DeletedKeySentinel() {

}
// ********** Code for KeyValuePair **************
function KeyValuePair(key, value) {
  this.value = value;
  this.key = key;
}
KeyValuePair.prototype.get$value = function() { return this.value; };
KeyValuePair.prototype.set$value = function(value) { return this.value = value; };
// ********** Code for KeyValuePair_K$V **************
$inherits(KeyValuePair_K$V, KeyValuePair);
function KeyValuePair_K$V(key, value) {
  this.key = key;
  this.value = value;
}
// ********** Code for LinkedHashMapImplementation **************
function LinkedHashMapImplementation() {
  this._map = new HashMapImplementation();
  this._list = new DoubleLinkedQueue_KeyValuePair_K$V();
}
LinkedHashMapImplementation.prototype.$setindex = function(key, value) {
  if (this._map.containsKey(key)) {
    this._map.$index(key).get$element().set$value(value);
  }
  else {
    this._list.addLast(new KeyValuePair_K$V(key, value));
    this._map.$setindex(key, this._list.lastEntry());
  }
}
LinkedHashMapImplementation.prototype.$index = function(key) {
  var entry = this._map.$index(key);
  if (entry == null) return null;
  return entry.get$element().get$value();
}
LinkedHashMapImplementation.prototype.putIfAbsent = function(key, ifAbsent) {
  var value = this.$index(key);
  if ((this.$index(key) == null) && !(this.containsKey(key))) {
    value = ifAbsent();
    this.$setindex(key, value);
  }
  return value;
}
LinkedHashMapImplementation.prototype.getKeys = function() {
  var list = new Array(this.get$length());
  var index = (0);
  this._list.forEach(function _(entry) {
    list.$setindex(index++, entry.key);
  }
  );
  return list;
}
LinkedHashMapImplementation.prototype.getValues = function() {
  var list = new Array(this.get$length());
  var index = (0);
  this._list.forEach(function _(entry) {
    list.$setindex(index++, entry.value);
  }
  );
  return list;
}
LinkedHashMapImplementation.prototype.forEach = function(f) {
  this._list.forEach(function _(entry) {
    f(entry.key, entry.value);
  }
  );
}
LinkedHashMapImplementation.prototype.containsKey = function(key) {
  return this._map.containsKey(key);
}
LinkedHashMapImplementation.prototype.get$length = function() {
  return this._map.get$length();
}
LinkedHashMapImplementation.prototype.isEmpty = function() {
  return this.get$length() == (0);
}
LinkedHashMapImplementation.prototype.containsKey$1 = LinkedHashMapImplementation.prototype.containsKey;
LinkedHashMapImplementation.prototype.forEach$1 = function($0) {
  return this.forEach(to$call$2($0));
};
LinkedHashMapImplementation.prototype.getKeys$0 = LinkedHashMapImplementation.prototype.getKeys;
LinkedHashMapImplementation.prototype.getValues$0 = LinkedHashMapImplementation.prototype.getValues;
LinkedHashMapImplementation.prototype.isEmpty$0 = LinkedHashMapImplementation.prototype.isEmpty;
// ********** Code for DoubleLinkedQueueEntry **************
function DoubleLinkedQueueEntry(e) {
  this._element = e;
}
DoubleLinkedQueueEntry.prototype._link = function(p, n) {
  this._next = n;
  this._previous = p;
  p._next = this;
  n._previous = this;
}
DoubleLinkedQueueEntry.prototype.prepend = function(e) {
  new DoubleLinkedQueueEntry_E(e)._link(this._previous, this);
}
DoubleLinkedQueueEntry.prototype.remove = function() {
  this._previous._next = this._next;
  this._next._previous = this._previous;
  this._next = null;
  this._previous = null;
  return this._element;
}
DoubleLinkedQueueEntry.prototype._asNonSentinelEntry = function() {
  return this;
}
DoubleLinkedQueueEntry.prototype.previousEntry = function() {
  return this._previous._asNonSentinelEntry();
}
DoubleLinkedQueueEntry.prototype.get$element = function() {
  return this._element;
}
// ********** Code for DoubleLinkedQueueEntry_E **************
$inherits(DoubleLinkedQueueEntry_E, DoubleLinkedQueueEntry);
function DoubleLinkedQueueEntry_E(e) {
  this._element = e;
}
DoubleLinkedQueueEntry_E.prototype._link = function(p, n) {
  this._next = n;
  this._previous = p;
  p._next = this;
  n._previous = this;
}
DoubleLinkedQueueEntry_E.prototype.prepend = function(e) {
  new DoubleLinkedQueueEntry_E(e)._link(this._previous, this);
}
DoubleLinkedQueueEntry_E.prototype.remove = function() {
  this._previous._next = this._next;
  this._next._previous = this._previous;
  this._next = null;
  this._previous = null;
  return this._element;
}
DoubleLinkedQueueEntry_E.prototype._asNonSentinelEntry = function() {
  return this;
}
DoubleLinkedQueueEntry_E.prototype.previousEntry = function() {
  return this._previous._asNonSentinelEntry();
}
// ********** Code for DoubleLinkedQueueEntry_KeyValuePair_K$V **************
$inherits(DoubleLinkedQueueEntry_KeyValuePair_K$V, DoubleLinkedQueueEntry);
function DoubleLinkedQueueEntry_KeyValuePair_K$V(e) {
  this._element = e;
}
DoubleLinkedQueueEntry_KeyValuePair_K$V.prototype._link = function(p, n) {
  this._next = n;
  this._previous = p;
  p._next = this;
  n._previous = this;
}
DoubleLinkedQueueEntry_KeyValuePair_K$V.prototype.prepend = function(e) {
  new DoubleLinkedQueueEntry_KeyValuePair_K$V(e)._link(this._previous, this);
}
DoubleLinkedQueueEntry_KeyValuePair_K$V.prototype._asNonSentinelEntry = function() {
  return this;
}
DoubleLinkedQueueEntry_KeyValuePair_K$V.prototype.previousEntry = function() {
  return this._previous._asNonSentinelEntry();
}
// ********** Code for _DoubleLinkedQueueEntrySentinel **************
$inherits(_DoubleLinkedQueueEntrySentinel, DoubleLinkedQueueEntry_E);
function _DoubleLinkedQueueEntrySentinel() {
  DoubleLinkedQueueEntry_E.call(this, null);
  this._link(this, this);
}
_DoubleLinkedQueueEntrySentinel.prototype.remove = function() {
  $throw(const$0000);
}
_DoubleLinkedQueueEntrySentinel.prototype._asNonSentinelEntry = function() {
  return null;
}
_DoubleLinkedQueueEntrySentinel.prototype.get$element = function() {
  $throw(const$0000);
}
// ********** Code for _DoubleLinkedQueueEntrySentinel_E **************
$inherits(_DoubleLinkedQueueEntrySentinel_E, _DoubleLinkedQueueEntrySentinel);
function _DoubleLinkedQueueEntrySentinel_E() {
  DoubleLinkedQueueEntry_E.call(this, null);
  this._link(this, this);
}
// ********** Code for _DoubleLinkedQueueEntrySentinel_KeyValuePair_K$V **************
$inherits(_DoubleLinkedQueueEntrySentinel_KeyValuePair_K$V, _DoubleLinkedQueueEntrySentinel);
function _DoubleLinkedQueueEntrySentinel_KeyValuePair_K$V() {
  DoubleLinkedQueueEntry_KeyValuePair_K$V.call(this, null);
  this._link(this, this);
}
// ********** Code for DoubleLinkedQueue **************
function DoubleLinkedQueue() {
  this._sentinel = new _DoubleLinkedQueueEntrySentinel_E();
}
DoubleLinkedQueue.DoubleLinkedQueue$from$factory = function(other) {
  var list = new DoubleLinkedQueue();
  for (var $$i = other.iterator(); $$i.hasNext$0(); ) {
    var e = $$i.next$0();
    list.addLast(e);
  }
  return list;
}
DoubleLinkedQueue.prototype.addLast = function(value) {
  this._sentinel.prepend(value);
}
DoubleLinkedQueue.prototype.add = function(value) {
  this.addLast(value);
}
DoubleLinkedQueue.prototype.addAll = function(collection) {
  for (var $$i = collection.iterator(); $$i.hasNext$0(); ) {
    var e = $$i.next$0();
    this.add(e);
  }
}
DoubleLinkedQueue.prototype.removeLast = function() {
  return this._sentinel._previous.remove();
}
DoubleLinkedQueue.prototype.removeFirst = function() {
  return this._sentinel._next.remove();
}
DoubleLinkedQueue.prototype.last = function() {
  return this._sentinel._previous.get$element();
}
DoubleLinkedQueue.prototype.lastEntry = function() {
  return this._sentinel.previousEntry();
}
DoubleLinkedQueue.prototype.get$length = function() {
  var counter = (0);
  this.forEach(function _(element) {
    counter++;
  }
  );
  return counter;
}
DoubleLinkedQueue.prototype.isEmpty = function() {
  return (this._sentinel._next == this._sentinel);
}
DoubleLinkedQueue.prototype.forEach = function(f) {
  var entry = this._sentinel._next;
  while (entry != this._sentinel) {
    var nextEntry = entry._next;
    f(entry._element);
    entry = nextEntry;
  }
}
DoubleLinkedQueue.prototype.every = function(f) {
  var entry = this._sentinel._next;
  while (entry != this._sentinel) {
    var nextEntry = entry._next;
    if (!f(entry._element)) return false;
    entry = nextEntry;
  }
  return true;
}
DoubleLinkedQueue.prototype.some = function(f) {
  var entry = this._sentinel._next;
  while (entry != this._sentinel) {
    var nextEntry = entry._next;
    if (f(entry._element)) return true;
    entry = nextEntry;
  }
  return false;
}
DoubleLinkedQueue.prototype.filter = function(f) {
  var other = new DoubleLinkedQueue();
  var entry = this._sentinel._next;
  while (entry != this._sentinel) {
    var nextEntry = entry._next;
    if (f(entry._element)) other.addLast(entry._element);
    entry = nextEntry;
  }
  return other;
}
DoubleLinkedQueue.prototype.iterator = function() {
  return new _DoubleLinkedQueueIterator_E(this._sentinel);
}
DoubleLinkedQueue.prototype.add$1 = DoubleLinkedQueue.prototype.add;
DoubleLinkedQueue.prototype.addAll$1 = DoubleLinkedQueue.prototype.addAll;
DoubleLinkedQueue.prototype.addLast$1 = DoubleLinkedQueue.prototype.addLast;
DoubleLinkedQueue.prototype.every$1 = function($0) {
  return this.every(to$call$1($0));
};
DoubleLinkedQueue.prototype.filter$1 = function($0) {
  return this.filter(to$call$1($0));
};
DoubleLinkedQueue.prototype.forEach$1 = function($0) {
  return this.forEach(to$call$1($0));
};
DoubleLinkedQueue.prototype.isEmpty$0 = DoubleLinkedQueue.prototype.isEmpty;
DoubleLinkedQueue.prototype.iterator$0 = DoubleLinkedQueue.prototype.iterator;
DoubleLinkedQueue.prototype.last$0 = DoubleLinkedQueue.prototype.last;
DoubleLinkedQueue.prototype.removeLast$0 = DoubleLinkedQueue.prototype.removeLast;
DoubleLinkedQueue.prototype.some$1 = function($0) {
  return this.some(to$call$1($0));
};
// ********** Code for DoubleLinkedQueue_E **************
$inherits(DoubleLinkedQueue_E, DoubleLinkedQueue);
function DoubleLinkedQueue_E() {}
// ********** Code for DoubleLinkedQueue_KeyValuePair_K$V **************
$inherits(DoubleLinkedQueue_KeyValuePair_K$V, DoubleLinkedQueue);
function DoubleLinkedQueue_KeyValuePair_K$V() {
  this._sentinel = new _DoubleLinkedQueueEntrySentinel_KeyValuePair_K$V();
}
DoubleLinkedQueue_KeyValuePair_K$V.prototype.addLast = function(value) {
  this._sentinel.prepend(value);
}
DoubleLinkedQueue_KeyValuePair_K$V.prototype.lastEntry = function() {
  return this._sentinel.previousEntry();
}
DoubleLinkedQueue_KeyValuePair_K$V.prototype.forEach = function(f) {
  var entry = this._sentinel._next;
  while (entry != this._sentinel) {
    var nextEntry = entry._next;
    f(entry._element);
    entry = nextEntry;
  }
}
// ********** Code for _DoubleLinkedQueueIterator **************
function _DoubleLinkedQueueIterator(_sentinel) {
  this._sentinel = _sentinel;
  this._currentEntry = this._sentinel;
}
_DoubleLinkedQueueIterator.prototype.hasNext = function() {
  return this._currentEntry._next != this._sentinel;
}
_DoubleLinkedQueueIterator.prototype.next = function() {
  if (!this.hasNext()) {
    $throw(const$0005);
  }
  this._currentEntry = this._currentEntry._next;
  return this._currentEntry.get$element();
}
_DoubleLinkedQueueIterator.prototype.hasNext$0 = _DoubleLinkedQueueIterator.prototype.hasNext;
_DoubleLinkedQueueIterator.prototype.next$0 = _DoubleLinkedQueueIterator.prototype.next;
// ********** Code for _DoubleLinkedQueueIterator_E **************
$inherits(_DoubleLinkedQueueIterator_E, _DoubleLinkedQueueIterator);
function _DoubleLinkedQueueIterator_E(_sentinel) {
  this._sentinel = _sentinel;
  this._currentEntry = this._sentinel;
}
// ********** Code for StopwatchImplementation **************
function StopwatchImplementation() {
  this._start = null;
  this._stop = null;
}
StopwatchImplementation.prototype.start = function() {
  if (this._start == null) {
    this._start = Clock.now();
  }
  else {
    if (this._stop == null) {
      return;
    }
    this._start = Clock.now() - (this._stop - this._start);
  }
}
StopwatchImplementation.prototype.get$start = function() {
  return this.start.bind(this);
}
StopwatchImplementation.prototype.stop = function() {
  if (this._start == null) {
    return;
  }
  this._stop = Clock.now();
}
StopwatchImplementation.prototype.elapsed = function() {
  if (this._start == null) {
    return (0);
  }
  return (this._stop == null) ? (Clock.now() - this._start) : (this._stop - this._start);
}
StopwatchImplementation.prototype.elapsedInMs = function() {
  return $truncdiv((this.elapsed() * (1000)), this.frequency());
}
StopwatchImplementation.prototype.frequency = function() {
  return Clock.frequency();
}
StopwatchImplementation.prototype.elapsedInMs$0 = StopwatchImplementation.prototype.elapsedInMs;
StopwatchImplementation.prototype.start$0 = StopwatchImplementation.prototype.start;
StopwatchImplementation.prototype.stop$0 = StopwatchImplementation.prototype.stop;
// ********** Code for StringBufferImpl **************
function StringBufferImpl(content) {
  this.clear();
  this.add(content);
}
StringBufferImpl.prototype.get$length = function() {
  return this._length;
}
StringBufferImpl.prototype.isEmpty = function() {
  return this._length == (0);
}
StringBufferImpl.prototype.add = function(obj) {
  var str = obj.toString();
  if (str == null || str.isEmpty()) return this;
  this._buffer.add(str);
  this._length += str.length;
  return this;
}
StringBufferImpl.prototype.addAll = function(objects) {
  for (var $$i = objects.iterator(); $$i.hasNext$0(); ) {
    var obj = $$i.next$0();
    this.add(obj);
  }
  return this;
}
StringBufferImpl.prototype.clear = function() {
  this._buffer = new Array();
  this._length = (0);
  return this;
}
StringBufferImpl.prototype.toString = function() {
  if (this._buffer.get$length() == (0)) return "";
  if (this._buffer.get$length() == (1)) return this._buffer.$index((0));
  var result = StringBase.concatAll(this._buffer);
  this._buffer.clear();
  this._buffer.add(result);
  return result;
}
StringBufferImpl.prototype.add$1 = StringBufferImpl.prototype.add;
StringBufferImpl.prototype.addAll$1 = StringBufferImpl.prototype.addAll;
StringBufferImpl.prototype.isEmpty$0 = StringBufferImpl.prototype.isEmpty;
StringBufferImpl.prototype.toString$0 = StringBufferImpl.prototype.toString;
// ********** Code for StringBase **************
function StringBase() {}
StringBase.createFromCharCodes = function(charCodes) {
  if (Object.getPrototypeOf(charCodes) !== Array.prototype) {
    charCodes = new ListFactory.ListFactory$from$factory(charCodes);
  }
  return String.fromCharCode.apply(null, charCodes);
}
StringBase.join = function(strings, separator) {
  if (strings.get$length() == (0)) return "";
  var s = strings.$index((0));
  for (var i = (1);
   i < strings.get$length(); i++) {
    s = s + separator + strings.$index(i);
  }
  return s;
}
StringBase.concatAll = function(strings) {
  return StringBase.join(strings, "");
}
// ********** Code for StringImplementation **************
StringImplementation = String;
StringImplementation.prototype.get$length = function() { return this.length; };
StringImplementation.prototype.endsWith = function(other) {
    'use strict';
    if (other.length > this.length) return false;
    return other == this.substring(this.length - other.length);
}
StringImplementation.prototype.startsWith = function(other) {
    'use strict';
    if (other.length > this.length) return false;
    return other == this.substring(0, other.length);
}
StringImplementation.prototype.isEmpty = function() {
  return this.length == (0);
}
StringImplementation.prototype.contains = function(pattern, startIndex) {
  'use strict'; return this.indexOf(pattern, startIndex) >= 0;
}
StringImplementation.prototype._replaceFirst = function(from, to) {
  'use strict';return this.replace(from, to);
}
StringImplementation.prototype._replaceRegExp = function(from, to) {
  'use strict';return this.replace(from.re, to);
}
StringImplementation.prototype.replaceFirst = function(from, to) {
  if ((typeof(from) == 'string')) return this._replaceFirst(from, to);
  if (!!(from && from.is$RegExp())) return this._replaceRegExp(from, to);
  var $$list = from.allMatches(this);
  for (var $$i = $$list.iterator(); $$i.hasNext$0(); ) {
    var match = $$i.next$0();
    return this.substring((0), match.start$0()) + to + this.substring(match.end$0());
  }
}
StringImplementation.prototype._replaceAll = function(from, to) {
  'use strict';
  from = new RegExp(from.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&"), 'g');
  to = to.replace(/\$/g, '$$$$'); // Escape sequences are fun!
  return this.replace(from, to);
}
StringImplementation.prototype.replaceAll = function(from, to) {
  if ((typeof(from) == 'string')) return this._replaceAll(from, to);
  if (!!(from && from.is$RegExp())) return this._replaceRegExp(from.get$dynamic().get$_global(), to);
  var buffer = new StringBufferImpl("");
  var lastMatchEnd = (0);
  var $$list = from.allMatches(this);
  for (var $$i = $$list.iterator(); $$i.hasNext$0(); ) {
    var match = $$i.next$0();
    buffer.add$1(this.substring(lastMatchEnd, match.start$0()));
    buffer.add$1(to);
    lastMatchEnd = match.end$0();
  }
  buffer.add$1(this.substring(lastMatchEnd));
}
StringImplementation.prototype.hashCode = function() {
      'use strict';
      var hash = 0;
      for (var i = 0; i < this.length; i++) {
        hash = 0x1fffffff & (hash + this.charCodeAt(i));
        hash = 0x1fffffff & (hash + ((0x0007ffff & hash) << 10));
        hash ^= hash >> 6;
      }

      hash = 0x1fffffff & (hash + ((0x03ffffff & hash) << 3));
      hash ^= hash >> 11;
      return 0x1fffffff & (hash + ((0x00003fff & hash) << 15));
}
StringImplementation.prototype.compareTo = function(other) {
  'use strict'; return this == other ? 0 : this < other ? -1 : 1;
}
StringImplementation.prototype.compareTo$1 = StringImplementation.prototype.compareTo;
StringImplementation.prototype.contains$1 = StringImplementation.prototype.contains;
StringImplementation.prototype.endsWith$1 = StringImplementation.prototype.endsWith;
StringImplementation.prototype.hashCode$0 = StringImplementation.prototype.hashCode;
StringImplementation.prototype.indexOf$1 = StringImplementation.prototype.indexOf;
StringImplementation.prototype.isEmpty$0 = StringImplementation.prototype.isEmpty;
StringImplementation.prototype.replaceFirst$2 = StringImplementation.prototype.replaceFirst;
StringImplementation.prototype.startsWith$1 = StringImplementation.prototype.startsWith;
StringImplementation.prototype.substring$1 = StringImplementation.prototype.substring;
StringImplementation.prototype.substring$2 = StringImplementation.prototype.substring;
// ********** Code for Collections **************
function Collections() {}
Collections.forEach = function(iterable, f) {
  for (var $$i = iterable.iterator(); $$i.hasNext$0(); ) {
    var e = $$i.next$0();
    f(e);
  }
}
Collections.some = function(iterable, f) {
  for (var $$i = iterable.iterator(); $$i.hasNext$0(); ) {
    var e = $$i.next$0();
    if (f(e)) return true;
  }
  return false;
}
Collections.every = function(iterable, f) {
  for (var $$i = iterable.iterator(); $$i.hasNext$0(); ) {
    var e = $$i.next$0();
    if (!f(e)) return false;
  }
  return true;
}
Collections.filter = function(source, destination, f) {
  for (var $$i = source.iterator(); $$i.hasNext$0(); ) {
    var e = $$i.next$0();
    if (f(e)) destination.add(e);
  }
  return destination;
}
// ********** Code for _Worker **************
// ********** Code for _ArgumentMismatchException **************
$inherits(_ArgumentMismatchException, ClosureArgumentMismatchException);
function _ArgumentMismatchException(_message) {
  this._dart_coreimpl_message = _message;
  ClosureArgumentMismatchException.call(this);
}
_ArgumentMismatchException.prototype.toString = function() {
  return ("Closure argument mismatch: " + this._dart_coreimpl_message);
}
_ArgumentMismatchException.prototype.toString$0 = _ArgumentMismatchException.prototype.toString;
// ********** Code for _FunctionImplementation **************
_FunctionImplementation = Function;
_FunctionImplementation.prototype._genStub = function(argsLength, names) {
      // Fast path #1: if no named arguments and arg count matches
      if (this.length == argsLength && !names) {
        return this;
      }

      var paramsNamed = this.$optional ? (this.$optional.length / 2) : 0;
      var paramsBare = this.length - paramsNamed;
      var argsNamed = names ? names.length : 0;
      var argsBare = argsLength - argsNamed;

      // Check we got the right number of arguments
      if (argsBare < paramsBare || argsLength > this.length ||
          argsNamed > paramsNamed) {
        return function() {
          $throw(new _ArgumentMismatchException(
            'Wrong number of arguments to function. Expected ' + paramsBare +
            ' positional arguments and at most ' + paramsNamed +
            ' named arguments, but got ' + argsBare +
            ' positional arguments and ' + argsNamed + ' named arguments.'));
        };
      }

      // First, fill in all of the default values
      var p = new Array(paramsBare);
      if (paramsNamed) {
        p = p.concat(this.$optional.slice(paramsNamed));
      }
      // Fill in positional args
      var a = new Array(argsLength);
      for (var i = 0; i < argsBare; i++) {
        p[i] = a[i] = '$' + i;
      }
      // Then overwrite with supplied values for optional args
      var lastParameterIndex;
      var namesInOrder = true;
      for (var i = 0; i < argsNamed; i++) {
        var name = names[i];
        a[i + argsBare] = name;
        var j = this.$optional.indexOf(name);
        if (j < 0 || j >= paramsNamed) {
          return function() {
            $throw(new _ArgumentMismatchException(
              'Named argument "' + name + '" was not expected by function.' +
              ' Did you forget to mark the function parameter [optional]?'));
          };
        } else if (lastParameterIndex && lastParameterIndex > j) {
          namesInOrder = false;
        }
        p[j + paramsBare] = name;
        lastParameterIndex = j;
      }

      if (this.length == argsLength && namesInOrder) {
        // Fast path #2: named arguments, but they're in order and all supplied.
        return this;
      }

      // Note: using Function instead of 'eval' to get a clean scope.
      // TODO(jmesserly): evaluate the performance of these stubs.
      var f = 'function(' + a.join(',') + '){return $f(' + p.join(',') + ');}';
      return new Function('$f', 'return ' + f + '').call(null, this);
    
}
// ********** Code for top level **************
function _map(itemsAndKeys) {
  var ret = new LinkedHashMapImplementation();
  for (var i = (0);
   i < itemsAndKeys.get$length(); ) {
    ret.$setindex(itemsAndKeys.$index(i++), itemsAndKeys.$index(i++));
  }
  return ret;
}
//  ********** Library node **************
// ********** Code for Process **************
function Process(_process) {
  this.SIGSYS = "SIGSYS";
  this.SIGALRM = "SIGALRM";
  this.SIGXCPU = "SIGXCPU";
  this.SIGTSTP = "SIGTSTP";
  this.SIGSEGV = "SIGSEGV";
  this.SIGQUIT = "SIGQUIT";
  this.SIGABRT = "SIGABRT";
  this.SIGKILL = "SIGKILL";
  this.SIGHUP = "SIGHUP";
  this.SIGUSR2 = "SIGUSR2";
  this.SIGXFSZ = "SIGXFSZ";
  this.SIGCONT = "SIGCONT";
  this.SIGTTOU = "SIGTTOU";
  this.SIGINT = "SIGINT";
  this.SIGURG = "SIGURG";
  this.SIGFPE = "SIGFPE";
  this.SIGUSR1 = "SIGUSR1";
  this.SIGEMT = "SIGEMT";
  this.SIGPIPE = "SIGPIPE";
  this.SIGTTIN = "SIGTTIN";
  this.SIGTERM = "SIGTERM";
  this._process = _process;
  this.SIGBUS = "SIGBUS";
  this.SIGPROF = "SIGPROF";
  this.SIGSTOP = "SIGSTOP";
  this.SIGCHLD = "SIGCHLD";
  this.SIGILL = "SIGILL";
  this.SIGTRAP = "SIGTRAP";
  this.SIGINFO = "SIGINFO";
  this.SIGIO = "SIGIO";
  this.SIGVTALRM = "SIGVTALRM";
  this.SIGWINCH = "SIGWINCH";
}
Process.prototype.get$argv = function() {
  return this._process.argv;
}
Process.prototype.set$argv = function(value) {
  this._process.argv = value;
}
Process.prototype.get$env = function() {
  return new EnvMap(this._process);
}
Process.prototype.exit = function(code) {
  this._process.exit(code);
}
// ********** Code for EnvMap **************
function EnvMap(_process) {
  this._process = _process;
}
EnvMap.prototype.$index = function(key) {
  return this._process.env[key];
}
// ********** Code for ReadableStream **************
// ********** Code for WritableStream **************
Object.defineProperty(Object.prototype, '$typeNameOf', { value: function() {
  if ((typeof(window) != 'undefined' && window.constructor.name == 'DOMWindow')
      || typeof(process) != 'undefined') { // fast-path for Chrome and Node
    return this.constructor.name;
  }
  var str = Object.prototype.toString.call(this);
  str = str.substring(8, str.length - 1);
  if (str == 'Window') {
    str = 'DOMWindow';
  } else if (str == 'Document') {
    str = 'HTMLDocument';
  }
  return str;
}, enumerable: false, configurable: true});
function $dynamic(name) {
  var f = Object.prototype[name];
  if (f && f.methods) return f.methods;

  var methods = {};
  if (f) methods.Object = f;
  function $dynamicBind() {
    // Find the target method
    var obj = this;
    var tag = obj.$typeNameOf();
    var method = methods[tag];
    if (!method) {
      var table = $dynamicMetadata;
      for (var i = 0; i < table.length; i++) {
        var entry = table[i];
        if (entry.map.hasOwnProperty(tag)) {
          method = methods[entry.tag];
          if (method) break;
        }
      }
    }
    method = method || methods.Object;
    // Patch the prototype, but don't overwrite an existing stub, like
    // the one on Object.prototype.
    var proto = Object.getPrototypeOf(obj);
    if (!proto.hasOwnProperty(name)) {
      Object.defineProperty(proto, name, 
        { value: method, enumerable: false, configurable: true });
    }

    return method.apply(this, Array.prototype.slice.call(arguments));
  };
  $dynamicBind.methods = methods;
  Object.defineProperty(Object.prototype, name, { value: $dynamicBind,
    enumerable: false, configurable: true});
  return methods;
}
if (typeof $dynamicMetadata == 'undefined') $dynamicMetadata = [];

function $dynamicSetMetadata(inputTable) {
  // TODO: Deal with light isolates.
  var table = [];
  for (var i = 0; i < inputTable.length; i++) {
    var tag = inputTable[i][0];
    var tags = inputTable[i][1];
    var map = {};
    var tagNames = tags.split('|');
    for (var j = 0; j < tagNames.length; j++) {
      map[tagNames[j]] = true;
    }
    table.push({tag: tag, tags: tags, map: map});
  }
  $dynamicMetadata = table;
}
$dynamic("get$end").WriteStream = function() {
  return this.end.bind(this);
}
$dynamic("end$0").WriteStream = function() {
  return this.end(null, "utf8");
};
$dynamic("write$1").WriteStream = function($0) {
  return this.write($0, "utf8");
};
// ********** Code for vm **************
vm = require('vm');
// ********** Code for fs **************
fs = require('fs');
// ********** Code for path **************
path = require('path');
// ********** Code for top level **************
function createSandbox() {
  return {'require': require, 'process': process, 'console': console,
        'Buffer' : Buffer,
        'setTimeout': setTimeout, 'clearTimeout': clearTimeout};
}
function get$_process() {
  return process;
}
function get$process() {
  return new Process(get$_process());
}
//  ********** Library file_system **************
// ********** Code for top level **************
function joinPaths(path1, path2) {
  var pieces = path1.split("/");
  var $$list = path2.split("/");
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var piece = $$list.$index($$i);
    if ($eq(piece, "..") && pieces.get$length() > (0) && $ne(pieces.last$0(), ".") && $ne(pieces.last$0(), "..")) {
      pieces.removeLast$0();
    }
    else if ($ne(piece, "")) {
      if (pieces.get$length() > (0) && $eq(pieces.last$0(), ".")) {
        pieces.removeLast$0();
      }
      pieces.add$1(piece);
    }
  }
  return Strings.join(pieces, "/");
}
function dirname(path) {
  var lastSlash = path.lastIndexOf("/", path.length);
  if (lastSlash == (-1)) {
    return ".";
  }
  else {
    return path.substring((0), lastSlash);
  }
}
function basename(path) {
  var lastSlash = path.lastIndexOf("/", path.length);
  if (lastSlash == (-1)) {
    return path;
  }
  else {
    return path.substring(lastSlash + (1));
  }
}
//  ********** Library file_system_node **************
// ********** Code for NodeFileSystem **************
function NodeFileSystem() {

}
NodeFileSystem.prototype.writeString = function(outfile, text) {
  fs.writeFileSync(outfile, text);
}
NodeFileSystem.prototype.readAll = function(filename) {
  return fs.readFileSync(filename, "utf8");
}
NodeFileSystem.prototype.fileExists = function(filename) {
  return path.existsSync(filename);
}
// ********** Code for top level **************
//  ********** Library lang **************
// ********** Code for CodeWriter **************
function CodeWriter() {
  this._indentation = (0);
  this.writeComments = true;
  this._pendingIndent = false;
  this._buf = new StringBufferImpl("");
}
CodeWriter.prototype.get$text = function() {
  return this._buf.toString();
}
CodeWriter.prototype._indent = function() {
  this._pendingIndent = false;
  for (var i = (0);
   i < this._indentation; i++) {
    this._buf.add("  ");
  }
}
CodeWriter.prototype.comment = function(text) {
  if (this.writeComments) {
    this.writeln(text);
  }
}
CodeWriter.prototype.write = function(text) {
  if (text.length == (0)) return;
  if (this._pendingIndent) this._indent();
  if (text.indexOf("\n") != (-1)) {
    var lines = text.split("\n");
    for (var i = (0);
     i < lines.get$length() - (1); i++) {
      this.writeln(lines.$index(i));
    }
    this.write(lines.$index(lines.get$length() - (1)));
  }
  else {
    this._buf.add(text);
  }
}
CodeWriter.prototype.writeln = function(text) {
  if (text != null) {
    this.write(text);
  }
  if (!text.endsWith("\n")) this._buf.add("\n");
  this._pendingIndent = true;
}
CodeWriter.prototype.writeln.$optional = ['text', 'null']
CodeWriter.prototype.get$writeln = function() {
  return this.writeln.bind(this);
}
CodeWriter.prototype.enterBlock = function(text) {
  this.writeln(text);
  this._indentation++;
}
CodeWriter.prototype.get$enterBlock = function() {
  return this.enterBlock.bind(this);
}
CodeWriter.prototype.exitBlock = function(text) {
  this._indentation--;
  this.writeln(text);
}
CodeWriter.prototype.nextBlock = function(text) {
  this._indentation--;
  this.writeln(text);
  this._indentation++;
}
CodeWriter.prototype.write$1 = CodeWriter.prototype.write;
// ********** Code for CoreJs **************
function CoreJs() {
  this.useAssert = false;
  this.useIsolates = false;
  this._generatedTypeNameOf = false;
  this._usedOperators = new HashMapImplementation();
  this._generatedInherits = false;
  this.useNotNullBool = false;
  this.writer = new CodeWriter();
  this.useWrap0 = false;
  this.useThrow = false;
  this._generatedDynamicProto = false;
  this.useWrap1 = false;
  this.useSetIndex = false;
  this.useIndex = false;
}
CoreJs.prototype.useOperator = function(name) {
  if (this._usedOperators.$index(name) != null) return;
  var code;
  switch (name) {
    case ":ne":

      code = "function $ne(x, y) {\n  if (x == null) return y != null;\n  return (typeof(x) == 'number' && typeof(y) == 'number') ||\n         (typeof(x) == 'boolean' && typeof(y) == 'boolean') ||\n         (typeof(x) == 'string' && typeof(y) == 'string')\n    ? x != y : !x.$eq(y);\n}";
      break;

    case ":eq":

      code = "function $eq(x, y) {\n  if (x == null) return y == null;\n  return (typeof(x) == 'number' && typeof(y) == 'number') ||\n         (typeof(x) == 'boolean' && typeof(y) == 'boolean') ||\n         (typeof(x) == 'string' && typeof(y) == 'string')\n    ? x == y : x.$eq(y);\n}\n// TODO(jimhug): Should this or should it not match equals?\nObject.defineProperty(Object.prototype, '$eq', { value: function(other) { \n  return this === other; \n}, enumerable: false, configurable: true });";
      break;

    case ":bit_not":

      code = "function $bit_not(x) {\n  return (typeof(x) == 'number') ? ~x : x.$bit_not();\n}";
      break;

    case ":negate":

      code = "function $negate(x) {\n  return (typeof(x) == 'number') ? -x : x.$negate();\n}";
      break;

    case ":add":

      code = "function $add(x, y) {\n  return ((typeof(x) == 'number' && typeof(y) == 'number') ||\n          (typeof(x) == 'string'))\n    ? x + y : x.$add(y);\n}";
      break;

    case ":truncdiv":

      this.useThrow = true;
      code = "function $truncdiv(x, y) {\n  if (typeof(x) == 'number' && typeof(y) == 'number') {\n    if (y == 0) $throw(new IntegerDivisionByZeroException());\n    var tmp = x / y;\n    return (tmp < 0) ? Math.ceil(tmp) : Math.floor(tmp);\n  } else {\n    return x.$truncdiv(y);\n  }\n}";
      break;

    case ":mod":

      code = "function $mod(x, y) {\n  if (typeof(x) == 'number' && typeof(y) == 'number') {\n    var result = x % y;\n    if (result == 0) {\n      return 0;  // Make sure we don't return -0.0.\n    } else if (result < 0) {\n      if (y < 0) {\n        return result - y;\n      } else {\n        return result + y;\n      }\n    }\n    return result;\n  } else {\n    return x.$mod(y);\n  }\n}";
      break;

    default:

      var op = TokenKind.rawOperatorFromMethod(name);
      var jsname = $globals.world.toJsIdentifier(name);
      code = _otherOperator(jsname, op);
      break;

  }
  this._usedOperators.$setindex(name, code);
}
CoreJs.prototype.ensureDynamicProto = function() {
  if (this._generatedDynamicProto) return;
  this._generatedDynamicProto = true;
  this.ensureTypeNameOf();
  this.writer.writeln("function $dynamic(name) {\n  var f = Object.prototype[name];\n  if (f && f.methods) return f.methods;\n\n  var methods = {};\n  if (f) methods.Object = f;\n  function $dynamicBind() {\n    // Find the target method\n    var obj = this;\n    var tag = obj.$typeNameOf();\n    var method = methods[tag];\n    if (!method) {\n      var table = $dynamicMetadata;\n      for (var i = 0; i < table.length; i++) {\n        var entry = table[i];\n        if (entry.map.hasOwnProperty(tag)) {\n          method = methods[entry.tag];\n          if (method) break;\n        }\n      }\n    }\n    method = method || methods.Object;\n    // Patch the prototype, but don't overwrite an existing stub, like\n    // the one on Object.prototype.\n    var proto = Object.getPrototypeOf(obj);\n    if (!proto.hasOwnProperty(name)) {\n      Object.defineProperty(proto, name, \n        { value: method, enumerable: false, configurable: true });\n    }\n\n    return method.apply(this, Array.prototype.slice.call(arguments));\n  };\n  $dynamicBind.methods = methods;\n  Object.defineProperty(Object.prototype, name, { value: $dynamicBind,\n    enumerable: false, configurable: true});\n  return methods;\n}\nif (typeof $dynamicMetadata == 'undefined') $dynamicMetadata = [];\n\nfunction $dynamicSetMetadata(inputTable) {\n  // TODO: Deal with light isolates.\n  var table = [];\n  for (var i = 0; i < inputTable.length; i++) {\n    var tag = inputTable[i][0];\n    var tags = inputTable[i][1];\n    var map = {};\n    var tagNames = tags.split('|');\n    for (var j = 0; j < tagNames.length; j++) {\n      map[tagNames[j]] = true;\n    }\n    table.push({tag: tag, tags: tags, map: map});\n  }\n  $dynamicMetadata = table;\n}\n");
}
CoreJs.prototype.ensureTypeNameOf = function() {
  if (this._generatedTypeNameOf) return;
  this._generatedTypeNameOf = true;
  this.writer.writeln("Object.defineProperty(Object.prototype, '$typeNameOf', { value: function() {\n  if ((typeof(window) != 'undefined' && window.constructor.name == 'DOMWindow')\n      || typeof(process) != 'undefined') { // fast-path for Chrome and Node\n    return this.constructor.name;\n  }\n  var str = Object.prototype.toString.call(this);\n  str = str.substring(8, str.length - 1);\n  if (str == 'Window') {\n    str = 'DOMWindow';\n  } else if (str == 'Document') {\n    str = 'HTMLDocument';\n  }\n  return str;\n}, enumerable: false, configurable: true});");
}
CoreJs.prototype.ensureInheritsHelper = function() {
  if (this._generatedInherits) return;
  this._generatedInherits = true;
  this.writer.writeln("/** Implements extends for Dart classes on JavaScript prototypes. */\nfunction $inherits(child, parent) {\n  if (child.prototype.__proto__) {\n    child.prototype.__proto__ = parent.prototype;\n  } else {\n    function tmp() {};\n    tmp.prototype = parent.prototype;\n    child.prototype = new tmp();\n    child.prototype.constructor = child;\n  }\n}");
}
CoreJs.prototype.generate = function(w) {
  w.write(this.writer.get$text());
  this.writer = w;
  if (this.useNotNullBool) {
    this.useThrow = true;
    w.writeln("function $notnull_bool(test) {\n  if (test === true || test === false) return test;\n  $throw(new TypeError(test, 'bool'));\n}");
  }
  if (this.useThrow) {
    w.writeln("function $throw(e) {\n  // If e is not a value, we can use V8's captureStackTrace utility method.\n  // TODO(jmesserly): capture the stack trace on other JS engines.\n  if (e && (typeof e == 'object') && Error.captureStackTrace) {\n    // TODO(jmesserly): this will clobber the e.stack property\n    Error.captureStackTrace(e, $throw);\n  }\n  throw e;\n}");
  }
  if (this.useIndex) {
    w.writeln("Object.defineProperty(Object.prototype, '$index', { value: function(i) {\n  var proto = Object.getPrototypeOf(this);\n  if (proto !== Object) {\n    proto.$index = function(i) { return this[i]; }\n  }\n  return this[i];\n}, enumerable: false, configurable: true});\nObject.defineProperty(Array.prototype, '$index', { value: function(i) { \n  return this[i]; \n}, enumerable: false, configurable: true});\nObject.defineProperty(String.prototype, '$index', { value: function(i) { \n  return this[i]; \n}, enumerable: false, configurable: true});");
  }
  if (this.useSetIndex) {
    w.writeln("Object.defineProperty(Object.prototype, '$setindex', { value: function(i, value) {\n  var proto = Object.getPrototypeOf(this);\n  if (proto !== Object) {\n    proto.$setindex = function(i, value) { return this[i] = value; }\n  }\n  return this[i] = value;\n}, enumerable: false, configurable: true});\nObject.defineProperty(Array.prototype, '$setindex', { value: function(i, value) { \n  return this[i] = value; }, enumerable: false, configurable: true});");
  }
  if (this.useIsolates) {
    if (this.useWrap0) {
      w.writeln("// Wrap a 0-arg dom-callback to bind it with the current isolate:\nfunction $wrap_call$0(fn) { return fn && fn.wrap$call$0(); }\nFunction.prototype.wrap$call$0 = function() {\n  var isolateContext = $globalState.currentContext;\n  var self = this;\n  this.wrap$0 = function() {\n    isolateContext.eval(self);\n    $globalState.topEventLoop.run();\n  };\n  this.wrap$call$0 = function() { return this.wrap$0; };\n  return this.wrap$0;\n}");
    }
    if (this.useWrap1) {
      w.writeln("// Wrap a 1-arg dom-callback to bind it with the current isolate:\nfunction $wrap_call$1(fn) { return fn && fn.wrap$call$1(); }\nFunction.prototype.wrap$call$1 = function() {\n  var isolateContext = $globalState.currentContext;\n  var self = this;\n  this.wrap$1 = function(arg) {\n    isolateContext.eval(function() { self(arg); });\n    $globalState.topEventLoop.run();\n  };\n  this.wrap$call$1 = function() { return this.wrap$1; };\n  return this.wrap$1;\n}");
    }
    w.writeln("var $globalThis = this;\nvar $globals = null;\nvar $globalState = null;");
  }
  else {
    if (this.useWrap0) {
      w.writeln("function $wrap_call$0(fn) { return fn; }");
    }
    if (this.useWrap1) {
      w.writeln("function $wrap_call$1(fn) { return fn; }");
    }
  }
  var $$list = orderValuesByKeys(this._usedOperators);
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var opImpl = $$list.$index($$i);
    w.writeln(opImpl);
  }
  if ($globals.world.dom != null) {
    this.ensureTypeNameOf();
    w.writeln("Object.defineProperty(Object.prototype, \"get$typeName\", { value: Object.prototype.$typeNameOf, enumerable: false, configurable: true});");
  }
}
CoreJs.prototype.generate$1 = CoreJs.prototype.generate;
// ********** Code for Element **************
function Element(name, _enclosingElement) {
  this.name = name;
  this._enclosingElement = _enclosingElement;
  this._jsname = $globals.world.toJsIdentifier(this.name);
}
Element.prototype.get$name = function() { return this.name; };
Element.prototype.set$name = function(value) { return this.name = value; };
Element.prototype.get$_jsname = function() { return this._jsname; };
Element.prototype.set$_jsname = function(value) { return this._jsname = value; };
Element.prototype.get$library = function() {
  return null;
}
Element.prototype.get$span = function() {
  return null;
}
Element.prototype.get$isNative = function() {
  return false;
}
Element.prototype.hashCode = function() {
  return this.name.hashCode();
}
Element.prototype.get$jsname = function() {
  return this._jsname;
}
Element.prototype.get$nativeName = function() {
  return this._jsname;
}
Element.prototype.get$avoidNativeName = function() {
  return false;
}
Element.prototype.get$jsnamePriority = function() {
  return this.get$isNative() ? (2) : (this.get$library().get$isCore() ? (1) : (0));
}
Element.prototype.resolve = function() {

}
Element.prototype.get$typeParameters = function() {
  return null;
}
Element.prototype.get$enclosingElement = function() {
  return this._enclosingElement == null ? this.get$library() : this._enclosingElement;
}
Element.prototype.set$enclosingElement = function(e) {
  return this._enclosingElement = e;
}
Element.prototype.resolveType = function(node, typeErrors) {
  if (node == null) return $globals.world.varType;
  if (node.type != null) return node.type;
  if ((node instanceof NameTypeReference)) {
    var typeRef = node;
    var name;
    if (typeRef.names != null) {
      name = typeRef.names.last().get$name();
    }
    else {
      name = typeRef.name.name;
    }
    if (this.get$typeParameters() != null) {
      var $$list = this.get$typeParameters();
      for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
        var tp = $$list.$index($$i);
        if ($eq(tp.get$name(), name)) {
          typeRef.type = tp;
        }
      }
    }
    if (typeRef.type != null) {
      return typeRef.type;
    }
    return this.get$enclosingElement().resolveType$2(node, typeErrors);
  }
  else if ((node instanceof GenericTypeReference)) {
    var typeRef = node;
    var baseType = this.resolveType$2(typeRef.baseType, typeErrors);
    if (!baseType.get$isGeneric()) {
      $globals.world.error(("" + baseType.get$name() + " is not generic"), typeRef.span);
      return null;
    }
    if (typeRef.typeArguments.get$length() != baseType.get$typeParameters().get$length()) {
      $globals.world.error("wrong number of type arguments", typeRef.span);
      return null;
    }
    var typeArgs = [];
    for (var i = (0);
     i < typeRef.typeArguments.get$length(); i++) {
      typeArgs.add$1(this.resolveType$2(typeRef.typeArguments.$index(i), typeErrors));
    }
    typeRef.type = baseType.getOrMakeConcreteType$1(typeArgs);
  }
  else if ((node instanceof FunctionTypeReference)) {
    var typeRef = node;
    var name = "";
    if (typeRef.func.name != null) {
      name = typeRef.func.name.name;
    }
    typeRef.type = this.get$library().getOrAddFunctionType(this, name, typeRef.func);
  }
  else {
    $globals.world.internalError("unknown type reference", node.span);
  }
  return node.type;
}
Element.prototype.hashCode$0 = Element.prototype.hashCode;
Element.prototype.resolve$0 = Element.prototype.resolve;
Element.prototype.resolveType$2 = Element.prototype.resolveType;
// ********** Code for WorldGenerator **************
function WorldGenerator(main, writer) {
  this.main = main;
  this.hasStatics = false;
  this.corejs = new CoreJs();
  this.globals = new HashMapImplementation();
  this.writer = writer;
}
WorldGenerator.prototype.run = function() {
  var metaGen = new MethodGenerator(this.main, null);
  var mainTarget = new Value.type$ctor(this.main.declaringType, this.main.get$span());
  var mainCall = this.main.invoke(metaGen, null, mainTarget, Arguments.get$EMPTY(), false);
  this.main.declaringType.markUsed();
  if ($globals.options.compileAll) {
    this.markLibrariesUsed([$globals.world.coreimpl, $globals.world.corelib, this.main.declaringType.get$library()]);
  }
  $globals.world.numImplType.markUsed();
  $globals.world.stringImplType.markUsed();
  if ($globals.world.corelib.types.$index("Isolate").get$isUsed() || $globals.world.coreimpl.types.$index("ReceivePortImpl").get$isUsed()) {
    if (this.corejs.useWrap0 || this.corejs.useWrap1) {
      this.genMethod($globals.world.coreimpl.types.$index("IsolateContext").getMember$1("eval"));
      this.genMethod($globals.world.coreimpl.types.$index("EventLoop").getMember$1("run"));
    }
    this.corejs.useIsolates = true;
    var isolateMain = $globals.world.coreimpl.topType.resolveMember("startRootIsolate").members.$index((0));
    var isolateMainTarget = new Value.type$ctor($globals.world.coreimpl.topType, this.main.get$span());
    mainCall = isolateMain.invoke(metaGen, null, isolateMainTarget, new Arguments(null, [this.main._get(metaGen, this.main.definition, null, false)]), false);
  }
  this.writeTypes($globals.world.coreimpl);
  this.writeTypes($globals.world.corelib);
  this.writeTypes(this.main.declaringType.get$library());
  if (this._mixins != null) this.writer.write(this._mixins.get$text());
  this.writeDynamicDispatchMetadata();
  this.writeGlobals();
  this.writer.writeln(("" + mainCall.get$code() + ";"));
}
WorldGenerator.prototype.markLibrariesUsed = function(libs) {
  return this.getAllTypes(libs).forEach(this.get$markTypeUsed());
}
WorldGenerator.prototype.markTypeUsed = function(type) {
  if (!type.get$isClass()) return;
  type.markUsed();
  type.isTested = true;
  type.isTested = !type.get$isTop() && !(type.get$isNative() && type.get$members().getValues().every$1((function (m) {
    return m.get$isStatic() && !m.get$isFactory();
  })
  ));
  var members = ListFactory.ListFactory$from$factory(type.get$members().getValues());
  members.addAll$1(type.get$constructors().getValues());
  type.get$factories().forEach((function (f) {
    return members.add$1(f);
  })
  );
  for (var $$i = members.iterator$0(); $$i.hasNext$0(); ) {
    var member = $$i.next$0();
    if ((member instanceof PropertyMember)) {
      if (member.get$getter() != null) this.genMethod(member.get$getter());
      if (member.get$setter() != null) this.genMethod(member.get$setter());
    }
    if ((member instanceof MethodMember)) this.genMethod(member);
  }
}
WorldGenerator.prototype.get$markTypeUsed = function() {
  return this.markTypeUsed.bind(this);
}
WorldGenerator.prototype.getAllTypes = function(libs) {
  var types = [];
  var seen = new HashSetImplementation();
  for (var $$i = 0;$$i < libs.get$length(); $$i++) {
    var mainLib = libs.$index($$i);
    var toCheck = DoubleLinkedQueue.DoubleLinkedQueue$from$factory([mainLib]);
    while (!toCheck.isEmpty()) {
      var lib = toCheck.removeFirst();
      if (seen.contains(lib)) continue;
      seen.add(lib);
      lib.get$imports().forEach$1((function (lib, toCheck, i) {
        return toCheck.addLast(lib);
      }).bind(null, lib, toCheck)
      );
      lib.get$types().getValues$0().forEach$1((function (t) {
        return types.add(t);
      })
      );
    }
  }
  return types;
}
WorldGenerator.prototype.globalForStaticField = function(field, exp, dependencies) {
  this.hasStatics = true;
  var key = ("" + field.declaringType.get$jsname() + "." + field.get$jsname());
  var ret = this.globals.$index(key);
  if (ret == null) {
    ret = new GlobalValue(exp.type, exp.get$code(), field.isFinal, field, null, exp, exp.span, dependencies, true);
    this.globals.$setindex(key, ret);
  }
  return ret;
}
WorldGenerator.prototype.globalForConst = function(exp, dependencies) {
  var key = exp.type.get$jsname() + ":" + exp.get$code();
  var ret = this.globals.$index(key);
  if (ret == null) {
    var ns = this.globals.get$length().toString();
    while (ns.get$length() < (4)) ns = "0" + ns;
    var name = ("const$" + ns);
    ret = new GlobalValue(exp.type, name, true, null, name, exp, exp.span, dependencies, true);
    this.globals.$setindex(key, ret);
  }
  return ret;
}
WorldGenerator.prototype.writeTypes = function(lib) {
  if (lib.isWritten) return;
  lib.isWritten = true;
  var $$list = lib.imports;
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var import_ = $$list.$index($$i);
    this.writeTypes(import_.get$library());
  }
  for (var i = (0);
   i < lib.sources.get$length(); i++) {
    lib.sources.$index(i).set$orderInLibrary(i);
  }
  this.writer.comment(("//  ********** Library " + lib.name + " **************"));
  if (lib.get$isCore()) {
    this.writer.comment("//  ********** Natives dart:core **************");
    this.corejs.generate(this.writer);
  }
  var $$list = lib.natives;
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var file = $$list.$index($$i);
    var filename = basename(file.get$filename());
    this.writer.comment(("//  ********** Natives " + filename + " **************"));
    this.writer.writeln(file.get$text());
  }
  lib.topType.markUsed();
  var $$list = this._orderValues(lib.types);
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var type = $$list.$index($$i);
    if ((type.get$isUsed() || type.get$library().get$isDom() || type.get$isHiddenNativeType()) && type.get$isClass()) {
      this.writeType(type);
      if (type.get$isGeneric()) {
        var $list0 = this._orderValues(type.get$_concreteTypes());
        for (var $i0 = 0;$i0 < $list0.get$length(); $i0++) {
          var ct = $list0.$index($i0);
          this.writeType(ct);
        }
      }
    }
    else if (type.get$isFunction() && type.get$varStubs().get$length() > (0)) {
      this.writer.comment(("// ********** Code for " + type.get$jsname() + " **************"));
      this._writeDynamicStubs(type);
    }
    if (type.get$typeCheckCode() != null) {
      this.writer.writeln(type.get$typeCheckCode());
    }
  }
}
WorldGenerator.prototype.genMethod = function(meth, enclosingMethod) {
  if (!meth.isGenerated && !meth.get$isAbstract() && meth.get$definition() != null) {
    new MethodGenerator(meth, enclosingMethod).run();
  }
}
WorldGenerator.prototype._prototypeOf = function(type, name) {
  if (type.get$isSingletonNative()) {
    return ("" + type.get$jsname() + "." + name);
  }
  else if (type.get$isHiddenNativeType()) {
    this.corejs.ensureDynamicProto();
    this._usedDynamicDispatchOnType(type);
    return ("$dynamic(\"" + name + "\")." + type.get$definition().get$nativeType().get$name());
  }
  else {
    return ("" + type.get$jsname() + ".prototype." + name);
  }
}
WorldGenerator.prototype._writePrototypePatch = function(type, name, functionBody, writer, isOneLiner) {
  var writeFunction = writer.get$writeln();
  var ending = ";";
  if (!isOneLiner) {
    writeFunction = writer.get$enterBlock();
    ending = "";
  }
  if (type.get$isObject()) {
    $globals.world.counters.objectProtoMembers++;
  }
  if (type.get$isObject() || $eq(type.get$genericType(), $globals.world.listFactoryType)) {
    if (isOneLiner) {
      ending = ", enumerable: false, configurable: true })" + ending;
    }
    writeFunction.call$1(("Object.defineProperty(" + type.get$jsname() + ".prototype, \"" + name + "\",") + (" { value: " + functionBody + ending));
    if (isOneLiner) return "}";
    return "}, enumerable: false, configurable: true });";
  }
  else {
    writeFunction.call$1(this._prototypeOf(type, name) + " = " + functionBody + ending);
    return (!isOneLiner) ? "}" : "";
  }
}
WorldGenerator.prototype._maybeIsTest = function(onType, checkType) {
  var isSubtype = onType.isSubtypeOf(checkType);
  if (checkType.isTested) {
    this._writePrototypePatch(onType, ("is$" + checkType.get$jsname()), ("function(){return " + isSubtype + "}"), this.writer, true);
  }
  if (checkType.isChecked) {
    var body = "return this";
    var checkName = ("assert$" + checkType.get$jsname());
    if (!isSubtype) {
      body = $globals.world.objectType.varStubs.$index(checkName).get$body();
    }
    else if ($eq(onType, $globals.world.stringImplType) || $eq(onType, $globals.world.numImplType)) {
      body = ("return " + onType.get$nativeType().name + "(this)");
    }
    this._writePrototypePatch(onType, checkName, ("function(){" + body + "}"), this.writer, true);
  }
}
WorldGenerator.prototype.writeType = function(type) {
  if (type.isWritten) return;
  type.isWritten = true;
  if (type.get$parent() != null && !type.get$isNative()) {
    this.writeType(type.get$parent());
  }
  if (type.name != null && (type instanceof ConcreteType) && $eq(type.get$library(), $globals.world.coreimpl) && type.name.startsWith("ListFactory")) {
    this.writer.writeln(("" + type.get$jsname() + " = " + type.get$genericType().get$jsname() + ";"));
    return;
  }
  var typeName = type.get$jsname() != null ? type.get$jsname() : "top level";
  this.writer.comment(("// ********** Code for " + typeName + " **************"));
  if (type.get$isNative() && !type.get$isTop()) {
    var nativeName = type.get$definition().get$nativeType().get$name();
    if ($eq(nativeName, "")) {
      this.writer.writeln(("function " + type.get$jsname() + "() {}"));
    }
    else if (type.get$jsname() != nativeName) {
      if (type.get$isHiddenNativeType()) {
        if (this._typeNeedsHolderForStaticMethods(type)) {
          this.writer.writeln(("var " + type.get$jsname() + " = {};"));
        }
      }
      else {
        this.writer.writeln(("" + type.get$jsname() + " = " + nativeName + ";"));
      }
    }
  }
  if (!type.get$isTop()) {
    if ((type instanceof ConcreteType)) {
      var c = type;
      this.corejs.ensureInheritsHelper();
      this.writer.writeln(("$inherits(" + c.get$jsname() + ", " + c.genericType.get$jsname() + ");"));
      for (var p = c._parent;
       (p instanceof ConcreteType); p = p.get$_parent()) {
        this._ensureInheritMembersHelper();
        this._mixins.writeln(("$inheritsMembers(" + c.get$jsname() + ", " + p.get$jsname() + ");"));
      }
    }
    else if (!type.get$isNative()) {
      if (type.get$parent() != null && !type.get$parent().get$isObject()) {
        this.corejs.ensureInheritsHelper();
        this.writer.writeln(("$inherits(" + type.get$jsname() + ", " + type.get$parent().get$jsname() + ");"));
      }
    }
  }
  if (type.get$isTop()) {
  }
  else if (type.get$constructors().get$length() == (0)) {
    if (!type.get$isNative()) {
      this.writer.writeln(("function " + type.get$jsname() + "() {}"));
    }
  }
  else {
    var standardConstructor = type.get$constructors().$index("");
    if (standardConstructor == null || standardConstructor.generator == null) {
      if (!type.get$isNative()) {
        this.writer.writeln(("function " + type.get$jsname() + "() {}"));
      }
    }
    else {
      standardConstructor.generator.writeDefinition(this.writer, null);
    }
    var $$list = type.get$constructors().getValues();
    for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
      var c = $$i.next$0();
      if (c.get$generator() != null && $ne(c, standardConstructor)) {
        c.get$generator().writeDefinition$2(this.writer);
      }
    }
  }
  if (!(type instanceof ConcreteType)) {
    this._maybeIsTest(type, type);
  }
  if (type.get$genericType()._concreteTypes != null) {
    var $$list = this._orderValues(type.get$genericType()._concreteTypes);
    for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
      var ct = $$list.$index($$i);
      this._maybeIsTest(type, ct);
    }
  }
  if (type.get$interfaces() != null) {
    var seen = new HashSetImplementation();
    var worklist = [];
    worklist.addAll$1(type.get$interfaces());
    seen.addAll$1(type.get$interfaces());
    while (!worklist.isEmpty$0()) {
      var interface_ = worklist.removeLast$0();
      this._maybeIsTest(type, interface_.get$genericType());
      if (interface_.get$genericType().get$_concreteTypes() != null) {
        var $$list = this._orderValues(interface_.get$genericType().get$_concreteTypes());
        for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
          var ct = $$list.$index($$i);
          this._maybeIsTest(type, ct);
        }
      }
      var $$list = interface_.get$interfaces();
      for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
        var other = $$i.next$0();
        if (!seen.contains$1(other)) {
          worklist.addLast$1(other);
          seen.add$1(other);
        }
      }
    }
  }
  type.get$factories().forEach(this.get$_writeMethod());
  var $$list = this._orderValues(type.get$members());
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var member = $$list.$index($$i);
    if ((member instanceof FieldMember)) {
      this._writeField(member);
    }
    if ((member instanceof PropertyMember)) {
      this._writeProperty(member);
    }
    if (member.get$isMethod()) {
      this._writeMethod(member);
    }
  }
  this._writeDynamicStubs(type);
}
WorldGenerator.prototype._typeNeedsHolderForStaticMethods = function(type) {
  var $$list = type.get$members().getValues();
  for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
    var member = $$i.next$0();
    if (member.get$isMethod()) {
      if (member.get$isConstructor() || member.get$isStatic()) {
        if (member.get$isGenerated()) {
          return true;
        }
      }
    }
  }
  return false;
}
WorldGenerator.prototype._ensureInheritMembersHelper = function() {
  if (this._mixins != null) return;
  this._mixins = new CodeWriter();
  this._mixins.comment("// ********** Generic Type Inheritance **************");
  this._mixins.writeln("/** Implements extends for generic types. */\nfunction $inheritsMembers(child, parent) {\n  child = child.prototype;\n  parent = parent.prototype;\n  Object.getOwnPropertyNames(parent).forEach(function(name) {\n    if (typeof(child[name]) == 'undefined') child[name] = parent[name];\n  });\n}");
}
WorldGenerator.prototype._writeDynamicStubs = function(type) {
  var $$list = orderValuesByKeys(type.varStubs);
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var stub = $$list.$index($$i);
    if (!stub.get$isGenerated()) stub.generate$1(this.writer);
  }
}
WorldGenerator.prototype._writeStaticField = function(field) {
  if (field.isFinal) return;
  var fullname = ("" + field.declaringType.get$jsname() + "." + field.get$jsname());
  if (this.globals.containsKey(fullname)) {
    var value = this.globals.$index(fullname);
    if (field.declaringType.get$isTop() && !field.isNative) {
      this.writer.writeln(("$globals." + field.get$jsname() + " = " + value.get$exp().get$code() + ";"));
    }
    else {
      this.writer.writeln(("$globals." + field.declaringType.get$jsname() + "_" + field.get$jsname()) + (" = " + value.get$exp().get$code() + ";"));
    }
  }
}
WorldGenerator.prototype._writeField = function(field) {
  if (field.declaringType.get$isTop() && !field.isNative && field.value == null) {
    this.writer.writeln(("var " + field.get$jsname() + ";"));
  }
  if (field._providePropertySyntax) {
    this._writePrototypePatch(field.declaringType, ("get$" + field.get$jsname()), ("function() { return this." + field.get$jsname() + "; }"), this.writer, true);
    if (!field.isFinal) {
      this._writePrototypePatch(field.declaringType, ("set$" + field.get$jsname()), ("function(value) { return this." + field.get$jsname() + " = value; }"), this.writer, true);
    }
  }
}
WorldGenerator.prototype._writeProperty = function(property) {
  if (property.getter != null) this._writeMethod(property.getter);
  if (property.setter != null) this._writeMethod(property.setter);
  if (property._provideFieldSyntax) {
    this.writer.enterBlock("Object.defineProperty(" + ("" + property.declaringType.get$jsname() + ".prototype, \"" + property.get$jsname() + "\", {"));
    if (property.getter != null) {
      this.writer.write(("get: " + property.declaringType.get$jsname() + ".prototype." + property.getter.get$jsname()));
      this.writer.writeln(property.setter == null ? "" : ",");
    }
    if (property.setter != null) {
      this.writer.writeln(("set: " + property.declaringType.get$jsname() + ".prototype." + property.setter.get$jsname()));
    }
    this.writer.exitBlock("});");
  }
}
WorldGenerator.prototype._writeMethod = function(m) {
  if (m.generator != null) {
    m.generator.writeDefinition(this.writer, null);
  }
  else if ((m instanceof MethodMember) && m.get$isNative() && m._providePropertySyntax && !m._provideFieldSyntax) {
    MethodGenerator._maybeGenerateBoundGetter(m, this.writer);
  }
}
WorldGenerator.prototype.get$_writeMethod = function() {
  return this._writeMethod.bind(this);
}
WorldGenerator.prototype.writeGlobals = function() {
  if (this.globals.get$length() > (0)) {
    this.writer.comment("//  ********** Globals **************");
    var list = this.globals.getValues();
    list.sort$1((function (a, b) {
      return a.compareTo$1(b);
    })
    );
    this.writer.enterBlock("function $static_init(){");
    for (var $$i = list.iterator$0(); $$i.hasNext$0(); ) {
      var global = $$i.next$0();
      if (global.get$field() != null) {
        this._writeStaticField(global.get$field());
      }
    }
    this.writer.exitBlock("}");
    for (var $$i = list.iterator$0(); $$i.hasNext$0(); ) {
      var global = $$i.next$0();
      if (global.get$field() == null) {
        this.writer.writeln(("var " + global.get$name() + " = " + global.get$exp().get$code() + ";"));
      }
    }
  }
  if (!this.corejs.useIsolates) {
    if (this.hasStatics) {
      this.writer.writeln("var $globals = {};");
    }
    if (this.globals.get$length() > (0)) {
      this.writer.writeln("$static_init();");
    }
  }
}
WorldGenerator.prototype._usedDynamicDispatchOnType = function(type) {
  if (this.typesWithDynamicDispatch == null) this.typesWithDynamicDispatch = new HashSetImplementation();
  this.typesWithDynamicDispatch.add(type);
}
WorldGenerator.prototype.writeDynamicDispatchMetadata = function() {
  var $this = this; // closure support
  if (this.typesWithDynamicDispatch == null) return;
  this.writer.comment(("// " + this.typesWithDynamicDispatch.get$length() + " dynamic types."));
  var seen = new HashSetImplementation();
  var types = [];
  function visit(type) {
    if (seen.contains$1(type)) return;
    seen.add$1(type);
    var $$list = $this._orderCollectionValues(type.get$directSubtypes());
    for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
      var subtype = $$list.$index($$i);
      visit(subtype);
    }
    types.add$1(type);
  }
  var $$list = this._orderCollectionValues(this.typesWithDynamicDispatch);
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var type = $$list.$index($$i);
    visit(type);
  }
  var dispatchTypes = types.filter$1((function (type) {
    return !type.get$directSubtypes().isEmpty$0() && $this.typesWithDynamicDispatch.contains(type);
  })
  );
  this.writer.comment(("// " + types.get$length() + " types"));
  this.writer.comment(("// " + types.filter$1((function (t) {
    return !t.get$directSubtypes().isEmpty$0();
  })
  ).get$length() + " !leaf"));
  var varNames = [];
  var varDefns = new HashMapImplementation();
  var tagDefns = new HashMapImplementation();
  function makeExpression(type) {
    var expressions = [];
    var subtags = [type.get$nativeName()];
    function walk(type) {
      var $$list = $this._orderCollectionValues(type.get$directSubtypes());
      for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
        var subtype = $$list.$index($$i);
        var tag = subtype.get$nativeName();
        var existing = tagDefns.$index(tag);
        if (existing == null) {
          subtags.add$1(tag);
          walk(subtype);
        }
        else {
          if (varDefns.containsKey$1(existing)) {
            expressions.add$1(existing);
          }
          else {
            var varName = ("v" + varNames.get$length() + "/*" + tag + "*/");
            varNames.add$1(varName);
            varDefns.$setindex(varName, existing);
            tagDefns.$setindex(tag, varName);
            expressions.add$1(varName);
          }
        }
      }
    }
    walk(type);
    var constantPart = ("'" + Strings.join(subtags, "|") + "'");
    if ($ne(constantPart, "''")) expressions.add$1(constantPart);
    var expression;
    if ($eq(expressions.get$length(), (1))) {
      expression = expressions.$index((0));
    }
    else {
      expression = ("[" + Strings.join(expressions, ",") + "].join('|')");
    }
    return expression;
  }
  for (var $$i = dispatchTypes.iterator$0(); $$i.hasNext$0(); ) {
    var type = $$i.next$0();
    tagDefns.$setindex(type.get$nativeName(), makeExpression(type));
  }
  if (!tagDefns.isEmpty$0()) {
    this.writer.enterBlock("(function(){");
    for (var $$i = varNames.iterator$0(); $$i.hasNext$0(); ) {
      var varName = $$i.next$0();
      this.writer.writeln(("var " + varName + " = " + varDefns.$index(varName) + ";"));
    }
    this.writer.enterBlock("var table = [");
    this.writer.comment("// [dynamic-dispatch-tag, tags of classes implementing dynamic-dispatch-tag]");
    for (var $$i = dispatchTypes.iterator$0(); $$i.hasNext$0(); ) {
      var type = $$i.next$0();
      this.writer.writeln(("['" + type.get$nativeName() + "', " + tagDefns.$index(type.get$nativeName()) + "],"));
    }
    this.writer.exitBlock("];");
    this.writer.writeln("$dynamicSetMetadata(table);");
    this.writer.exitBlock("})();");
  }
}
WorldGenerator.prototype._orderValues = function(map) {
  var values = map.getValues();
  values.sort(this.get$_compareMembers());
  return values;
}
WorldGenerator.prototype._orderCollectionValues = function(collection) {
  var values = ListFactory.ListFactory$from$factory(collection);
  values.sort(this.get$_compareMembers());
  return values;
}
WorldGenerator.prototype._compareMembers = function(x, y) {
  if (x.get$span() != null && y.get$span() != null) {
    var spans = x.get$span().compareTo$1(y.get$span());
    if (spans != (0)) return spans;
  }
  if (x.get$span() == null) return (1);
  if (y.get$span() == null) return (-1);
  return x.get$name().compareTo$1(y.get$name());
}
WorldGenerator.prototype.get$_compareMembers = function() {
  return this._compareMembers.bind(this);
}
WorldGenerator.prototype.run$0 = WorldGenerator.prototype.run;
// ********** Code for BlockScope **************
function BlockScope(enclosingMethod, parent, node, reentrant) {
  this.enclosingMethod = enclosingMethod;
  this._vars = new CopyOnWriteMap_dart_core_String$Value();
  this.parent = parent;
  this.node = node;
  this.reentrant = reentrant;
  this._jsNames = new HashSetImplementation();
  if (this.get$isMethodScope()) {
    this._closedOver = new HashSetImplementation();
  }
  else {
    this.reentrant = reentrant || this.parent.reentrant;
  }
  this.inferTypes = $globals.options.inferTypes && (this.parent == null || this.parent.inferTypes);
}
BlockScope._snapshot$ctor = function(original) {
  this.enclosingMethod = original.enclosingMethod;
  this._vars = original._vars.clone();
  this.parent = original.parent == null ? null : original.parent.snapshot();
  this.node = original.node;
  this.inferTypes = original.inferTypes;
  this._jsNames = original._jsNames;
  this._closedOver = original._closedOver;
  this.rethrow = original.rethrow;
}
BlockScope._snapshot$ctor.prototype = BlockScope.prototype;
BlockScope.prototype.get$enclosingMethod = function() { return this.enclosingMethod; };
BlockScope.prototype.set$enclosingMethod = function(value) { return this.enclosingMethod = value; };
BlockScope.prototype.get$parent = function() { return this.parent; };
BlockScope.prototype.set$parent = function(value) { return this.parent = value; };
BlockScope.prototype.get$_vars = function() { return this._vars; };
BlockScope.prototype.set$_vars = function(value) { return this._vars = value; };
BlockScope.prototype.get$_jsNames = function() { return this._jsNames; };
BlockScope.prototype.set$_jsNames = function(value) { return this._jsNames = value; };
BlockScope.prototype.get$_closedOver = function() { return this._closedOver; };
BlockScope.prototype.set$_closedOver = function(value) { return this._closedOver = value; };
BlockScope.prototype.get$rethrow = function() { return this.rethrow; };
BlockScope.prototype.set$rethrow = function(value) { return this.rethrow = value; };
BlockScope.prototype.get$isMethodScope = function() {
  return this.parent == null || $ne(this.parent.enclosingMethod, this.enclosingMethod);
}
BlockScope.prototype.get$methodScope = function() {
  var s = this;
  while (!s.get$isMethodScope()) s = s.get$parent();
  return s;
}
BlockScope.prototype.lookup = function(name) {
  for (var s = this;
   s != null; s = s.get$parent()) {
    var ret = s.get$_vars().$index(name);
    if (ret != null) return this._capture(s, ret);
  }
  return null;
}
BlockScope.prototype.assign = function(name, value) {
  if (!this.inferTypes) return;
  for (var s = this;
   s != null; s = s.get$parent()) {
    var existing = s.get$_vars().$index(name);
    if (existing != null) {
      s.get$_vars().$setindex(name, value.replaceCode(existing.get$code(), existing.get$span(), existing.get$needsTemp(), existing.get$staticType()));
      return;
    }
  }
  $globals.world.internalError(("assigning variable '" + name + "' that doesn't exist."));
}
BlockScope.prototype._capture = function(other, value) {
  if ($ne(other.enclosingMethod, this.enclosingMethod)) {
    other.get$methodScope()._closedOver.add(value.get$code());
    if (this.enclosingMethod.captures != null && other.reentrant) {
      this.enclosingMethod.captures.add(value.get$code());
    }
  }
  return value;
}
BlockScope.prototype._isDefinedInParent = function(name) {
  if (this.get$isMethodScope() && this._closedOver.contains(name)) return true;
  for (var s = this.parent;
   s != null; s = s.get$parent()) {
    if (s.get$_vars().containsKey$1(name)) return true;
    if (s.get$_jsNames().contains$1(name)) return true;
    if (s.get$isMethodScope() && s.get$_closedOver().contains$1(name)) return true;
  }
  var type = this.enclosingMethod.method.declaringType;
  if (type.get$library().lookup$2(name) != null) return true;
  return false;
}
BlockScope.prototype.create = function(name, type, span, isFinal, isParameter) {
  var jsName = $globals.world.toJsIdentifier(name);
  if (this._vars.containsKey(name)) {
    $globals.world.error(("duplicate name \"" + name + "\""), span);
  }
  if (!isParameter) {
    var index = (0);
    while (this._isDefinedInParent(jsName)) {
      jsName = ("" + name + (index++));
    }
  }
  var ret = new Value(type, jsName, span, false);
  ret.set$isFinal(isFinal);
  this._vars.$setindex(name, ret);
  if (name != jsName) this._jsNames.add(jsName);
  return ret;
}
BlockScope.prototype.declareParameter = function(p) {
  return this.create(p.name, p.type, p.definition.span, false, true);
}
BlockScope.prototype.declare = function(id) {
  var type = this.enclosingMethod.method.resolveType$2(id.type, false);
  return this.create(id.name.name, type, id.span, false, false);
}
BlockScope.prototype.getRethrow = function() {
  var scope = this;
  while (scope.get$rethrow() == null && scope.get$parent() != null) {
    scope = scope.get$parent();
  }
  return scope.get$rethrow();
}
BlockScope.prototype.snapshot = function() {
  return new BlockScope._snapshot$ctor(this);
}
BlockScope.prototype.unionWith = function(other) {
  var $this = this; // closure support
  var changed = false;
  if (this.parent != null) {
    changed = this.parent.unionWith(other.parent);
  }
  if (this._vars._lang_map != other._vars._lang_map) {
    other._vars.forEach((function (key, v) {
      var myVar = $this._vars.$index(key);
      if (myVar == null) {
        $globals.world.internalError(("got unexpected new variable " + v.get$code()), v.span);
      }
      else {
        v = Value.union(myVar, v);
      }
      if (v != myVar) {
        v.code = myVar.get$code();
        v.span = myVar.span;
        v.staticType = myVar.staticType;
        $this._vars.$setindex(key, v);
        changed = true;
      }
    })
    );
  }
  return changed;
}
BlockScope.prototype.create$3$isFinal = function($0, $1, $2, isFinal) {
  return this.create($0, $1, $2, isFinal, false);
};
// ********** Code for MethodGenerator **************
function MethodGenerator(method, enclosingMethod) {
  this.enclosingMethod = enclosingMethod;
  this.needsThis = false;
  this.method = method;
  this.writer = new CodeWriter();
  if (this.enclosingMethod != null) {
    this._scope = new BlockScope(this, this.enclosingMethod._scope, this.method.get$definition(), false);
    this.captures = new HashSetImplementation();
  }
  else {
    this._scope = new BlockScope(this, null, this.method.get$definition(), false);
  }
  this._usedTemps = new HashSetImplementation();
  this._freeTemps = [];
  this.counters = $globals.world.counters;
}
MethodGenerator.prototype.get$method = function() { return this.method; };
MethodGenerator.prototype.set$method = function(value) { return this.method = value; };
MethodGenerator.prototype.get$_scope = function() { return this._scope; };
MethodGenerator.prototype.set$_scope = function(value) { return this._scope = value; };
MethodGenerator.prototype.get$enclosingMethod = function() { return this.enclosingMethod; };
MethodGenerator.prototype.set$enclosingMethod = function(value) { return this.enclosingMethod = value; };
MethodGenerator.prototype.get$needsThis = function() { return this.needsThis; };
MethodGenerator.prototype.set$needsThis = function(value) { return this.needsThis = value; };
MethodGenerator.prototype.get$library = function() {
  return this.method.get$library();
}
MethodGenerator.prototype.findMembers = function(name) {
  return this.get$library()._findMembers(name);
}
MethodGenerator.prototype.get$isClosure = function() {
  return (this.enclosingMethod != null);
}
MethodGenerator.prototype.get$isStatic = function() {
  return this.method.get$isStatic();
}
MethodGenerator.prototype.getTemp = function(value) {
  return value.needsTemp ? this.forceTemp(value) : value;
}
MethodGenerator.prototype.forceTemp = function(value) {
  var name;
  if (this._freeTemps.get$length() > (0)) {
    name = this._freeTemps.removeLast();
  }
  else {
    name = "$" + this._usedTemps.get$length();
  }
  this._usedTemps.add(name);
  return new Value(value.type, name, value.span, false);
}
MethodGenerator.prototype.assignTemp = function(tmp, v) {
  if ($eq(tmp, v)) {
    return v;
  }
  else {
    return new Value(v.type, ("(" + tmp.get$code() + " = " + v.get$code() + ")"), v.span, true);
  }
}
MethodGenerator.prototype.freeTemp = function(value) {
  if (this._usedTemps.remove(value.get$code())) {
    this._freeTemps.add(value.get$code());
  }
  else {
    $globals.world.internalError(("tried to free unused value or non-temp \"" + value.get$code() + "\""));
  }
}
MethodGenerator.prototype.run = function() {
  if (this.method.isGenerated) return;
  this.method.isGenerated = true;
  this.method.generator = this;
  var thisObject;
  if (this.method.get$isConstructor()) {
    thisObject = new ObjectValue(false, this.method.declaringType, this.method.get$span());
    thisObject.initFields$0();
  }
  else {
    thisObject = new Value(this.method.declaringType, "this", null, true);
  }
  var values = [];
  var $$list = this.method.get$parameters();
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var p = $$list.$index($$i);
    values.add$1(new Value(p.get$type(), p.get$name(), null, true));
  }
  var args = new Arguments(null, values);
  this.evalBody(thisObject, args);
  if (this.method.get$definition().get$nativeBody() != null) {
    this.writer = new CodeWriter();
    if ($eq(this.method.get$definition().get$nativeBody(), "")) {
      this.method.generator = null;
    }
    else {
      this._paramCode = map(this.method.get$parameters(), (function (p) {
        return p.get$name();
      })
      );
      this.writer.write(this.method.get$definition().get$nativeBody());
    }
  }
}
MethodGenerator.prototype.writeDefinition = function(defWriter, lambda) {
  var paramCode = this._paramCode;
  var names = null;
  if (this.captures != null && this.captures.get$length() > (0)) {
    names = ListFactory.ListFactory$from$factory(this.captures);
    names.sort$1((function (x, y) {
      return x.compareTo$1(y);
    })
    );
    paramCode = ListFactory.ListFactory$from$factory(names);
    paramCode.addAll$1(this._paramCode);
  }
  var _params = ("(" + Strings.join(this._paramCode, ", ") + ")");
  var params = ("(" + Strings.join(paramCode, ", ") + ")");
  var suffix = "}";
  if (this.method.declaringType.get$isTop() && !this.get$isClosure()) {
    defWriter.enterBlock(("function " + this.method.get$jsname() + params + " {"));
  }
  else if (this.get$isClosure()) {
    if (this.method.name == "") {
      defWriter.enterBlock(("(function " + params + " {"));
    }
    else if (names != null) {
      if (lambda == null) {
        defWriter.enterBlock(("var " + this.method.get$jsname() + " = (function" + params + " {"));
      }
      else {
        defWriter.enterBlock(("(function " + this.method.get$jsname() + params + " {"));
      }
    }
    else {
      defWriter.enterBlock(("function " + this.method.get$jsname() + params + " {"));
    }
  }
  else if (this.method.get$isConstructor()) {
    if (this.method.get$constructorName() == "") {
      defWriter.enterBlock(("function " + this.method.declaringType.get$jsname() + params + " {"));
    }
    else {
      defWriter.enterBlock(("" + this.method.declaringType.get$jsname() + "." + this.method.get$constructorName() + "$ctor = function" + params + " {"));
    }
  }
  else if (this.method.get$isFactory()) {
    defWriter.enterBlock(("" + this.method.get$generatedFactoryName() + " = function" + _params + " {"));
  }
  else if (this.method.get$isStatic()) {
    defWriter.enterBlock(("" + this.method.declaringType.get$jsname() + "." + this.method.get$jsname() + " = function" + _params + " {"));
  }
  else {
    suffix = $globals.world.gen._writePrototypePatch(this.method.declaringType, this.method.get$jsname(), ("function" + _params + " {"), defWriter, false);
  }
  if (this.needsThis) {
    defWriter.writeln("var $this = this; // closure support");
  }
  if (this._usedTemps.get$length() > (0) || this._freeTemps.get$length() > (0)) {
    this._freeTemps.addAll(this._usedTemps);
    this._freeTemps.sort((function (x, y) {
      return x.compareTo$1(y);
    })
    );
    defWriter.writeln(("var " + Strings.join(this._freeTemps, ", ") + ";"));
  }
  defWriter.writeln(this.writer.get$text());
  if (names != null) {
    defWriter.exitBlock(("}).bind(null, " + Strings.join(names, ", ") + ")"));
  }
  else if (this.get$isClosure() && this.method.name == "") {
    defWriter.exitBlock("})");
  }
  else {
    defWriter.exitBlock(suffix);
  }
  if (this.method.get$isConstructor() && this.method.get$constructorName() != "") {
    defWriter.writeln(("" + this.method.declaringType.get$jsname() + "." + this.method.get$constructorName() + "$ctor.prototype = ") + ("" + this.method.declaringType.get$jsname() + ".prototype;"));
  }
  this._provideOptionalParamInfo(defWriter);
  if ((this.method instanceof MethodMember)) {
    MethodGenerator._maybeGenerateBoundGetter(this.method, defWriter);
  }
}
MethodGenerator._maybeGenerateBoundGetter = function(m, defWriter) {
  if (m._providePropertySyntax) {
    var suffix = $globals.world.gen._writePrototypePatch(m.declaringType, "get$" + m.get$jsname(), "function() {", defWriter, false);
    defWriter.writeln(("return this." + m.get$jsname() + ".bind(this);"));
    defWriter.exitBlock(suffix);
    if (m._provideFieldSyntax) {
      $globals.world.internalError(("bound \"" + m.name + "\" accessed with field syntax"), m.definition.span);
    }
  }
}
MethodGenerator.prototype._provideOptionalParamInfo = function(defWriter) {
  if ((this.method instanceof MethodMember)) {
    var meth = this.method;
    if (meth._provideOptionalParamInfo) {
      var optNames = [];
      var optValues = [];
      meth.genParameterValues();
      var $$list = meth.parameters;
      for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
        var param = $$list.$index($$i);
        if (param.get$isOptional()) {
          optNames.add$1(param.get$name());
          optValues.add$1(MethodGenerator._escapeString(param.get$value().get$code()));
        }
      }
      if (optNames.get$length() > (0)) {
        var start = "";
        if (meth.isStatic) {
          if (!meth.declaringType.get$isTop()) {
            start = meth.declaringType.get$jsname() + ".";
          }
        }
        else {
          start = meth.declaringType.get$jsname() + ".prototype.";
        }
        optNames.addAll$1(optValues);
        var optional = "['" + Strings.join(optNames, "', '") + "']";
        defWriter.writeln(("" + start + meth.get$jsname() + ".$optional = " + optional));
      }
    }
  }
}
MethodGenerator.prototype._initField = function(newObject, name, value, span) {
  var field = this.method.declaringType.getMember(name);
  if (field == null) {
    $globals.world.error("bad initializer - no matching field", span);
  }
  if (!field.get$isField()) {
    $globals.world.error(("\"this." + name + "\" does not refer to a field"), span);
  }
  return newObject.setField(field, value, true);
}
MethodGenerator.prototype.evalBody = function(newObject, args) {
  var fieldsSet = false;
  if (this.method.get$isNative() && this.method.get$isConstructor() && (newObject instanceof ObjectValue)) {
    newObject.get$dynamic().set$seenNativeInitializer(true);
  }
  this._paramCode = [];
  for (var i = (0);
   i < this.method.get$parameters().get$length(); i++) {
    var p = this.method.get$parameters().$index(i);
    var currentArg = null;
    if (i < args.get$bareCount()) {
      currentArg = args.values.$index(i);
    }
    else {
      currentArg = args.getValue(p.get$name());
      if (currentArg == null) {
        p.genValue$2(this.method, this.method.generator);
        currentArg = p.get$value();
      }
    }
    if (p.get$isInitializer()) {
      this._paramCode.add(p.get$name());
      fieldsSet = true;
      this._initField(newObject, p.get$name(), currentArg, p.get$definition().get$span());
    }
    else {
      var paramValue = this._scope.declareParameter(p);
      this._paramCode.add(paramValue.get$code());
      if (newObject != null && newObject.get$isConst()) {
        this._scope._vars.$setindex(p.get$name(), currentArg);
      }
    }
  }
  var initializerCall = null;
  var declaredInitializers = this.method.get$definition().get$initializers();
  if (declaredInitializers != null) {
    for (var $$i = declaredInitializers.iterator$0(); $$i.hasNext$0(); ) {
      var init = $$i.next$0();
      if ((init instanceof CallExpression)) {
        if (initializerCall != null) {
          $globals.world.error("only one initializer redirecting call is allowed", init.get$span());
        }
        initializerCall = init;
      }
      else if ((init instanceof BinaryExpression) && TokenKind.kindFromAssign(init.get$op().get$kind()) == (0)) {
        var left = init.get$x();
        if (!((left instanceof DotExpression) && (left.get$self() instanceof ThisExpression) || (left instanceof VarExpression))) {
          $globals.world.error("invalid left side of initializer", left.get$span());
          continue;
        }
        var initValue = this.visitValue(init.get$y());
        fieldsSet = true;
        this._initField(newObject, left.get$name().get$name(), initValue, left.get$span());
      }
      else {
        $globals.world.error("invalid initializer", init.get$span());
      }
    }
  }
  if (this.method.get$isConstructor() && initializerCall == null && !this.method.get$isNative()) {
    var parentType = this.method.declaringType.get$parent();
    if (parentType != null && !parentType.get$isObject()) {
      initializerCall = new CallExpression(new SuperExpression(this.method.get$span()), [], this.method.get$span());
    }
  }
  if (this.method.get$isConstructor() && (newObject instanceof ObjectValue)) {
    var fields = newObject.get$dynamic().get$fields();
    var $$list = fields.getKeys$0();
    for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
      var field = $$i.next$0();
      var value = fields.$index(field);
      if (value != null) {
        this.writer.writeln(("this." + field.get$jsname() + " = " + value.get$code() + ";"));
      }
    }
  }
  if (initializerCall != null) {
    this.evalInitializerCall(newObject, initializerCall, fieldsSet);
  }
  if (this.method.get$isConstructor() && newObject != null && newObject.get$isConst()) {
    newObject.validateInitialized(this.method.get$span());
  }
  else if (this.method.get$isConstructor()) {
    var fields = newObject.get$dynamic().get$fields();
    var $$list = fields.getKeys$0();
    for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
      var field = $$i.next$0();
      var value = fields.$index(field);
      if (value == null && field.get$isFinal() && $eq(field.get$declaringType(), this.method.declaringType) && !newObject.get$dynamic().get$seenNativeInitializer()) {
        $globals.world.error(("uninitialized final field \"" + field.get$name() + "\""), field.get$span(), this.method.get$span());
      }
    }
  }
  var body = this.method.get$definition().get$body();
  if (body == null) {
    if (!this.method.get$isConstructor() && !this.method.get$isNative()) {
      $globals.world.error(("unexpected empty body for " + this.method.name), this.method.get$definition().get$span());
    }
  }
  else {
    this.visitStatementsInBlock(body);
  }
}
MethodGenerator.prototype.evalInitializerCall = function(newObject, node, fieldsSet) {
  var contructorName = "";
  var targetExp = node.target;
  if ((targetExp instanceof DotExpression)) {
    var dot = targetExp;
    targetExp = dot.self;
    contructorName = dot.name.name;
  }
  var targetType = null;
  var target = null;
  if ((targetExp instanceof SuperExpression)) {
    targetType = this.method.declaringType.get$parent();
    target = this._makeSuperValue(targetExp);
  }
  else if ((targetExp instanceof ThisExpression)) {
    targetType = this.method.declaringType;
    target = this._makeThisValue(targetExp);
    if (fieldsSet) {
      $globals.world.error("no initialization allowed with redirecting constructor", node.span);
    }
  }
  else {
    $globals.world.error("bad call in initializers", node.span);
  }
  var m = targetType.getConstructor(contructorName);
  if (m == null) {
    $globals.world.error(("no matching constructor for " + targetType.name), node.span);
  }
  this.method.set$initDelegate(m);
  var other = m;
  while (other != null) {
    if ($eq(other, this.method)) {
      $globals.world.error("initialization cycle", node.span);
      break;
    }
    other = other.get$initDelegate();
  }
  var newArgs = this._makeArgs(node.arguments);
  $globals.world.gen.genMethod(m);
  m._evalConstConstructor$2(newObject, newArgs);
  if (!newObject.isConst) {
    var value = m.invoke$4(this, node, target, newArgs);
    if ($ne(target.get$type(), $globals.world.objectType)) {
      this.writer.writeln(("" + value.get$code() + ";"));
    }
  }
}
MethodGenerator.prototype._makeArgs = function(arguments) {
  var args = [];
  var seenLabel = false;
  for (var $$i = 0;$$i < arguments.get$length(); $$i++) {
    var arg = arguments.$index($$i);
    if (arg.get$label() != null) {
      seenLabel = true;
    }
    else if (seenLabel) {
      $globals.world.error("bare argument can not follow named arguments", arg.get$span());
    }
    args.add$1(this.visitValue(arg.get$value()));
  }
  return new Arguments(arguments, args);
}
MethodGenerator.prototype._invokeNative = function(name, arguments) {
  var args = Arguments.get$EMPTY();
  if (arguments.get$length() > (0)) {
    args = new Arguments(null, arguments);
  }
  var method = $globals.world.corelib.topType.members.$index(name);
  return method.invoke$4(this, method.get$definition(), new Value($globals.world.corelib.topType, null, null, true), args);
}
MethodGenerator._escapeString = function(text) {
  return text.replaceAll("\\", "\\\\").replaceAll("\"", "\\\"").replaceAll("\n", "\\n").replaceAll("\r", "\\r");
}
MethodGenerator.prototype.visitStatementsInBlock = function(body) {
  if ((body instanceof BlockStatement)) {
    var block = body;
    var $$list = block.body;
    for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
      var stmt = $$list.$index($$i);
      stmt.visit$1(this);
    }
  }
  else {
    if (body != null) body.visit(this);
  }
  return false;
}
MethodGenerator.prototype._pushBlock = function(node, reentrant) {
  this._scope = new BlockScope(this, this._scope, node, reentrant);
}
MethodGenerator.prototype._popBlock = function(node) {
  if (this._scope.node != node) {
    function spanOf(n) {
      return n != null ? n.get$span() : null;
    }
    $globals.world.internalError(("scope mismatch. Trying to pop \"" + node + "\" but found ") + (" \"" + this._scope.node + "\""), spanOf(node), spanOf(this._scope.node));
  }
  this._scope = this._scope.parent;
}
MethodGenerator.prototype._visitLoop = function(node, visitBody) {
  if (this._scope.inferTypes) {
    this._loopFixedPoint(node, visitBody);
  }
  else {
    this._pushBlock(node, true);
    visitBody();
    this._popBlock(node);
  }
}
MethodGenerator.prototype._loopFixedPoint = function(node, visitBody) {
  var savedCounters = this.counters;
  var savedWriter = this.writer;
  var tries = (0);
  var startScope = this._scope.snapshot();
  var s = startScope;
  while (true) {
    this.writer = new CodeWriter();
    this.counters = new CounterLog();
    this._pushBlock(node, true);
    if (tries++ >= $globals.options.maxInferenceIterations) {
      this._scope.inferTypes = false;
    }
    visitBody();
    this._popBlock(node);
    if (!this._scope.inferTypes || !this._scope.unionWith(s)) {
      break;
    }
    s = this._scope.snapshot();
  }
  savedWriter.write$1(this.writer.get$text());
  this.writer = savedWriter;
  savedCounters.add$1(this.counters);
  this.counters = savedCounters;
}
MethodGenerator.prototype._makeLambdaMethod = function(name, func) {
  var meth = new MethodMember(name, this.method.declaringType, func);
  meth.set$isLambda(true);
  meth.set$enclosingElement(this.method);
  meth.resolve$0();
  return meth;
}
MethodGenerator.prototype.visitBool = function(node) {
  return this.visitValue(node).convertTo$2(this, $globals.world.nonNullBool);
}
MethodGenerator.prototype.visitValue = function(node) {
  if (node == null) return null;
  var value = node.visit(this);
  value.checkFirstClass$1(node.span);
  return value;
}
MethodGenerator.prototype.visitTypedValue = function(node, expectedType) {
  var val = this.visitValue(node);
  return expectedType == null ? val : val.convertTo$2(this, expectedType);
}
MethodGenerator.prototype.visitVoid = function(node) {
  if ((node instanceof PostfixExpression)) {
    var value = this.visitPostfixExpression(node, true);
    value.checkFirstClass$1(node.span);
    return value;
  }
  else if ((node instanceof BinaryExpression)) {
    var value = this.visitBinaryExpression(node, true);
    value.checkFirstClass$1(node.span);
    return value;
  }
  return this.visitValue(node);
}
MethodGenerator.prototype.visitDietStatement = function(node) {
  var parser = new Parser(node.span.file, false, false, false, node.span.start);
  this.visitStatementsInBlock(parser.block$0());
  return false;
}
MethodGenerator.prototype.visitVariableDefinition = function(node) {
  var isFinal = false;
  if (node.modifiers != null && $eq(node.modifiers.$index((0)).get$kind(), (99))) {
    isFinal = true;
  }
  this.writer.write("var ");
  var type = this.method.resolveType$2(node.type, false);
  for (var i = (0);
   i < node.names.get$length(); i++) {
    if (i > (0)) {
      this.writer.write(", ");
    }
    var name = node.names.$index(i).get$name();
    var value = this.visitValue(node.values.$index(i));
    if (isFinal && value == null) {
      $globals.world.error("no value specified for final variable", node.span);
    }
    var val = this._scope.create(name, type, node.names.$index(i).get$span(), isFinal, false);
    if (value == null) {
      if (this._scope.reentrant) {
        this.writer.write(("" + val.get$code() + " = null"));
      }
      else {
        this.writer.write(("" + val.get$code()));
      }
    }
    else {
      value = value.convertTo$2(this, type);
      this._scope.assign(name, value);
      this.writer.write(("" + val.get$code() + " = " + value.get$code()));
    }
  }
  this.writer.writeln(";");
  return false;
}
MethodGenerator.prototype.visitFunctionDefinition = function(node) {
  var meth = this._makeLambdaMethod(node.name.name, node);
  var funcValue = this._scope.create(meth.get$name(), meth.get$functionType(), this.method.get$definition().get$span(), true, false);
  $globals.world.gen.genMethod(meth, this);
  meth.get$generator().writeDefinition$2(this.writer);
  return false;
}
MethodGenerator.prototype.visitReturnStatement = function(node) {
  if (node.value == null) {
    this.writer.writeln("return;");
  }
  else {
    if (this.method.get$isConstructor()) {
      $globals.world.error("return of value not allowed from constructor", node.span);
    }
    var value = this.visitTypedValue(node.value, this.method.get$returnType());
    this.writer.writeln(("return " + value.get$code() + ";"));
  }
  return true;
}
MethodGenerator.prototype.visitThrowStatement = function(node) {
  if (node.value != null) {
    var value = this.visitValue(node.value);
    value.invoke$4(this, "toString", node, Arguments.get$EMPTY());
    this.writer.writeln(("$throw(" + value.get$code() + ");"));
    $globals.world.gen.corejs.useThrow = true;
  }
  else {
    var rethrow = this._scope.getRethrow();
    if (rethrow == null) {
      $globals.world.error("rethrow outside of catch", node.span);
    }
    else {
      this.writer.writeln(("throw " + rethrow + ";"));
    }
  }
  return true;
}
MethodGenerator.prototype.visitAssertStatement = function(node) {
  var test = this.visitValue(node.test);
  if ($globals.options.enableAsserts) {
    var span = node.test.span;
    var line = span.get$file().getLine$1(span.get$start()) + (1);
    var column = span.get$file().getColumn$2(line - (1), span.get$start()) + (1);
    var args = [test, Value.fromString(span.get$text(), node.span), Value.fromString(span.get$file().get$filename(), node.span), Value.fromInt(line, node.span), Value.fromInt(column, node.span)];
    var tp = $globals.world.corelib.topType;
    var f = tp.getMember$1("_assert");
    var value = f.invoke(this, node, new Value.type$ctor(tp, null), new Arguments(null, args), false);
    this.writer.writeln(("" + value.get$code() + ";"));
  }
  return false;
}
MethodGenerator.prototype.visitBreakStatement = function(node) {
  if (node.label == null) {
    this.writer.writeln("break;");
  }
  else {
    this.writer.writeln(("break " + node.label.name + ";"));
  }
  return true;
}
MethodGenerator.prototype.visitContinueStatement = function(node) {
  if (node.label == null) {
    this.writer.writeln("continue;");
  }
  else {
    this.writer.writeln(("continue " + node.label.name + ";"));
  }
  return true;
}
MethodGenerator.prototype.visitIfStatement = function(node) {
  var test = this.visitBool(node.test);
  this.writer.write(("if (" + test.get$code() + ") "));
  var exit1 = node.trueBranch.visit(this);
  if (node.falseBranch != null) {
    this.writer.write("else ");
    if (node.falseBranch.visit(this) && exit1) {
      return true;
    }
  }
  return false;
}
MethodGenerator.prototype.visitWhileStatement = function(node) {
  var $this = this; // closure support
  var test = this.visitBool(node.test);
  this.writer.write(("while (" + test.get$code() + ") "));
  this._visitLoop(node, (function () {
    node.body.visit($this);
  })
  );
  return false;
}
MethodGenerator.prototype.visitDoStatement = function(node) {
  var $this = this; // closure support
  this.writer.write("do ");
  this._visitLoop(node, (function () {
    node.body.visit($this);
  })
  );
  var test = this.visitBool(node.test);
  this.writer.writeln(("while (" + test.get$code() + ")"));
  return false;
}
MethodGenerator.prototype.visitForStatement = function(node) {
  var $this = this; // closure support
  this._pushBlock(node, false);
  this.writer.write("for (");
  if (node.init != null) {
    node.init.visit(this);
  }
  else {
    this.writer.write(";");
  }
  this._visitLoop(node, (function () {
    if (node.test != null) {
      var test = $this.visitBool(node.test);
      $this.writer.write((" " + test.get$code() + "; "));
    }
    else {
      $this.writer.write("; ");
    }
    var needsComma = false;
    var $$list = node.step;
    for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
      var s = $$list.$index($$i);
      if (needsComma) $this.writer.write(", ");
      var sv = $this.visitVoid(s);
      $this.writer.write(sv.get$code());
      needsComma = true;
    }
    $this.writer.write(") ");
    $this._pushBlock(node.body, false);
    node.body.visit($this);
    $this._popBlock(node.body);
  })
  );
  this._popBlock(node);
  return false;
}
MethodGenerator.prototype._isFinal = function(typeRef) {
  if ((typeRef instanceof GenericTypeReference)) {
    typeRef = typeRef.get$baseType();
  }
  return typeRef != null && typeRef.get$isFinal();
}
MethodGenerator.prototype.visitForInStatement = function(node) {
  var $this = this; // closure support
  var itemType = this.method.resolveType$2(node.item.type, false);
  var list = node.list.visit(this);
  this._visitLoop(node, (function () {
    $this._visitForInBody(node, itemType, list);
  })
  );
  return false;
}
MethodGenerator.prototype._visitForInBody = function(node, itemType, list) {
  var isFinal = this._isFinal(node.item.type);
  var itemName = node.item.name.name;
  var item = this._scope.create(itemName, itemType, node.item.name.span, isFinal, false);
  if (list.needsTemp) {
    var listVar = this._scope.create("$list", list.type, null, false, false);
    this.writer.writeln(("var " + listVar.get$code() + " = " + list.get$code() + ";"));
    list = listVar;
  }
  if (list.type.get$isList()) {
    var tmpi = this._scope.create("$i", $globals.world.numType, null, false, false);
    var listLength = list.get_(this, "length", node.list);
    this.writer.enterBlock(("for (var " + tmpi.get$code() + " = 0;") + ("" + tmpi.get$code() + " < " + listLength.get$code() + "; " + tmpi.get$code() + "++) {"));
    var value = list.invoke(this, ":index", node.list, new Arguments(null, [tmpi]), false);
    this.writer.writeln(("var " + item.get$code() + " = " + value.get$code() + ";"));
  }
  else {
    var iterator = list.invoke(this, "iterator", node.list, Arguments.get$EMPTY(), false);
    var tmpi = this._scope.create("$i", iterator.get$type(), null, false, false);
    var hasNext = tmpi.invoke$4(this, "hasNext", node.list, Arguments.get$EMPTY());
    var next = tmpi.invoke$4(this, "next", node.list, Arguments.get$EMPTY());
    this.writer.enterBlock(("for (var " + tmpi.get$code() + " = " + iterator.get$code() + "; " + hasNext.get$code() + "; ) {"));
    this.writer.writeln(("var " + item.get$code() + " = " + next.get$code() + ";"));
  }
  this.visitStatementsInBlock(node.body);
  this.writer.exitBlock("}");
}
MethodGenerator.prototype._genToDartException = function(ex) {
  var result = this._invokeNative("_toDartException", [ex]);
  this.writer.writeln(("" + ex.get$code() + " = " + result.get$code() + ";"));
}
MethodGenerator.prototype._genStackTraceOf = function(trace, ex) {
  var result = this._invokeNative("_stackTraceOf", [ex]);
  this.writer.writeln(("var " + trace.get$code() + " = " + result.get$code() + ";"));
}
MethodGenerator.prototype.visitTryStatement = function(node) {
  this.writer.enterBlock("try {");
  this._pushBlock(node.body, false);
  this.visitStatementsInBlock(node.body);
  this._popBlock(node.body);
  if (node.catches.get$length() == (1)) {
    var catch_ = node.catches.$index((0));
    this._pushBlock(catch_, false);
    var exType = this.method.resolveType$2(catch_.get$exception().get$type(), false);
    var ex = this._scope.declare(catch_.get$exception());
    this._scope.rethrow = ex.get$code();
    this.writer.nextBlock(("} catch (" + ex.get$code() + ") {"));
    if (catch_.get$trace() != null) {
      var trace = this._scope.declare(catch_.get$trace());
      this._genStackTraceOf(trace, ex);
    }
    this._genToDartException(ex);
    if (!exType.get$isVarOrObject()) {
      var test = ex.instanceOf$3$isTrue$forceCheck(this, exType, catch_.get$exception().get$span(), false, true);
      this.writer.writeln(("if (" + test.get$code() + ") throw " + ex.get$code() + ";"));
    }
    this.visitStatementsInBlock(node.catches.$index((0)).get$body());
    this._popBlock(catch_);
  }
  else if (node.catches.get$length() > (0)) {
    this._pushBlock(node, false);
    var ex = this._scope.create("$ex", $globals.world.varType, null, false, false);
    this._scope.rethrow = ex.get$code();
    this.writer.nextBlock(("} catch (" + ex.get$code() + ") {"));
    var trace = null;
    if (node.catches.some((function (c) {
      return c.get$trace() != null;
    })
    )) {
      trace = this._scope.create("$trace", $globals.world.varType, null, false, false);
      this._genStackTraceOf(trace, ex);
    }
    this._genToDartException(ex);
    var needsRethrow = true;
    for (var i = (0);
     i < node.catches.get$length(); i++) {
      var catch_ = node.catches.$index(i);
      this._pushBlock(catch_, false);
      var tmpType = this.method.resolveType$2(catch_.get$exception().get$type(), false);
      var tmp = this._scope.declare(catch_.get$exception());
      if (!tmpType.get$isVarOrObject()) {
        var test = ex.instanceOf$3$isTrue$forceCheck(this, tmpType, catch_.get$exception().get$span(), true, true);
        if (i == (0)) {
          this.writer.enterBlock(("if (" + test.get$code() + ") {"));
        }
        else {
          this.writer.nextBlock(("} else if (" + test.get$code() + ") {"));
        }
      }
      else if (i > (0)) {
        this.writer.nextBlock("} else {");
      }
      this.writer.writeln(("var " + tmp.get$code() + " = " + ex.get$code() + ";"));
      if (catch_.get$trace() != null) {
        var tmptrace = this._scope.declare(catch_.get$trace());
        this.writer.writeln(("var " + tmptrace.get$code() + " = " + trace.get$code() + ";"));
      }
      this.visitStatementsInBlock(catch_.get$body());
      this._popBlock(catch_);
      if (tmpType.get$isVarOrObject()) {
        if (i + (1) < node.catches.get$length()) {
          $globals.world.error("Unreachable catch clause", node.catches.$index(i + (1)).get$span());
        }
        if (i > (0)) {
          this.writer.exitBlock("}");
        }
        needsRethrow = false;
        break;
      }
    }
    if (needsRethrow) {
      this.writer.nextBlock("} else {");
      this.writer.writeln(("throw " + ex.get$code() + ";"));
      this.writer.exitBlock("}");
    }
    this._popBlock(node);
  }
  if (node.finallyBlock != null) {
    this.writer.nextBlock("} finally {");
    this._pushBlock(node.finallyBlock, false);
    this.visitStatementsInBlock(node.finallyBlock);
    this._popBlock(node.finallyBlock);
  }
  this.writer.exitBlock("}");
  return false;
}
MethodGenerator.prototype.visitSwitchStatement = function(node) {
  var test = this.visitValue(node.test);
  this.writer.enterBlock(("switch (" + test.get$code() + ") {"));
  var $$list = node.cases;
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var case_ = $$list.$index($$i);
    if (case_.get$label() != null) {
      $globals.world.error("unimplemented: labeled case statement", case_.get$span());
    }
    this._pushBlock(case_, false);
    for (var i = (0);
     i < case_.get$cases().get$length(); i++) {
      var expr = case_.get$cases().$index(i);
      if (expr == null) {
        if (i < case_.get$cases().get$length() - (1)) {
          $globals.world.error("default clause must be the last case", case_.get$span());
        }
        this.writer.writeln("default:");
      }
      else {
        var value = this.visitValue(expr);
        this.writer.writeln(("case " + value.get$code() + ":"));
      }
    }
    this.writer.enterBlock("");
    var caseExits = this._visitAllStatements(case_.get$statements(), false);
    if ($ne(case_, node.cases.$index(node.cases.get$length() - (1))) && !caseExits) {
      var span = case_.get$statements().$index(case_.get$statements().get$length() - (1)).get$span();
      this.writer.writeln("$throw(new FallThroughError());");
      $globals.world.gen.corejs.useThrow = true;
    }
    this.writer.exitBlock("");
    this._popBlock(case_);
  }
  this.writer.exitBlock("}");
  return false;
}
MethodGenerator.prototype._visitAllStatements = function(statementList, exits) {
  for (var i = (0);
   i < statementList.get$length(); i++) {
    var stmt = statementList.$index(i);
    exits = stmt.visit$1(this);
    if ($ne(stmt, statementList.$index(statementList.get$length() - (1))) && exits) {
      $globals.world.warning("unreachable code", statementList.$index(i + (1)).get$span());
    }
  }
  return exits;
}
MethodGenerator.prototype.visitBlockStatement = function(node) {
  this._pushBlock(node, false);
  this.writer.enterBlock("{");
  var exits = this._visitAllStatements(node.body, false);
  this.writer.exitBlock("}");
  this._popBlock(node);
  return exits;
}
MethodGenerator.prototype.visitLabeledStatement = function(node) {
  this.writer.writeln(("" + node.name.name + ":"));
  node.body.visit(this);
  return false;
}
MethodGenerator.prototype.visitExpressionStatement = function(node) {
  if ((node.body instanceof VarExpression) || (node.body instanceof ThisExpression)) {
    $globals.world.warning("variable used as statement", node.span);
  }
  var value = this.visitVoid(node.body);
  this.writer.writeln(("" + value.get$code() + ";"));
  return false;
}
MethodGenerator.prototype.visitEmptyStatement = function(node) {
  this.writer.writeln(";");
  return false;
}
MethodGenerator.prototype._checkNonStatic = function(node) {
  if (this.get$isStatic()) {
    $globals.world.warning("not allowed in static method", node.span);
  }
}
MethodGenerator.prototype._makeSuperValue = function(node) {
  var parentType = this.method.declaringType.get$parent();
  this._checkNonStatic(node);
  if (parentType == null) {
    $globals.world.error("no super class", node.span);
  }
  var ret = new Value(parentType, "this", node.span, false);
  ret.set$isSuper(true);
  return ret;
}
MethodGenerator.prototype._getOutermostMethod = function() {
  var result = this;
  while (result.get$enclosingMethod() != null) {
    result = result.get$enclosingMethod();
  }
  return result;
}
MethodGenerator.prototype._makeThisCode = function() {
  if (this.enclosingMethod != null) {
    this._getOutermostMethod().set$needsThis(true);
    return "$this";
  }
  else {
    return "this";
  }
}
MethodGenerator.prototype._makeThisValue = function(node) {
  if (this.enclosingMethod != null) {
    var outermostMethod = this._getOutermostMethod();
    outermostMethod._checkNonStatic$1(node);
    outermostMethod.set$needsThis(true);
    return new Value(outermostMethod.get$method().get$declaringType(), "$this", node != null ? node.span : null, false);
  }
  else {
    this._checkNonStatic(node);
    return new Value(this.method.declaringType, "this", node != null ? node.span : null, false);
  }
}
MethodGenerator.prototype.visitLambdaExpression = function(node) {
  var name = (node.func.name != null) ? node.func.name.name : "";
  var meth = this._makeLambdaMethod(name, node.func);
  var lambdaGen = new MethodGenerator(meth, this);
  if ($ne(name, "")) {
    lambdaGen.get$_scope().create$3$isFinal(name, meth.get$functionType(), meth.definition.span, true);
    lambdaGen._pushBlock$1(node);
  }
  lambdaGen.run$0();
  var w = new CodeWriter();
  meth.generator.writeDefinition(w, node);
  return new Value(meth.get$functionType(), w.get$text(), node.span, true);
}
MethodGenerator.prototype.visitCallExpression = function(node) {
  var target;
  var position = node.target;
  var name = ":call";
  if ((node.target instanceof DotExpression)) {
    var dot = node.target;
    target = dot.self.visit(this);
    name = dot.name.name;
    position = dot.name;
  }
  else if ((node.target instanceof VarExpression)) {
    var varExpr = node.target;
    name = varExpr.name.name;
    target = this._scope.lookup(name);
    if (target != null) {
      return target.invoke$4(this, ":call", node, this._makeArgs(node.arguments));
    }
    target = this._makeThisOrType(varExpr.span);
    return target.invoke$4(this, name, node, this._makeArgs(node.arguments));
  }
  else {
    target = node.target.visit(this);
  }
  return target.invoke$4(this, name, position, this._makeArgs(node.arguments));
}
MethodGenerator.prototype.visitIndexExpression = function(node) {
  var target = this.visitValue(node.target);
  var index = this.visitValue(node.index);
  return target.invoke$4(this, ":index", node, new Arguments(null, [index]));
}
MethodGenerator.prototype._expressionNeedsParens = function(e) {
  return ((e instanceof BinaryExpression) || (e instanceof ConditionalExpression) || (e instanceof PostfixExpression) || this._isUnaryIncrement(e));
}
MethodGenerator.prototype.visitBinaryExpression = function(node, isVoid) {
  var kind = node.op.kind;
  if ($eq(kind, (35)) || $eq(kind, (34))) {
    var x = this.visitTypedValue(node.x, $globals.world.nonNullBool);
    var y = this.visitTypedValue(node.y, $globals.world.nonNullBool);
    return x.binop$4(kind, y, this, node);
  }
  else if ($eq(kind, (50)) || $eq(kind, (51))) {
    var x = this.visitValue(node.x);
    var y = this.visitValue(node.y);
    return x.binop$4(kind, y, this, node);
  }
  var assignKind = TokenKind.kindFromAssign(node.op.kind);
  if ($eq(assignKind, (-1))) {
    var x = this.visitValue(node.x);
    var y = this.visitValue(node.y);
    return x.binop$4(kind, y, this, node);
  }
  else if (($ne(assignKind, (0))) && this._expressionNeedsParens(node.y)) {
    return this._visitAssign(assignKind, node.x, new ParenExpression(node.y, node.y.span), node, to$call$1(null), isVoid);
  }
  else {
    return this._visitAssign(assignKind, node.x, node.y, node, to$call$1(null), isVoid);
  }
}
MethodGenerator.prototype._visitAssign = function(kind, xn, yn, position, captureOriginal, isVoid) {
  if (captureOriginal == null) {
    captureOriginal = (function (x) {
      return x;
    })
    ;
  }
  if ((xn instanceof VarExpression)) {
    return this._visitVarAssign(kind, xn, yn, position, captureOriginal);
  }
  else if ((xn instanceof IndexExpression)) {
    return this._visitIndexAssign(kind, xn, yn, position, captureOriginal, isVoid);
  }
  else if ((xn instanceof DotExpression)) {
    return this._visitDotAssign(kind, xn, yn, position, captureOriginal);
  }
  else {
    $globals.world.error("illegal lhs", xn.span);
  }
}
MethodGenerator.prototype._visitVarAssign = function(kind, xn, yn, position, captureOriginal) {
  var name = xn.name.name;
  var x = this._scope.lookup(name);
  var y = this.visitValue(yn);
  if (x != null) {
    y = y.convertTo$2(this, x.get$staticType());
    this._scope.assign(name, Value.union(x, y));
  }
  else {
    var members = this.method.declaringType.resolveMember(name);
    x = this._makeThisOrType(position.span);
    if (members != null) {
      if ($globals.options.forceDynamic && !members.get$isStatic()) {
        members = this.findMembers(xn.name.name);
      }
      if (kind == (0)) {
        return x.set_$4(this, name, position, y);
      }
      else if (!members.get$treatAsField() || members.get$containsMethods()) {
        var right = x.get_$3(this, name, position);
        right = captureOriginal(right);
        y = right.invoke$4(this, TokenKind.binaryMethodName(kind), position, new Arguments(null, [y]));
        return x.set_$4(this, name, position, y);
      }
      else {
        x = x.get_$3(this, name, position);
      }
    }
    else {
      var member = this.get$library().lookup(name, xn.name.span);
      if (member == null) {
        $globals.world.warning(("can not resolve " + name), xn.span);
        return this._makeMissingValue(name);
      }
      members = new MemberSet(member, false);
      if (!members.get$treatAsField() || members.get$containsMethods()) {
        if (kind != (0)) {
          var right = members._get$3(this, position, x);
          right = captureOriginal(right);
          y = right.invoke$4(this, TokenKind.binaryMethodName(kind), position, new Arguments(null, [y]));
        }
        return members._set$4(this, position, x, y);
      }
      else {
        x = members._get$3(this, position, x);
      }
    }
    y = y.convertTo$2(this, x.get$staticType());
  }
  if (x.get$isFinal()) {
    $globals.world.error(("final variable \"" + x.get$code() + "\" is not assignable"), position.span);
  }
  if (kind == (0)) {
    x = captureOriginal(x);
    return new Value(y.get$type(), ("" + x.get$code() + " = " + y.get$code()), position.span, true);
  }
  else if (x.get$type().get$isNum() && y.get$type().get$isNum() && (kind != (46))) {
    x = captureOriginal(x);
    var op = TokenKind.kindToString(kind);
    return new Value(y.get$type(), ("" + x.get$code() + " " + op + "= " + y.get$code()), position.span, true);
  }
  else {
    var right = x;
    right = captureOriginal(right);
    y = right.invoke$4(this, TokenKind.binaryMethodName(kind), position, new Arguments(null, [y]));
    return new Value(y.get$type(), ("" + x.get$code() + " = " + y.get$code()), position.span, true);
  }
}
MethodGenerator.prototype._visitIndexAssign = function(kind, xn, yn, position, captureOriginal, isVoid) {
  var target = this.visitValue(xn.target);
  var index = this.visitValue(xn.index);
  var y = this.visitValue(yn);
  var tmptarget = target;
  var tmpindex = index;
  if (kind != (0)) {
    tmptarget = this.getTemp(target);
    tmpindex = this.getTemp(index);
    index = this.assignTemp(tmpindex, index);
    var right = tmptarget.invoke$4(this, ":index", position, new Arguments(null, [tmpindex]));
    right = captureOriginal(right);
    y = right.invoke$4(this, TokenKind.binaryMethodName(kind), position, new Arguments(null, [y]));
  }
  var tmpy = null;
  if (!isVoid) {
    tmpy = this.getTemp(y);
    y = this.assignTemp(tmpy, y);
  }
  var ret = this.assignTemp(tmptarget, target).invoke(this, ":setindex", position, new Arguments(null, [index, y]), false);
  if (tmpy != null) {
    ret = new Value(ret.get$type(), ("(" + ret.get$code() + ", " + tmpy.get$code() + ")"), ret.get$span(), true);
    if ($ne(tmpy, y)) this.freeTemp(tmpy);
  }
  if ($ne(tmptarget, target)) this.freeTemp(tmptarget);
  if ($ne(tmpindex, index)) this.freeTemp(tmpindex);
  return ret;
}
MethodGenerator.prototype._visitDotAssign = function(kind, xn, yn, position, captureOriginal) {
  var target = xn.self.visit(this);
  var y = this.visitValue(yn);
  var tmptarget = target;
  if (kind != (0)) {
    tmptarget = this.getTemp(target);
    var right = tmptarget.get_$3(this, xn.name.name, xn.name);
    right = captureOriginal(right);
    y = right.invoke$4(this, TokenKind.binaryMethodName(kind), position, new Arguments(null, [y]));
  }
  var ret = this.assignTemp(tmptarget, target).set_(this, xn.name.name, xn.name, y, false);
  if ($ne(tmptarget, target)) this.freeTemp(tmptarget);
  return ret;
}
MethodGenerator.prototype.visitUnaryExpression = function(node) {
  var value = this.visitValue(node.self);
  switch (node.op.kind) {
    case (16):
    case (17):

      if (value.get$type().get$isNum()) {
        return new Value(value.get$type(), ("" + node.op + value.get$code()), node.span, true);
      }
      else {
        var kind = ((16) == node.op.kind ? (42) : (43));
        var operand = new LiteralExpression(Value.fromInt((1), node.span), node.span);
        var assignValue = this._visitAssign(kind, node.self, operand, node, to$call$1(null), false);
        return new Value(assignValue.get$type(), ("(" + assignValue.get$code() + ")"), node.span, true);
      }

  }
  return value.unop$3(node.op.kind, this, node);
}
MethodGenerator.prototype.visitDeclaredIdentifier = function(node) {
  $globals.world.error("Expected expression", node.span);
}
MethodGenerator.prototype.visitAwaitExpression = function(node) {
  $globals.world.internalError("Await expressions should have been eliminated before code generation", node.span);
}
MethodGenerator.prototype.visitPostfixExpression = function(node, isVoid) {
  var $this = this; // closure support
  var value = this.visitValue(node.body);
  if (value.get$type().get$isNum() && !value.get$isFinal()) {
    return new Value(value.get$type(), ("" + value.get$code() + node.op), node.span, true);
  }
  var kind = ((16) == node.op.kind) ? (42) : (43);
  var operand = new LiteralExpression(Value.fromInt((1), node.span), node.span);
  var tmpleft = null, left = null;
  var ret = this._visitAssign(kind, node.body, operand, node, (function (l) {
    if (isVoid) {
      return l;
    }
    else {
      left = l;
      tmpleft = $this.forceTemp(l);
      return $this.assignTemp(tmpleft, left);
    }
  })
  , false);
  if (tmpleft != null) {
    ret = new Value(ret.get$type(), ("(" + ret.get$code() + ", " + tmpleft.get$code() + ")"), node.span, true);
  }
  if ($ne(tmpleft, left)) {
    this.freeTemp(tmpleft);
  }
  return ret;
}
MethodGenerator.prototype.visitNewExpression = function(node) {
  var typeRef = node.type;
  var constructorName = "";
  if (node.name != null) {
    constructorName = node.name.name;
  }
  if ($eq(constructorName, "") && !(typeRef instanceof GenericTypeReference) && typeRef.get$names() != null) {
    var names = ListFactory.ListFactory$from$factory(typeRef.get$names());
    constructorName = names.removeLast$0().get$name();
    if ($eq(names.get$length(), (0))) names = null;
    typeRef = new NameTypeReference(typeRef.get$isFinal(), typeRef.get$name(), names, typeRef.get$span());
  }
  var type = this.method.resolveType$2(typeRef, true);
  if (type.get$isTop()) {
    type = type.get$library().findTypeByName$1(constructorName);
    constructorName = "";
  }
  if ((type instanceof ParameterType)) {
    $globals.world.error("cannot instantiate a type parameter", node.span);
    return this._makeMissingValue(constructorName);
  }
  var m = type.getConstructor$1(constructorName);
  if (m == null) {
    var name = type.get$jsname();
    if (type.get$isVar()) {
      name = typeRef.get$name().get$name();
    }
    $globals.world.error(("no matching constructor for " + name), node.span);
    return this._makeMissingValue(name);
  }
  if (node.isConst) {
    if (!m.get$isConst()) {
      $globals.world.error("can't use const on a non-const constructor", node.span);
    }
    var $$list = node.arguments;
    for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
      var arg = $$list.$index($$i);
      if (!this.visitValue(arg.get$value()).get$isConst()) {
        $globals.world.error("const constructor expects const arguments", arg.get$span());
      }
    }
  }
  var target = new Value.type$ctor(type, typeRef.get$span());
  return m.invoke$4(this, node, target, this._makeArgs(node.arguments));
}
MethodGenerator.prototype.visitListExpression = function(node) {
  var argValues = [];
  var listType = $globals.world.listType;
  var type = $globals.world.varType;
  if (node.itemType != null) {
    type = this.method.resolveType$2(node.itemType, true);
    if (node.isConst && ((type instanceof ParameterType) || type.get$hasTypeParams())) {
      $globals.world.error("type parameter cannot be used in const list literals");
    }
    listType = listType.getOrMakeConcreteType$1([type]);
  }
  var $$list = node.values;
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var item = $$list.$index($$i);
    var arg = this.visitTypedValue(item, type);
    argValues.add$1(arg);
    if (node.isConst && !arg.get$isConst()) {
      $globals.world.error("const list can only contain const values", arg.get$span());
    }
  }
  $globals.world.listFactoryType.markUsed();
  var ret = new ListValue(argValues, node.isConst, listType, node.span);
  if (ret.get$isConst()) return ret.getGlobalValue$0();
  return ret;
}
MethodGenerator.prototype.visitMapExpression = function(node) {
  if (node.items.get$length() == (0) && !node.isConst) {
    return $globals.world.mapType.getConstructor("").invoke$4(this, node, new Value.type$ctor($globals.world.mapType, node.span), Arguments.get$EMPTY());
  }
  var values = [];
  var valueType = $globals.world.varType, keyType = $globals.world.stringType;
  var mapType = $globals.world.mapType;
  if (node.valueType != null) {
    if (node.keyType != null) {
      keyType = this.method.resolveType$2(node.keyType, true);
      if (!keyType.get$isString()) {
        $globals.world.error("the key type of a map literal must be \"String\"", keyType.get$span());
      }
      if (node.isConst && ((keyType instanceof ParameterType) || keyType.get$hasTypeParams())) {
        $globals.world.error("type parameter cannot be used in const map literals");
      }
    }
    valueType = this.method.resolveType$2(node.valueType, true);
    if (node.isConst && ((valueType instanceof ParameterType) || valueType.get$hasTypeParams())) {
      $globals.world.error("type parameter cannot be used in const map literals");
    }
    mapType = mapType.getOrMakeConcreteType$1([keyType, valueType]);
  }
  for (var i = (0);
   i < node.items.get$length(); i += (2)) {
    var key = this.visitTypedValue(node.items.$index(i), keyType);
    if (node.isConst && !key.get$isConst()) {
      $globals.world.error("const map can only contain const keys", key.get$span());
    }
    values.add$1(key);
    var value = this.visitTypedValue(node.items.$index(i + (1)), valueType);
    if (node.isConst && !value.get$isConst()) {
      $globals.world.error("const map can only contain const values", value.get$span());
    }
    values.add$1(value);
  }
  var ret = new MapValue(values, node.isConst, mapType, node.span);
  if (ret.get$isConst()) return ret.getGlobalValue$0();
  return ret;
}
MethodGenerator.prototype.visitConditionalExpression = function(node) {
  var test = this.visitBool(node.test);
  var trueBranch = this.visitValue(node.trueBranch);
  var falseBranch = this.visitValue(node.falseBranch);
  return Value.union(trueBranch, falseBranch).replaceCode(("" + test.get$code() + " ? " + trueBranch.get$code() + " : " + falseBranch.get$code()), node.span, true);
}
MethodGenerator.prototype.visitIsExpression = function(node) {
  var value = this.visitValue(node.x);
  var type = this.method.resolveType$2(node.type, false);
  return value.instanceOf$4(this, type, node.span, node.isTrue);
}
MethodGenerator.prototype.visitParenExpression = function(node) {
  var body = this.visitValue(node.body);
  if (body.get$isConst()) return body;
  return new Value(body.get$type(), ("(" + body.get$code() + ")"), node.span, true);
}
MethodGenerator.prototype.visitDotExpression = function(node) {
  var target = node.self.visit(this);
  return target.get_$3(this, node.name.name, node.name);
}
MethodGenerator.prototype.visitVarExpression = function(node) {
  var name = node.name.name;
  var ret = this._scope.lookup(name);
  if (ret != null) return ret;
  return this._makeThisOrType(node.span).get_$3(this, name, node);
}
MethodGenerator.prototype._makeMissingValue = function(name) {
  return new Value($globals.world.varType, ("" + name + "()/*NotFound*/"), null, true);
}
MethodGenerator.prototype._makeThisOrType = function(span) {
  return new BareValue(this, this._getOutermostMethod(), span);
}
MethodGenerator.prototype.visitThisExpression = function(node) {
  return this._makeThisValue(node);
}
MethodGenerator.prototype.visitSuperExpression = function(node) {
  return this._makeSuperValue(node);
}
MethodGenerator.prototype.visitLiteralExpression = function(node) {
  return node.value;
}
MethodGenerator.prototype._isUnaryIncrement = function(item) {
  if ((item instanceof UnaryExpression)) {
    var u = item;
    return u.op.kind == (16) || u.op.kind == (17);
  }
  else {
    return false;
  }
}
MethodGenerator.prototype.visitStringInterpExpression = function(node) {
  var items = [];
  var $$list = node.pieces;
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var item = $$list.$index($$i);
    var val = this.visitValue(item);
    val.invoke$4(this, "toString", item, Arguments.get$EMPTY());
    var code = val.get$code();
    if (this._expressionNeedsParens(item)) {
      code = ("(" + code + ")");
    }
    if ($eq(items.get$length(), (0)) || ($ne(code, "''") && $ne(code, "\"\""))) {
      items.add$1(code);
    }
  }
  return new Value($globals.world.stringType, ("(" + Strings.join(items, " + ") + ")"), node.span, true);
}
MethodGenerator.prototype._checkNonStatic$1 = MethodGenerator.prototype._checkNonStatic;
MethodGenerator.prototype._pushBlock$1 = function($0) {
  return this._pushBlock($0, false);
};
MethodGenerator.prototype.evalBody$2 = MethodGenerator.prototype.evalBody;
MethodGenerator.prototype.run$0 = MethodGenerator.prototype.run;
MethodGenerator.prototype.visitBinaryExpression$1 = function($0) {
  return this.visitBinaryExpression($0, false);
};
MethodGenerator.prototype.visitPostfixExpression$1 = function($0) {
  return this.visitPostfixExpression($0, false);
};
MethodGenerator.prototype.writeDefinition$2 = MethodGenerator.prototype.writeDefinition;
// ********** Code for Arguments **************
function Arguments(nodes, values) {
  this.nodes = nodes;
  this.values = values;
}
Arguments.Arguments$bare$factory = function(arity) {
  var values = [];
  for (var i = (0);
   i < arity; i++) {
    values.add$1(new Value($globals.world.varType, ("$" + i), null, false));
  }
  return new Arguments(null, values);
}
Arguments.get$EMPTY = function() {
  if ($globals.Arguments__empty == null) {
    $globals.Arguments__empty = new Arguments(null, []);
  }
  return $globals.Arguments__empty;
}
Arguments.prototype.get$nameCount = function() {
  return this.get$length() - this.get$bareCount();
}
Arguments.prototype.get$hasNames = function() {
  return this.get$bareCount() < this.get$length();
}
Arguments.prototype.get$length = function() {
  return this.values.get$length();
}
Arguments.prototype.getName = function(i) {
  return this.nodes.$index(i).get$label().get$name();
}
Arguments.prototype.getIndexOfName = function(name) {
  for (var i = this.get$bareCount();
   i < this.get$length(); i++) {
    if (this.getName(i) == name) {
      return i;
    }
  }
  return (-1);
}
Arguments.prototype.getValue = function(name) {
  var i = this.getIndexOfName(name);
  return i >= (0) ? this.values.$index(i) : null;
}
Arguments.prototype.get$bareCount = function() {
  if (this._bareCount == null) {
    this._bareCount = this.get$length();
    if (this.nodes != null) {
      for (var i = (0);
       i < this.nodes.get$length(); i++) {
        if (this.nodes.$index(i).get$label() != null) {
          this._bareCount = i;
          break;
        }
      }
    }
  }
  return this._bareCount;
}
Arguments.prototype.getCode = function() {
  var argsCode = [];
  for (var i = (0);
   i < this.get$length(); i++) {
    argsCode.add$1(this.values.$index(i).get$code());
  }
  Arguments.removeTrailingNulls(argsCode);
  return Strings.join(argsCode, ", ");
}
Arguments.removeTrailingNulls = function(argsCode) {
  while (argsCode.get$length() > (0) && $eq(argsCode.last(), "null")) {
    argsCode.removeLast();
  }
}
Arguments.prototype.getNames = function() {
  var names = [];
  for (var i = this.get$bareCount();
   i < this.get$length(); i++) {
    names.add$1(this.getName(i));
  }
  return names;
}
Arguments.prototype.toCallStubArgs = function() {
  var result = [];
  for (var i = (0);
   i < this.get$bareCount(); i++) {
    result.add$1(new Value($globals.world.varType, ("$" + i), null, false));
  }
  for (var i = this.get$bareCount();
   i < this.get$length(); i++) {
    var name = this.getName(i);
    if (name == null) name = ("$" + i);
    result.add$1(new Value($globals.world.varType, name, null, false));
  }
  return new Arguments(this.nodes, result);
}
// ********** Code for LibraryImport **************
function LibraryImport(library, prefix, span) {
  this.library = library;
  this.span = span;
  this.prefix = prefix;
}
LibraryImport.prototype.get$prefix = function() { return this.prefix; };
LibraryImport.prototype.get$library = function() { return this.library; };
LibraryImport.prototype.get$span = function() { return this.span; };
// ********** Code for Member **************
$inherits(Member, Element);
function Member(name, declaringType) {
  this.isGenerated = false;
  this.declaringType = declaringType;
  this._provideFieldSyntax = false;
  this._providePropertySyntax = false;
  Element.call(this, name, declaringType);
}
Member.prototype.get$declaringType = function() { return this.declaringType; };
Member.prototype.get$isGenerated = function() { return this.isGenerated; };
Member.prototype.set$isGenerated = function(value) { return this.isGenerated = value; };
Member.prototype.get$generator = function() { return this.generator; };
Member.prototype.set$generator = function(value) { return this.generator = value; };
Member.prototype.get$library = function() {
  return this.declaringType.get$library();
}
Member.prototype.get$isPrivate = function() {
  return this.name != null && this.name.startsWith("_");
}
Member.prototype.get$isConstructor = function() {
  return false;
}
Member.prototype.get$isField = function() {
  return false;
}
Member.prototype.get$isMethod = function() {
  return false;
}
Member.prototype.get$isProperty = function() {
  return false;
}
Member.prototype.get$isAbstract = function() {
  return false;
}
Member.prototype.get$isFinal = function() {
  return false;
}
Member.prototype.get$isConst = function() {
  return false;
}
Member.prototype.get$isFactory = function() {
  return false;
}
Member.prototype.get$isOperator = function() {
  return this.name.startsWith(":");
}
Member.prototype.get$isCallMethod = function() {
  return this.name == ":call";
}
Member.prototype.get$requiresPropertySyntax = function() {
  return false;
}
Member.prototype.get$requiresFieldSyntax = function() {
  return false;
}
Member.prototype.get$isNative = function() {
  return false;
}
Member.prototype.get$constructorName = function() {
  $globals.world.internalError("can not be a constructor", this.get$span());
}
Member.prototype.provideFieldSyntax = function() {

}
Member.prototype.providePropertySyntax = function() {

}
Member.prototype.get$initDelegate = function() {
  $globals.world.internalError("cannot have initializers", this.get$span());
}
Member.prototype.set$initDelegate = function(ctor) {
  $globals.world.internalError("cannot have initializers", this.get$span());
}
Member.prototype.computeValue = function() {
  $globals.world.internalError("cannot have value", this.get$span());
}
Member.prototype.get$inferredResult = function() {
  var t = this.get$returnType();
  if (t.get$isBool() && (this.get$library().get$isCore() || this.get$library().get$isCoreImpl())) {
    return $globals.world.nonNullBool;
  }
  return t;
}
Member.prototype.get$definition = function() {
  return null;
}
Member.prototype.get$parameters = function() {
  return [];
}
Member.prototype.canInvoke = function(context, args) {
  return this.get$canGet() && new Value(this.get$returnType(), null, null, true).canInvoke(context, ":call", args);
}
Member.prototype.invoke = function(context, node, target, args, isDynamic) {
  var newTarget = this._get(context, node, target, isDynamic);
  return newTarget.invoke$5(context, ":call", node, args, isDynamic);
}
Member.prototype.override = function(other) {
  if (this.get$isStatic()) {
    $globals.world.error("static members can not hide parent members", this.get$span(), other.get$span());
    return false;
  }
  else if (other.get$isStatic()) {
    $globals.world.error("can not override static member", this.get$span(), other.get$span());
    return false;
  }
  return true;
}
Member.prototype.get$generatedFactoryName = function() {
  var prefix = ("" + this.declaringType.get$jsname() + "." + this.get$constructorName() + "$");
  if (this.name == "") {
    return ("" + prefix + "factory");
  }
  else {
    return ("" + prefix + this.name + "$factory");
  }
}
Member.prototype.hashCode = function() {
  var typeCode = this.declaringType == null ? (1) : this.declaringType.hashCode();
  var nameCode = this.get$isConstructor() ? this.get$constructorName().hashCode() : this.name.hashCode();
  return (typeCode << (4)) ^ nameCode;
}
Member.prototype.$eq = function(other) {
  return (other instanceof Member) && $eq(this.get$isConstructor(), other.get$isConstructor()) && $eq(this.declaringType, other.get$declaringType()) && (this.get$isConstructor() ? this.get$constructorName() == other.get$constructorName() : this.name == other.get$name());
}
Member.prototype._get$3 = Member.prototype._get;
Member.prototype._get$3$isDynamic = Member.prototype._get;
Member.prototype._get$4 = Member.prototype._get;
Member.prototype._set$4 = Member.prototype._set;
Member.prototype._set$4$isDynamic = Member.prototype._set;
Member.prototype._set$5 = Member.prototype._set;
Member.prototype.canInvoke$2 = Member.prototype.canInvoke;
Member.prototype.computeValue$0 = Member.prototype.computeValue;
Member.prototype.hashCode$0 = Member.prototype.hashCode;
Member.prototype.invoke$4 = function($0, $1, $2, $3) {
  return this.invoke($0, $1, $2, $3, false);
};
Member.prototype.invoke$4$isDynamic = Member.prototype.invoke;
Member.prototype.invoke$5 = Member.prototype.invoke;
Member.prototype.provideFieldSyntax$0 = Member.prototype.provideFieldSyntax;
Member.prototype.providePropertySyntax$0 = Member.prototype.providePropertySyntax;
// ********** Code for AmbiguousMember **************
$inherits(AmbiguousMember, Member);
function AmbiguousMember(name, members) {
  this.members = members;
  Member.call(this, name, null);
}
AmbiguousMember.prototype.get$members = function() { return this.members; };
AmbiguousMember.prototype.set$members = function(value) { return this.members = value; };
// ********** Code for Library **************
$inherits(Library, Element);
function Library(baseSource) {
  this.baseSource = baseSource;
  this.isWritten = false;
  Element.call(this, null, null);
  this.sourceDir = dirname(this.baseSource.filename);
  this.topType = new DefinedType(null, this, null, true);
  this.types = _map(["", this.topType]);
  this.imports = [];
  this.natives = [];
  this.sources = [];
  this._privateMembers = new HashMapImplementation();
}
Library.prototype.get$baseSource = function() { return this.baseSource; };
Library.prototype.get$types = function() { return this.types; };
Library.prototype.set$types = function(value) { return this.types = value; };
Library.prototype.get$imports = function() { return this.imports; };
Library.prototype.set$imports = function(value) { return this.imports = value; };
Library.prototype.get$_privateMembers = function() { return this._privateMembers; };
Library.prototype.set$_privateMembers = function(value) { return this._privateMembers = value; };
Library.prototype.get$topType = function() { return this.topType; };
Library.prototype.set$topType = function(value) { return this.topType = value; };
Library.prototype.get$enclosingElement = function() {
  return null;
}
Library.prototype.get$library = function() {
  return this;
}
Library.prototype.get$isNative = function() {
  return this.topType.isNative;
}
Library.prototype.get$isCore = function() {
  return $eq(this, $globals.world.corelib);
}
Library.prototype.get$isCoreImpl = function() {
  return $eq(this, $globals.world.coreimpl);
}
Library.prototype.get$isDom = function() {
  return $eq(this, $globals.world.dom);
}
Library.prototype.get$span = function() {
  return new SourceSpan(this.baseSource, (0), (0));
}
Library.prototype.makeFullPath = function(filename) {
  if (filename.startsWith("dart:")) return filename;
  if (filename.startsWith("/")) return filename;
  if (filename.startsWith("file:///")) return filename;
  if (filename.startsWith("http://")) return filename;
  return joinPaths(this.sourceDir, filename);
}
Library.prototype.addImport = function(fullname, prefix, span) {
  var newLib = $globals.world.getOrAddLibrary(fullname);
  if (newLib.get$isCore()) return;
  this.imports.add(new LibraryImport(newLib, prefix, span));
  return newLib;
}
Library.prototype.addNative = function(fullname) {
  this.natives.add($globals.world.reader.readFile(fullname));
}
Library.prototype._findMembers = function(name) {
  if (name.startsWith("_")) {
    return this._privateMembers.$index(name);
  }
  else {
    return $globals.world._members.$index(name);
  }
}
Library.prototype._addMember = function(member) {
  if (member.get$isPrivate()) {
    if (member.get$isStatic()) {
      if (member.declaringType.get$isTop()) {
        $globals.world._addTopName(member);
      }
      return;
    }
    var mset = this._privateMembers.$index(member.name);
    if (mset == null) {
      var $$list = $globals.world.libraries.getValues();
      for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
        var lib = $$i.next$0();
        if (lib.get$_privateMembers().containsKey$1(member.get$jsname())) {
          member._jsname = ("_" + this.get$jsname() + member.get$jsname());
          break;
        }
      }
      mset = new MemberSet(member, true);
      this._privateMembers.$setindex(member.name, mset);
    }
    else {
      mset.get$members().add$1(member);
    }
  }
  else {
    $globals.world._addMember(member);
  }
}
Library.prototype.getOrAddFunctionType = function(enclosingElement, name, func) {
  var def = new FunctionTypeDefinition(func, null, func.span);
  var type = new DefinedType(name, this, def, false);
  type.addMethod$2(":call", func);
  var m = type.get$members().$index(":call");
  m.set$enclosingElement(enclosingElement);
  m.resolve$0();
  type.set$interfaces([$globals.world.functionType]);
  return type;
}
Library.prototype.addType = function(name, definition, isClass) {
  if (this.types.containsKey(name)) {
    var existingType = this.types.$index(name);
    if ((this.get$isCore() || this.get$isCoreImpl()) && existingType.get$definition() == null) {
      existingType.setDefinition$1(definition);
    }
    else {
      $globals.world.warning(("duplicate definition of " + name), definition.span, existingType.get$span());
    }
  }
  else {
    this.types.$setindex(name, new DefinedType(name, this, definition, isClass));
  }
  return this.types.$index(name);
}
Library.prototype.findType = function(type) {
  var result = this.findTypeByName(type.name.name);
  if (result == null) return null;
  if (type.names != null) {
    if (type.names.get$length() > (1)) {
      return null;
    }
    if (!result.get$isTop()) {
      return null;
    }
    return result.get$library().findTypeByName(type.names.$index((0)).get$name());
  }
  return result;
}
Library.prototype.findTypeByName = function(name) {
  var ret = this.types.$index(name);
  var $$list = this.imports;
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var imported = $$list.$index($$i);
    var newRet = null;
    if (imported.get$prefix() == null) {
      newRet = imported.get$library().get$types().$index(name);
    }
    else if ($eq(imported.get$prefix(), name)) {
      newRet = imported.get$library().get$topType();
    }
    if (newRet != null) {
      if (ret != null && $ne(ret, newRet)) {
        $globals.world.error(("conflicting types for \"" + name + "\""), ret.get$span(), newRet.get$span());
      }
      else {
        ret = newRet;
      }
    }
  }
  return ret;
}
Library.prototype.resolveType = function(node, typeErrors) {
  if (node == null) return $globals.world.varType;
  if (node.type != null) return node.type;
  node.type = this.findType(node);
  if (node.type == null) {
    var message = ("cannot find type " + Library._getDottedName(node));
    if (typeErrors) {
      $globals.world.error(message, node.span);
      node.type = $globals.world.objectType;
    }
    else {
      $globals.world.warning(message, node.span);
      node.type = $globals.world.varType;
    }
  }
  return node.type;
}
Library._getDottedName = function(type) {
  if (type.names != null) {
    var names = map(type.names, (function (n) {
      return n.get$name();
    })
    );
    return type.name.name + "." + Strings.join(names, ".");
  }
  else {
    return type.name.name;
  }
}
Library.prototype.lookup = function(name, span) {
  return this._topNames.$index(name);
}
Library.prototype.resolve = function() {
  if (this.name == null) {
    this.name = this.baseSource.filename;
    var index = this.name.lastIndexOf("/", this.name.length);
    if (index >= (0)) {
      this.name = this.name.substring(index + (1));
    }
    index = this.name.indexOf(".");
    if (index > (0)) {
      this.name = this.name.substring((0), index);
    }
  }
  this._jsname = this.name.replaceAll(".", "_").replaceAll(":", "_").replaceAll(" ", "_");
  var $$list = this.types.getValues();
  for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
    var type = $$i.next$0();
    type.resolve$0();
  }
}
Library.prototype._addTopName = function(name, member, localSpan) {
  var existing = this._topNames.$index(name);
  if (existing == null) {
    this._topNames.$setindex(name, member);
  }
  else {
    if ((existing instanceof AmbiguousMember)) {
      existing.get$members().add$1(member);
    }
    else {
      var newMember = new AmbiguousMember(name, [existing, member]);
      $globals.world.error(("conflicting members for \"" + name + "\""), existing.get$span(), member.get$span(), localSpan);
      this._topNames.$setindex(name, newMember);
    }
  }
}
Library.prototype._addTopNames = function(lib) {
  var $$list = lib.topType.members.getValues();
  for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
    var member = $$i.next$0();
    if (member.get$isPrivate() && $ne(lib, this)) continue;
    this._addTopName(member.get$name(), member);
  }
  var $$list = lib.types.getValues();
  for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
    var type = $$i.next$0();
    if (!type.get$isTop()) {
      if ($ne(lib, this) && type.get$typeMember().get$isPrivate()) continue;
      this._addTopName(type.get$name(), type.get$typeMember());
    }
  }
}
Library.prototype.postResolveChecks = function() {
  this._topNames = new HashMapImplementation();
  this._addTopNames(this);
  var $$list = this.imports;
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var imported = $$list.$index($$i);
    if (imported.get$prefix() == null) {
      this._addTopNames(imported.get$library());
    }
    else {
      this._addTopName(imported.get$prefix(), imported.get$library().get$topType().get$typeMember(), imported.get$span());
    }
  }
}
Library.prototype.visitSources = function() {
  var visitor = new _LibraryVisitor(this);
  visitor.addSource$1(this.baseSource);
}
Library.prototype.toString = function() {
  return this.baseSource.filename;
}
Library.prototype.hashCode = function() {
  return this.baseSource.filename.hashCode();
}
Library.prototype.$eq = function(other) {
  return (other instanceof Library) && $eq(other.get$baseSource().get$filename(), this.baseSource.filename);
}
Library.prototype.findTypeByName$1 = Library.prototype.findTypeByName;
Library.prototype.hashCode$0 = Library.prototype.hashCode;
Library.prototype.lookup$2 = Library.prototype.lookup;
Library.prototype.postResolveChecks$0 = Library.prototype.postResolveChecks;
Library.prototype.resolve$0 = Library.prototype.resolve;
Library.prototype.resolveType$2 = Library.prototype.resolveType;
Library.prototype.toString$0 = Library.prototype.toString;
Library.prototype.visitSources$0 = Library.prototype.visitSources;
// ********** Code for _LibraryVisitor **************
function _LibraryVisitor(library) {
  this.library = library;
  this.isTop = true;
  this.seenSource = false;
  this.seenResource = false;
  this.seenImport = false;
  this.currentType = this.library.topType;
  this.sources = [];
}
_LibraryVisitor.prototype.get$library = function() { return this.library; };
_LibraryVisitor.prototype.get$isTop = function() { return this.isTop; };
_LibraryVisitor.prototype.set$isTop = function(value) { return this.isTop = value; };
_LibraryVisitor.prototype.addSourceFromName = function(name, span) {
  var filename = this.library.makeFullPath(name);
  if ($eq(filename, this.library.baseSource.filename)) {
    $globals.world.error("library can not source itself", span);
    return;
  }
  else if (this.sources.some((function (s) {
    return $eq(s.get$filename(), filename);
  })
  )) {
    $globals.world.error(("file \"" + filename + "\" has already been sourced"), span);
    return;
  }
  var source = $globals.world.readFile(this.library.makeFullPath(name));
  this.sources.add(source);
}
_LibraryVisitor.prototype.addSource = function(source) {
  var $this = this; // closure support
  if (this.library.sources.some((function (s) {
    return $eq(s.get$filename(), source.filename);
  })
  )) {
    $globals.world.error(("duplicate source file \"" + source.filename + "\""));
    return;
  }
  this.library.sources.add(source);
  var parser = new Parser(source, $globals.options.dietParse, false, false, (0));
  var unit = parser.compilationUnit$0();
  unit.forEach$1((function (def) {
    return def.visit$1($this);
  })
  );
  this.isTop = false;
  var newSources = this.sources;
  this.sources = [];
  for (var $$i = newSources.iterator$0(); $$i.hasNext$0(); ) {
    var source0 = $$i.next$0();
    this.addSource(source0);
  }
}
_LibraryVisitor.prototype.visitDirectiveDefinition = function(node) {
  if (!this.isTop) {
    $globals.world.error("directives not allowed in sourced file", node.span);
    return;
  }
  var name;
  switch (node.name.name) {
    case "library":

      name = this.getSingleStringArg(node);
      if (this.library.name == null) {
        this.library.name = name;
        if ($eq(name, "node") || $eq(name, "dom")) {
          this.library.topType.isNative = true;
        }
        if (this.seenImport || this.seenSource || this.seenResource) {
          $globals.world.error("#library must be first directive in file", node.span);
        }
      }
      else {
        $globals.world.error("already specified library name", node.span);
      }
      break;

    case "import":

      this.seenImport = true;
      name = this.getFirstStringArg(node);
      var prefix = this.tryGetNamedStringArg(node, "prefix");
      if (node.arguments.get$length() > (2) || node.arguments.get$length() == (2) && prefix == null) {
        $globals.world.error("expected at most one \"name\" argument and one optional \"prefix\"" + (" but found " + node.arguments.get$length()), node.span);
      }
      else if (prefix != null && prefix.indexOf$1(".") >= (0)) {
        $globals.world.error("library prefix canot contain \".\"", node.span);
      }
      else if (this.seenSource || this.seenResource) {
        $globals.world.error("#imports must come before any #source or #resource", node.span);
      }
      if ($eq(prefix, "")) prefix = null;
      var filename = this.library.makeFullPath(name);
      if (this.library.imports.some((function (li) {
        return $eq(li.get$library().get$baseSource(), filename);
      })
      )) {
        $globals.world.error(("duplicate import of \"" + name + "\""), node.span);
        return;
      }
      var newLib = this.library.addImport(filename, prefix, node.span);
      break;

    case "source":

      this.seenSource = true;
      name = this.getSingleStringArg(node);
      this.addSourceFromName(name, node.span);
      if (this.seenResource) {
        $globals.world.error("#sources must come before any #resource", node.span);
      }
      break;

    case "native":

      name = this.getSingleStringArg(node);
      this.library.addNative(this.library.makeFullPath(name));
      break;

    case "resource":

      this.seenResource = true;
      this.getFirstStringArg(node);
      break;

    default:

      $globals.world.error(("unknown directive: " + node.name.name), node.span);

  }
}
_LibraryVisitor.prototype.getSingleStringArg = function(node) {
  if (node.arguments.get$length() != (1)) {
    $globals.world.error(("expected exactly one argument but found " + node.arguments.get$length()), node.span);
  }
  return this.getFirstStringArg(node);
}
_LibraryVisitor.prototype.getFirstStringArg = function(node) {
  if (node.arguments.get$length() < (1)) {
    $globals.world.error(("expected at least one argument but found " + node.arguments.get$length()), node.span);
  }
  var arg = node.arguments.$index((0));
  if (arg.get$label() != null) {
    $globals.world.error("label not allowed for directive", node.span);
  }
  return this._parseStringArgument(arg);
}
_LibraryVisitor.prototype.tryGetNamedStringArg = function(node, argName) {
  var args = node.arguments.filter((function (a) {
    return a.get$label() != null && $eq(a.get$label().get$name(), argName);
  })
  );
  if ($eq(args.get$length(), (0))) {
    return null;
  }
  if (args.get$length() > (1)) {
    $globals.world.error(("expected at most one \"" + argName + "\" argument but found ") + node.arguments.get$length(), node.span);
  }
  for (var $$i = args.iterator$0(); $$i.hasNext$0(); ) {
    var arg = $$i.next$0();
    return this._parseStringArgument(arg);
  }
}
_LibraryVisitor.prototype._parseStringArgument = function(arg) {
  var expr = arg.value;
  if (!(expr instanceof LiteralExpression) || !expr.get$value().get$type().get$isString()) {
    $globals.world.error("expected string literal", expr.get$span());
  }
  return expr.get$value().get$actualValue();
}
_LibraryVisitor.prototype.visitTypeDefinition = function(node) {
  var oldType = this.currentType;
  this.currentType = this.library.addType(node.name.name, node, node.isClass);
  var $$list = node.body;
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var member = $$list.$index($$i);
    member.visit$1(this);
  }
  this.currentType = oldType;
}
_LibraryVisitor.prototype.visitVariableDefinition = function(node) {
  this.currentType.addField(node);
}
_LibraryVisitor.prototype.visitFunctionDefinition = function(node) {
  this.currentType.addMethod(node.name.name, node);
}
_LibraryVisitor.prototype.visitFunctionTypeDefinition = function(node) {
  var type = this.library.addType(node.func.name.name, node, false);
  type.addMethod$2(":call", node.func);
}
_LibraryVisitor.prototype.addSource$1 = _LibraryVisitor.prototype.addSource;
// ********** Code for Parameter **************
function Parameter(definition, method) {
  this.method = method;
  this.definition = definition;
  this.isInitializer = false;
}
Parameter.prototype.get$definition = function() { return this.definition; };
Parameter.prototype.set$definition = function(value) { return this.definition = value; };
Parameter.prototype.get$method = function() { return this.method; };
Parameter.prototype.set$method = function(value) { return this.method = value; };
Parameter.prototype.get$name = function() { return this.name; };
Parameter.prototype.set$name = function(value) { return this.name = value; };
Parameter.prototype.get$type = function() { return this.type; };
Parameter.prototype.set$type = function(value) { return this.type = value; };
Parameter.prototype.get$isInitializer = function() { return this.isInitializer; };
Parameter.prototype.set$isInitializer = function(value) { return this.isInitializer = value; };
Parameter.prototype.get$value = function() { return this.value; };
Parameter.prototype.set$value = function(value) { return this.value = value; };
Parameter.prototype.resolve = function() {
  this.name = this.definition.name.name;
  if (this.name.startsWith("this.")) {
    this.name = this.name.substring((5));
    this.isInitializer = true;
  }
  this.type = this.method.resolveType$2(this.definition.type, false);
  if (this.definition.value != null) {
    if (!this.get$hasDefaultValue()) return;
    if (this.method.name == ":call") {
      var methodDef = this.method.get$definition();
      if (methodDef.get$body() == null && !this.method.get$isNative()) {
        $globals.world.error("default value not allowed on function type", this.definition.span);
      }
    }
    else if (this.method.get$isAbstract()) {
      $globals.world.error("default value not allowed on abstract methods", this.definition.span);
    }
  }
  else if (this.isInitializer && !this.method.get$isConstructor()) {
    $globals.world.error("initializer parameters only allowed on constructors", this.definition.span);
  }
}
Parameter.prototype.genValue = function(method, context) {
  if (this.definition.value == null || this.value != null) return;
  if (context == null) {
    context = new MethodGenerator(method, null);
  }
  this.value = this.definition.value.visit(context);
  if (!this.value.get$isConst()) {
    $globals.world.error("default parameter values must be constant", this.value.span);
  }
  this.value = this.value.convertTo(context, this.type, false);
}
Parameter.prototype.copyWithNewType = function(newMethod, newType) {
  var ret = new Parameter(this.definition, newMethod);
  ret.set$type(newType);
  ret.set$name(this.name);
  ret.set$isInitializer(this.isInitializer);
  return ret;
}
Parameter.prototype.get$isOptional = function() {
  return this.definition != null && this.definition.value != null;
}
Parameter.prototype.get$hasDefaultValue = function() {
  return this.definition.value.span.start != this.definition.span.start;
}
Parameter.prototype.copyWithNewType$2 = Parameter.prototype.copyWithNewType;
Parameter.prototype.genValue$2 = Parameter.prototype.genValue;
Parameter.prototype.resolve$0 = Parameter.prototype.resolve;
// ********** Code for TypeMember **************
$inherits(TypeMember, Member);
function TypeMember(type) {
  this.type = type;
  Member.call(this, type.name, type.library.topType);
}
TypeMember.prototype.get$type = function() { return this.type; };
TypeMember.prototype.get$span = function() {
  return this.type.definition == null ? null : this.type.definition.span;
}
TypeMember.prototype.get$isStatic = function() {
  return true;
}
TypeMember.prototype.get$returnType = function() {
  return $globals.world.varType;
}
TypeMember.prototype.canInvoke = function(context, args) {
  return false;
}
TypeMember.prototype.get$canGet = function() {
  return true;
}
TypeMember.prototype.get$canSet = function() {
  return false;
}
TypeMember.prototype.get$requiresFieldSyntax = function() {
  return true;
}
TypeMember.prototype._get = function(context, node, target, isDynamic) {
  return new Value.type$ctor(this.type, node.span);
}
TypeMember.prototype._set = function(context, node, target, value, isDynamic) {
  $globals.world.error("cannot set type", node.span);
}
TypeMember.prototype.invoke = function(context, node, target, args, isDynamic) {
  $globals.world.error("cannot invoke type", node.span);
}
TypeMember.prototype._get$3 = function($0, $1, $2) {
  return this._get($0, $1, $2, false);
};
TypeMember.prototype._get$3$isDynamic = TypeMember.prototype._get;
TypeMember.prototype._get$4 = TypeMember.prototype._get;
TypeMember.prototype._set$4 = function($0, $1, $2, $3) {
  return this._set($0, $1, $2, $3, false);
};
TypeMember.prototype._set$4$isDynamic = TypeMember.prototype._set;
TypeMember.prototype._set$5 = TypeMember.prototype._set;
TypeMember.prototype.canInvoke$2 = TypeMember.prototype.canInvoke;
TypeMember.prototype.invoke$4 = function($0, $1, $2, $3) {
  return this.invoke($0, $1, $2, $3, false);
};
TypeMember.prototype.invoke$4$isDynamic = TypeMember.prototype.invoke;
TypeMember.prototype.invoke$5 = TypeMember.prototype.invoke;
// ********** Code for FieldMember **************
$inherits(FieldMember, Member);
function FieldMember(name, declaringType, definition, value) {
  this.isNative = false;
  this.definition = definition;
  this._computing = false;
  this.value = value;
  Member.call(this, name, declaringType);
}
FieldMember.prototype.get$definition = function() { return this.definition; };
FieldMember.prototype.get$value = function() { return this.value; };
FieldMember.prototype.get$type = function() { return this.type; };
FieldMember.prototype.set$type = function(value) { return this.type = value; };
FieldMember.prototype.get$isStatic = function() { return this.isStatic; };
FieldMember.prototype.set$isStatic = function(value) { return this.isStatic = value; };
FieldMember.prototype.get$isFinal = function() { return this.isFinal; };
FieldMember.prototype.set$isFinal = function(value) { return this.isFinal = value; };
FieldMember.prototype.get$isNative = function() { return this.isNative; };
FieldMember.prototype.set$isNative = function(value) { return this.isNative = value; };
FieldMember.prototype.override = function(other) {
  if (!Member.prototype.override.call(this, other)) return false;
  if (other.get$isProperty()) {
    return true;
  }
  else {
    $globals.world.error("field can not override anything but property", this.get$span(), other.get$span());
    return false;
  }
}
FieldMember.prototype.provideFieldSyntax = function() {

}
FieldMember.prototype.providePropertySyntax = function() {
  this._providePropertySyntax = true;
}
FieldMember.prototype.get$span = function() {
  return this.definition == null ? null : this.definition.span;
}
FieldMember.prototype.get$returnType = function() {
  return this.type;
}
FieldMember.prototype.get$canGet = function() {
  return true;
}
FieldMember.prototype.get$canSet = function() {
  return !this.isFinal;
}
FieldMember.prototype.get$isField = function() {
  return true;
}
FieldMember.prototype.resolve = function() {
  this.isStatic = this.declaringType.get$isTop();
  this.isFinal = false;
  if (this.definition.modifiers != null) {
    var $$list = this.definition.modifiers;
    for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
      var mod = $$list.$index($$i);
      if ($eq(mod.get$kind(), (85))) {
        if (this.isStatic) {
          $globals.world.error("duplicate static modifier", mod.get$span());
        }
        this.isStatic = true;
      }
      else if ($eq(mod.get$kind(), (99))) {
        if (this.isFinal) {
          $globals.world.error("duplicate final modifier", mod.get$span());
        }
        this.isFinal = true;
      }
      else {
        $globals.world.error(("" + mod + " modifier not allowed on field"), mod.get$span());
      }
    }
  }
  this.type = this.resolveType(this.definition.type, false);
  if (this.isStatic && !this.get$isFactory() && this.type.get$hasTypeParams()) {
    $globals.world.error("using type parameter in static context", this.definition.type.span);
  }
  if (this.isStatic && this.isFinal && this.value == null) {
    $globals.world.error("static final field is missing initializer", this.get$span());
  }
  this.get$library()._addMember(this);
}
FieldMember.prototype.computeValue = function() {
  if (this.value == null) return null;
  if (this._computedValue == null) {
    if (this._computing) {
      $globals.world.error("circular reference", this.value.span);
      return null;
    }
    this._computing = true;
    var finalMethod = new MethodMember("final_context", this.declaringType, null);
    finalMethod.set$isStatic(true);
    var finalGen = new MethodGenerator(finalMethod, null);
    this._computedValue = this.value.visit(finalGen);
    if (!this._computedValue.get$isConst()) {
      if (this.isStatic) {
        $globals.world.error("non constant static field must be initialized in functions", this.value.span);
      }
      else {
        $globals.world.error("non constant field must be initialized in constructor", this.value.span);
      }
    }
    if (this.isStatic) {
      if (this.isFinal && this._computedValue.get$isConst()) {
        ;
      }
      else {
        this._computedValue = $globals.world.gen.globalForStaticField(this, this._computedValue, [this._computedValue]);
      }
    }
    this._computing = false;
  }
  return this._computedValue;
}
FieldMember.prototype._get = function(context, node, target, isDynamic) {
  if (this.isNative && this.get$returnType() != null) {
    this.get$returnType().markUsed();
    if ((this.get$returnType() instanceof DefinedType)) {
      var defaultType = this.get$returnType().get$genericType().defaultType;
      if (defaultType != null && defaultType.get$isNative()) {
        defaultType.markUsed$0();
      }
    }
  }
  if (this.isStatic) {
    this.declaringType.markUsed();
    var cv = this.computeValue();
    if (this.isFinal) {
      return cv;
    }
    $globals.world.gen.hasStatics = true;
    if (this.declaringType.get$isTop()) {
      if (this.declaringType.get$library().get$isDom()) {
        return new Value(this.type, ("" + this.get$jsname()), node.span, true);
      }
      else {
        return new Value(this.type, ("$globals." + this.get$jsname()), node.span, true);
      }
    }
    else if (this.declaringType.get$isNative()) {
      if (this.declaringType.get$isHiddenNativeType()) {
        $globals.world.error("static field of hidden native type is inaccessible", node.span);
      }
      return new Value(this.type, ("" + this.declaringType.get$jsname() + "." + this.get$jsname()), node.span, true);
    }
    else {
      return new Value(this.type, ("$globals." + this.declaringType.get$jsname() + "_" + this.get$jsname()), node.span, true);
    }
  }
  return new Value(this.type, ("" + target.get$code() + "." + this.get$jsname()), node.span, true);
}
FieldMember.prototype._set = function(context, node, target, value, isDynamic) {
  var lhs = this._get(context, node, target, isDynamic);
  value = value.convertTo(context, this.type, isDynamic);
  return new Value(this.type, ("" + lhs.get$code() + " = " + value.get$code()), node.span, true);
}
FieldMember.prototype._get$3 = function($0, $1, $2) {
  return this._get($0, $1, $2, false);
};
FieldMember.prototype._get$3$isDynamic = FieldMember.prototype._get;
FieldMember.prototype._get$4 = FieldMember.prototype._get;
FieldMember.prototype._set$4 = function($0, $1, $2, $3) {
  return this._set($0, $1, $2, $3, false);
};
FieldMember.prototype._set$4$isDynamic = FieldMember.prototype._set;
FieldMember.prototype._set$5 = FieldMember.prototype._set;
FieldMember.prototype.computeValue$0 = FieldMember.prototype.computeValue;
FieldMember.prototype.provideFieldSyntax$0 = FieldMember.prototype.provideFieldSyntax;
FieldMember.prototype.providePropertySyntax$0 = FieldMember.prototype.providePropertySyntax;
FieldMember.prototype.resolve$0 = FieldMember.prototype.resolve;
// ********** Code for PropertyMember **************
$inherits(PropertyMember, Member);
function PropertyMember(name, declaringType) {
  Member.call(this, name, declaringType);
}
PropertyMember.prototype.get$getter = function() { return this.getter; };
PropertyMember.prototype.set$getter = function(value) { return this.getter = value; };
PropertyMember.prototype.get$setter = function() { return this.setter; };
PropertyMember.prototype.set$setter = function(value) { return this.setter = value; };
PropertyMember.prototype.get$span = function() {
  return this.getter != null ? this.getter.get$span() : null;
}
PropertyMember.prototype.get$canGet = function() {
  return this.getter != null;
}
PropertyMember.prototype.get$canSet = function() {
  return this.setter != null;
}
PropertyMember.prototype.get$requiresPropertySyntax = function() {
  return this.declaringType.get$isClass();
}
PropertyMember.prototype.provideFieldSyntax = function() {
  this._provideFieldSyntax = true;
}
PropertyMember.prototype.providePropertySyntax = function() {
  if (this._overriddenField != null && this._overriddenField.get$isNative()) {
    this.provideFieldSyntax();
  }
}
PropertyMember.prototype.get$isStatic = function() {
  return this.getter == null ? this.setter.isStatic : this.getter.isStatic;
}
PropertyMember.prototype.get$isProperty = function() {
  return true;
}
PropertyMember.prototype.get$returnType = function() {
  return this.getter == null ? this.setter.returnType : this.getter.returnType;
}
PropertyMember.prototype.override = function(other) {
  if (!Member.prototype.override.call(this, other)) return false;
  if (other.get$isProperty() || other.get$isField()) {
    if (other.get$isProperty()) this.addFromParent(other);
    else this._overriddenField = other;
    return true;
  }
  else {
    $globals.world.error("property can only override field or property", this.get$span(), other.get$span());
    return false;
  }
}
PropertyMember.prototype._get = function(context, node, target, isDynamic) {
  if (this.getter == null) {
    if (this._overriddenField != null) {
      return this._overriddenField._get(context, node, target, isDynamic);
    }
    return target.invokeNoSuchMethod(context, ("get:" + this.name), node);
  }
  return this.getter.invoke(context, node, target, Arguments.get$EMPTY(), false);
}
PropertyMember.prototype._set = function(context, node, target, value, isDynamic) {
  if (this.setter == null) {
    if (this._overriddenField != null) {
      return this._overriddenField._set(context, node, target, value, isDynamic);
    }
    return target.invokeNoSuchMethod(context, ("set:" + this.name), node, new Arguments(null, [value]));
  }
  return this.setter.invoke(context, node, target, new Arguments(null, [value]), isDynamic);
}
PropertyMember.prototype.addFromParent = function(parentMember) {
  var parent;
  if ((parentMember instanceof ConcreteMember)) {
    var c = parentMember;
    parent = c.baseMember;
  }
  else {
    parent = parentMember;
  }
  if (this.getter == null) this.getter = parent.getter;
  if (this.setter == null) this.setter = parent.setter;
}
PropertyMember.prototype.resolve = function() {
  if (this.getter != null) {
    this.getter.resolve();
    if (this.getter.parameters.get$length() != (0)) {
      $globals.world.error("getter methods should take no arguments", this.getter.definition.span);
    }
    if (this.getter.returnType.get$isVoid()) {
      $globals.world.warning("getter methods should not be void", this.getter.definition.returnType.span);
    }
  }
  if (this.setter != null) {
    this.setter.resolve();
    if (this.setter.parameters.get$length() != (1)) {
      $globals.world.error("setter methods should take a single argument", this.setter.definition.span);
    }
    if (!this.setter.returnType.get$isVoid() && this.setter.definition.returnType != null) {
      $globals.world.warning("setter methods should be void", this.setter.definition.returnType.span);
    }
  }
  this.get$library()._addMember(this);
}
PropertyMember.prototype._get$3 = function($0, $1, $2) {
  return this._get($0, $1, $2, false);
};
PropertyMember.prototype._get$3$isDynamic = PropertyMember.prototype._get;
PropertyMember.prototype._get$4 = PropertyMember.prototype._get;
PropertyMember.prototype._set$4 = function($0, $1, $2, $3) {
  return this._set($0, $1, $2, $3, false);
};
PropertyMember.prototype._set$4$isDynamic = PropertyMember.prototype._set;
PropertyMember.prototype._set$5 = PropertyMember.prototype._set;
PropertyMember.prototype.provideFieldSyntax$0 = PropertyMember.prototype.provideFieldSyntax;
PropertyMember.prototype.providePropertySyntax$0 = PropertyMember.prototype.providePropertySyntax;
PropertyMember.prototype.resolve$0 = PropertyMember.prototype.resolve;
// ********** Code for ConcreteMember **************
$inherits(ConcreteMember, Member);
function ConcreteMember(name, declaringType, baseMember) {
  this.baseMember = baseMember;
  Member.call(this, name, declaringType);
  this.parameters = [];
  this.returnType = this.baseMember.get$returnType().resolveTypeParams(declaringType);
  var $$list = this.baseMember.get$parameters();
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var p = $$list.$index($$i);
    var newType = p.get$type().resolveTypeParams$1(declaringType);
    if ($ne(newType, p.get$type())) {
      this.parameters.add(p.copyWithNewType$2(this, newType));
    }
    else {
      this.parameters.add(p);
    }
  }
}
ConcreteMember.prototype.get$returnType = function() { return this.returnType; };
ConcreteMember.prototype.set$returnType = function(value) { return this.returnType = value; };
ConcreteMember.prototype.get$parameters = function() { return this.parameters; };
ConcreteMember.prototype.set$parameters = function(value) { return this.parameters = value; };
ConcreteMember.prototype.get$span = function() {
  return this.baseMember.get$span();
}
ConcreteMember.prototype.get$isStatic = function() {
  return this.baseMember.get$isStatic();
}
ConcreteMember.prototype.get$isAbstract = function() {
  return this.baseMember.get$isAbstract();
}
ConcreteMember.prototype.get$isConst = function() {
  return this.baseMember.get$isConst();
}
ConcreteMember.prototype.get$isFactory = function() {
  return this.baseMember.get$isFactory();
}
ConcreteMember.prototype.get$isFinal = function() {
  return this.baseMember.get$isFinal();
}
ConcreteMember.prototype.get$isNative = function() {
  return this.baseMember.get$isNative();
}
ConcreteMember.prototype.get$jsname = function() {
  return this.baseMember.get$jsname();
}
ConcreteMember.prototype.get$canGet = function() {
  return this.baseMember.get$canGet();
}
ConcreteMember.prototype.get$canSet = function() {
  return this.baseMember.get$canSet();
}
ConcreteMember.prototype.canInvoke = function(context, args) {
  return this.baseMember.canInvoke(context, args);
}
ConcreteMember.prototype.get$isField = function() {
  return this.baseMember.get$isField();
}
ConcreteMember.prototype.get$isMethod = function() {
  return this.baseMember.get$isMethod();
}
ConcreteMember.prototype.get$isProperty = function() {
  return this.baseMember.get$isProperty();
}
ConcreteMember.prototype.get$requiresPropertySyntax = function() {
  return this.baseMember.get$requiresPropertySyntax();
}
ConcreteMember.prototype.get$requiresFieldSyntax = function() {
  return this.baseMember.get$requiresFieldSyntax();
}
ConcreteMember.prototype.provideFieldSyntax = function() {
  return this.baseMember.provideFieldSyntax();
}
ConcreteMember.prototype.providePropertySyntax = function() {
  return this.baseMember.providePropertySyntax();
}
ConcreteMember.prototype.get$isConstructor = function() {
  return this.name == this.declaringType.name;
}
ConcreteMember.prototype.get$constructorName = function() {
  return this.baseMember.get$constructorName();
}
ConcreteMember.prototype.get$definition = function() {
  return this.baseMember.get$definition();
}
ConcreteMember.prototype.get$initDelegate = function() {
  return this.baseMember.get$initDelegate();
}
ConcreteMember.prototype.set$initDelegate = function(ctor) {
  this.baseMember.set$initDelegate(ctor);
}
ConcreteMember.prototype.resolveType = function(node, isRequired) {
  var type = this.baseMember.resolveType$2(node, isRequired);
  return type.resolveTypeParams$1(this.declaringType);
}
ConcreteMember.prototype.computeValue = function() {
  return this.baseMember.computeValue();
}
ConcreteMember.prototype.override = function(other) {
  return this.baseMember.override(other);
}
ConcreteMember.prototype._get = function(context, node, target, isDynamic) {
  var ret = this.baseMember._get(context, node, target, isDynamic);
  return new Value(this.get$inferredResult(), ret.get$code(), node.span, true);
}
ConcreteMember.prototype._set = function(context, node, target, value, isDynamic) {
  var ret = this.baseMember._set(context, node, target, value, isDynamic);
  return new Value(this.returnType, ret.get$code(), node.span, true);
}
ConcreteMember.prototype._evalConstConstructor = function(newObject, args) {
  return this.baseMember.get$dynamic()._evalConstConstructor$2(newObject, args);
}
ConcreteMember.prototype.invoke = function(context, node, target, args, isDynamic) {
  var ret = this.baseMember.invoke(context, node, target, args, isDynamic);
  var code = ret.get$code();
  if (this.get$isConstructor()) {
    code = code.replaceFirst$2(this.declaringType.get$genericType().get$jsname(), this.declaringType.get$jsname());
  }
  if ((this.baseMember instanceof MethodMember)) {
    this.declaringType.genMethod(this);
  }
  return new Value(this.get$inferredResult(), code, node.span, true);
}
ConcreteMember.prototype._evalConstConstructor$2 = ConcreteMember.prototype._evalConstConstructor;
ConcreteMember.prototype._get$3 = function($0, $1, $2) {
  return this._get($0, $1, $2, false);
};
ConcreteMember.prototype._get$3$isDynamic = ConcreteMember.prototype._get;
ConcreteMember.prototype._get$4 = ConcreteMember.prototype._get;
ConcreteMember.prototype._set$4 = function($0, $1, $2, $3) {
  return this._set($0, $1, $2, $3, false);
};
ConcreteMember.prototype._set$4$isDynamic = ConcreteMember.prototype._set;
ConcreteMember.prototype._set$5 = ConcreteMember.prototype._set;
ConcreteMember.prototype.canInvoke$2 = ConcreteMember.prototype.canInvoke;
ConcreteMember.prototype.computeValue$0 = ConcreteMember.prototype.computeValue;
ConcreteMember.prototype.invoke$4 = function($0, $1, $2, $3) {
  return this.invoke($0, $1, $2, $3, false);
};
ConcreteMember.prototype.invoke$4$isDynamic = ConcreteMember.prototype.invoke;
ConcreteMember.prototype.invoke$5 = ConcreteMember.prototype.invoke;
ConcreteMember.prototype.provideFieldSyntax$0 = ConcreteMember.prototype.provideFieldSyntax;
ConcreteMember.prototype.providePropertySyntax$0 = ConcreteMember.prototype.providePropertySyntax;
ConcreteMember.prototype.resolveType$2 = ConcreteMember.prototype.resolveType;
// ********** Code for MethodMember **************
$inherits(MethodMember, Member);
function MethodMember(name, declaringType, definition) {
  this.isLambda = false;
  this._provideOptionalParamInfo = false;
  this.isFactory = false;
  this.definition = definition;
  this.isConst = false;
  this.isAbstract = false;
  this.isStatic = false;
  Member.call(this, name, declaringType);
}
MethodMember.prototype.get$definition = function() { return this.definition; };
MethodMember.prototype.set$definition = function(value) { return this.definition = value; };
MethodMember.prototype.get$returnType = function() { return this.returnType; };
MethodMember.prototype.set$returnType = function(value) { return this.returnType = value; };
MethodMember.prototype.get$parameters = function() { return this.parameters; };
MethodMember.prototype.set$parameters = function(value) { return this.parameters = value; };
MethodMember.prototype.get$isStatic = function() { return this.isStatic; };
MethodMember.prototype.set$isStatic = function(value) { return this.isStatic = value; };
MethodMember.prototype.get$isAbstract = function() { return this.isAbstract; };
MethodMember.prototype.set$isAbstract = function(value) { return this.isAbstract = value; };
MethodMember.prototype.get$isConst = function() { return this.isConst; };
MethodMember.prototype.set$isConst = function(value) { return this.isConst = value; };
MethodMember.prototype.get$isFactory = function() { return this.isFactory; };
MethodMember.prototype.set$isFactory = function(value) { return this.isFactory = value; };
MethodMember.prototype.get$isLambda = function() { return this.isLambda; };
MethodMember.prototype.set$isLambda = function(value) { return this.isLambda = value; };
MethodMember.prototype.get$initDelegate = function() { return this.initDelegate; };
MethodMember.prototype.set$initDelegate = function(value) { return this.initDelegate = value; };
MethodMember.prototype.get$isConstructor = function() {
  return this.name == this.declaringType.name;
}
MethodMember.prototype.get$isMethod = function() {
  return !this.get$isConstructor();
}
MethodMember.prototype.get$isNative = function() {
  return this.definition.nativeBody != null;
}
MethodMember.prototype.get$canGet = function() {
  return true;
}
MethodMember.prototype.get$canSet = function() {
  return false;
}
MethodMember.prototype.get$requiresPropertySyntax = function() {
  return true;
}
MethodMember.prototype.get$span = function() {
  return this.definition == null ? null : this.definition.span;
}
MethodMember.prototype.get$constructorName = function() {
  var returnType = this.definition.returnType;
  if (returnType == null) return "";
  if ((returnType instanceof GenericTypeReference)) {
    return "";
  }
  if (returnType.get$names() != null) {
    return returnType.get$names().$index((0)).get$name();
  }
  else if (returnType.get$name() != null) {
    return returnType.get$name().get$name();
  }
  $globals.world.internalError("no valid constructor name", this.definition.span);
}
MethodMember.prototype.get$functionType = function() {
  if (this._functionType == null) {
    this._functionType = this.get$library().getOrAddFunctionType(this.declaringType, this.name, this.definition);
    if (this.parameters == null) {
      this.resolve();
    }
  }
  return this._functionType;
}
MethodMember.prototype.override = function(other) {
  if (!Member.prototype.override.call(this, other)) return false;
  if (other.get$isMethod()) {
    return true;
  }
  else {
    $globals.world.error("method can only override methods", this.get$span(), other.get$span());
    return false;
  }
}
MethodMember.prototype.canInvoke = function(context, args) {
  var bareCount = args.get$bareCount();
  if (bareCount > this.parameters.get$length()) return false;
  if (bareCount == this.parameters.get$length()) {
    if (bareCount != args.get$length()) return false;
  }
  else {
    if (!this.parameters.$index(bareCount).get$isOptional()) return false;
    for (var i = bareCount;
     i < args.get$length(); i++) {
      if (this.indexOfParameter(args.getName(i)) < (0)) {
        return false;
      }
    }
  }
  return true;
}
MethodMember.prototype.indexOfParameter = function(name) {
  for (var i = (0);
   i < this.parameters.get$length(); i++) {
    var p = this.parameters.$index(i);
    if (p.get$isOptional() && $eq(p.get$name(), name)) {
      return i;
    }
  }
  return (-1);
}
MethodMember.prototype.provideFieldSyntax = function() {
  this._provideFieldSyntax = true;
}
MethodMember.prototype.providePropertySyntax = function() {
  this._providePropertySyntax = true;
}
MethodMember.prototype._set = function(context, node, target, value, isDynamic) {
  $globals.world.error("cannot set method", node.span);
}
MethodMember.prototype._get = function(context, node, target, isDynamic) {
  this.declaringType.genMethod(this);
  this._provideOptionalParamInfo = true;
  if (this.isStatic) {
    this.declaringType.markUsed();
    var type = this.declaringType.get$isTop() ? "" : ("" + this.declaringType.get$jsname() + ".");
    return new Value(this.get$functionType(), ("" + type + this.get$jsname()), node.span, true);
  }
  this._providePropertySyntax = true;
  return new Value(this.get$functionType(), ("" + target.get$code() + ".get$" + this.get$jsname() + "()"), node.span, true);
}
MethodMember.prototype.namesInHomePositions = function(args) {
  if (!args.get$hasNames()) return true;
  for (var i = args.get$bareCount();
   i < args.values.get$length(); i++) {
    if (i >= this.parameters.get$length()) {
      return false;
    }
    if (args.getName(i) != this.parameters.$index(i).get$name()) {
      return false;
    }
  }
  return true;
}
MethodMember.prototype.namesInOrder = function(args) {
  if (!args.get$hasNames()) return true;
  var lastParameter = null;
  for (var i = args.get$bareCount();
   i < this.parameters.get$length(); i++) {
    var p = args.getIndexOfName(this.parameters.$index(i).get$name());
    if (p >= (0) && args.values.$index(p).get$needsTemp()) {
      if (lastParameter != null && lastParameter > p) {
        return false;
      }
      lastParameter = p;
    }
  }
  return true;
}
MethodMember.prototype.needsArgumentConversion = function(args) {
  var bareCount = args.get$bareCount();
  for (var i = (0);
   i < bareCount; i++) {
    var arg = args.values.$index(i);
    if (arg.needsConversion$1(this.parameters.$index(i).get$type())) {
      return true;
    }
  }
  if (bareCount < this.parameters.get$length()) {
    this.genParameterValues();
    for (var i = bareCount;
     i < this.parameters.get$length(); i++) {
      var arg = args.getValue(this.parameters.$index(i).get$name());
      if (arg != null && arg.needsConversion$1(this.parameters.$index(i).get$type())) {
        return true;
      }
    }
  }
  return false;
}
MethodMember._argCountMsg = function(actual, expected, atLeast) {
  return "wrong number of positional arguments, expected " + ("" + (atLeast ? "at least " : "") + expected + " but found " + actual);
}
MethodMember.prototype._argError = function(context, node, target, args, msg, argIndex) {
  var span;
  if ((args.nodes == null) || (argIndex >= args.nodes.get$length())) {
    span = node.span;
  }
  else {
    span = args.nodes.$index(argIndex).get$span();
  }
  if (this.isStatic || this.get$isConstructor()) {
    $globals.world.error(msg, span);
  }
  else {
    $globals.world.warning(msg, span);
  }
  return target.invokeNoSuchMethod(context, this.name, node, args);
}
MethodMember.prototype.genParameterValues = function() {
  var $$list = this.parameters;
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var p = $$list.$index($$i);
    p.genValue$2(this, this.generator);
  }
}
MethodMember.prototype.invoke = function(context, node, target, args, isDynamic) {
  if (this.parameters == null) {
    $globals.world.info(("surprised to need to resolve: " + this.declaringType.name + "." + this.name));
    this.resolve();
  }
  this.declaringType.genMethod(this);
  if (this.isStatic || this.isFactory) {
    this.declaringType.markUsed();
  }
  if (this.get$isNative() && this.returnType != null) this.returnType.markUsed();
  if (!this.namesInOrder(args)) {
    return context.findMembers(this.name).invokeOnVar(context, node, target, args);
  }
  var argsCode = [];
  if (!target.isType && (this.get$isConstructor() || target.isSuper)) {
    argsCode.add$1("this");
  }
  var bareCount = args.get$bareCount();
  for (var i = (0);
   i < bareCount; i++) {
    var arg = args.values.$index(i);
    if (i >= this.parameters.get$length()) {
      var msg = MethodMember._argCountMsg(args.get$length(), this.parameters.get$length(), false);
      return this._argError(context, node, target, args, msg, i);
    }
    arg = arg.convertTo$3(context, this.parameters.$index(i).get$type(), isDynamic);
    argsCode.add$1(arg.get$code());
  }
  var namedArgsUsed = (0);
  if (bareCount < this.parameters.get$length()) {
    this.genParameterValues();
    for (var i = bareCount;
     i < this.parameters.get$length(); i++) {
      var arg = args.getValue(this.parameters.$index(i).get$name());
      if (arg == null) {
        arg = this.parameters.$index(i).get$value();
      }
      else {
        arg = arg.convertTo$3(context, this.parameters.$index(i).get$type(), isDynamic);
        namedArgsUsed++;
      }
      if (arg == null || !this.parameters.$index(i).get$isOptional()) {
        var msg = MethodMember._argCountMsg(Math.min(i, args.get$length()), i + (1), true);
        return this._argError(context, node, target, args, msg, i);
      }
      else {
        argsCode.add$1(arg.get$code());
      }
    }
    Arguments.removeTrailingNulls(argsCode);
  }
  if (namedArgsUsed < args.get$nameCount()) {
    var seen = new HashSetImplementation();
    for (var i = bareCount;
     i < args.get$length(); i++) {
      var name = args.getName(i);
      if (seen.contains$1(name)) {
        return this._argError(context, node, target, args, ("duplicate argument \"" + name + "\""), i);
      }
      seen.add$1(name);
      var p = this.indexOfParameter(name);
      if (p < (0)) {
        return this._argError(context, node, target, args, ("method does not have optional parameter \"" + name + "\""), i);
      }
      else if (p < bareCount) {
        return this._argError(context, node, target, args, ("argument \"" + name + "\" passed as positional and named"), p);
      }
    }
    $globals.world.internalError(("wrong named arguments calling " + this.name), node.span);
  }
  var argsString = Strings.join(argsCode, ", ");
  if (this.get$isConstructor()) {
    return this._invokeConstructor(context, node, target, args, argsString);
  }
  if (target.isSuper) {
    return new Value(this.get$inferredResult(), ("" + this.declaringType.get$jsname() + ".prototype." + this.get$jsname() + ".call(" + argsString + ")"), node.span, true);
  }
  if (this.get$isOperator()) {
    return this._invokeBuiltin(context, node, target, args, argsCode, isDynamic);
  }
  if (this.isFactory) {
    return new Value(target.type, ("" + this.get$generatedFactoryName() + "(" + argsString + ")"), node != null ? node.span : null, true);
  }
  if (this.isStatic) {
    if (this.declaringType.get$isTop()) {
      return new Value(this.get$inferredResult(), ("" + this.get$jsname() + "(" + argsString + ")"), node != null ? node.span : null, true);
    }
    return new Value(this.get$inferredResult(), ("" + this.declaringType.get$jsname() + "." + this.get$jsname() + "(" + argsString + ")"), node.span, true);
  }
  if (this.name == "get:typeName" && this.declaringType.get$library().get$isDom()) {
    $globals.world.gen.corejs.ensureTypeNameOf();
  }
  var code = ("" + target.get$code() + "." + this.get$jsname() + "(" + argsString + ")");
  return new Value(this.get$inferredResult(), code, node.span, true);
}
MethodMember.prototype._invokeConstructor = function(context, node, target, args, argsString) {
  this.declaringType.markUsed();
  var ctor = this.get$constructorName();
  if (ctor != "") ctor = ("." + ctor + "$ctor");
  var span = node != null ? node.span : target.span;
  if (!target.isType) {
    var code = ("" + this.declaringType.get$nativeName() + ctor + ".call(" + argsString + ")");
    return new Value(target.type, code, span, true);
  }
  else {
    if (this.isConst && (node instanceof NewExpression) && node.get$dynamic().get$isConst()) {
      if (this.get$isNative() || this.declaringType.name == "JSSyntaxRegExp") {
        var code = ("new " + this.declaringType.get$nativeName() + ctor + "(" + argsString + ")");
        return $globals.world.gen.globalForConst(new Value(target.type, code, span, true), [args.values]);
      }
      var newType = this.declaringType;
      var newObject = new ObjectValue(true, newType, span);
      newObject.initFields$0();
      this._evalConstConstructor(newObject, args);
      return $globals.world.gen.globalForConst(newObject, [args.values]);
    }
    else {
      var code = ("new " + this.declaringType.get$nativeName() + ctor + "(" + argsString + ")");
      return new Value(target.type, code, span, true);
    }
  }
}
MethodMember.prototype._evalConstConstructor = function(newObject, args) {
  this.declaringType.markUsed();
  var generator = new MethodGenerator(this, null);
  generator.evalBody$2(newObject, args);
}
MethodMember.prototype._invokeBuiltin = function(context, node, target, args, argsCode, isDynamic) {
  if (this.declaringType.get$isNum()) {
    var code;
    if (this.name == ":negate") {
      code = ("-" + target.get$code());
    }
    else if (this.name == ":bit_not") {
      code = ("~" + target.get$code());
    }
    else if (this.name == ":truncdiv" || this.name == ":mod") {
      $globals.world.gen.corejs.useOperator(this.name);
      code = ("" + this.get$jsname() + "(" + target.get$code() + ", " + argsCode.$index((0)) + ")");
    }
    else {
      var op = TokenKind.rawOperatorFromMethod(this.name);
      code = ("" + target.get$code() + " " + op + " " + argsCode.$index((0)));
    }
    return new Value(this.get$inferredResult(), code, node.span, true);
  }
  else if (this.declaringType.get$isString()) {
    if (this.name == ":index") {
      return new Value(this.declaringType, ("" + target.get$code() + "[" + argsCode.$index((0)) + "]"), node.span, true);
    }
    else if (this.name == ":add") {
      return new Value(this.declaringType, ("" + target.get$code() + " + " + argsCode.$index((0))), node.span, true);
    }
  }
  else if (this.declaringType.get$isNative()) {
    if (this.name == ":index") {
      return new Value(this.returnType, ("" + target.get$code() + "[" + argsCode.$index((0)) + "]"), node.span, true);
    }
    else if (this.name == ":setindex") {
      return new Value(this.returnType, ("" + target.get$code() + "[" + argsCode.$index((0)) + "] = " + argsCode.$index((1))), node.span, true);
    }
  }
  if (this.name == ":eq" || this.name == ":ne") {
    var op = this.name == ":eq" ? "==" : "!=";
    if (this.name == ":ne") {
      target.invoke(context, ":eq", node, args, isDynamic);
    }
    if ($eq(argsCode.$index((0)), "null")) {
      return new Value(this.get$inferredResult(), ("" + target.get$code() + " " + op + " null"), node.span, true);
    }
    else if (target.type.get$isNum() || target.type.get$isString()) {
      return new Value(this.get$inferredResult(), ("" + target.get$code() + " " + op + " " + argsCode.$index((0))), node.span, true);
    }
    $globals.world.gen.corejs.useOperator(this.name);
    return new Value(this.get$inferredResult(), ("" + this.get$jsname() + "(" + target.get$code() + ", " + argsCode.$index((0)) + ")"), node.span, true);
  }
  if (this.get$isCallMethod()) {
    this.declaringType.markUsed();
    return new Value(this.get$inferredResult(), ("" + target.get$code() + "(" + Strings.join(argsCode, ", ") + ")"), node.span, true);
  }
  if (this.name == ":index") {
    $globals.world.gen.corejs.useIndex = true;
  }
  else if (this.name == ":setindex") {
    $globals.world.gen.corejs.useSetIndex = true;
  }
  var argsString = Strings.join(argsCode, ", ");
  return new Value(this.get$inferredResult(), ("" + target.get$code() + "." + this.get$jsname() + "(" + argsString + ")"), node.span, true);
}
MethodMember.prototype.resolve = function() {
  this.isStatic = this.declaringType.get$isTop();
  this.isConst = false;
  this.isFactory = false;
  this.isAbstract = !this.declaringType.get$isClass();
  if (this.definition.modifiers != null) {
    var $$list = this.definition.modifiers;
    for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
      var mod = $$list.$index($$i);
      if ($eq(mod.get$kind(), (85))) {
        if (this.isStatic) {
          $globals.world.error("duplicate static modifier", mod.get$span());
        }
        this.isStatic = true;
      }
      else if (this.get$isConstructor() && $eq(mod.get$kind(), (92))) {
        if (this.isConst) {
          $globals.world.error("duplicate const modifier", mod.get$span());
        }
        if (this.isFactory) {
          $globals.world.error("const factory not allowed", mod.get$span());
        }
        this.isConst = true;
      }
      else if ($eq(mod.get$kind(), (74))) {
        if (this.isFactory) {
          $globals.world.error("duplicate factory modifier", mod.get$span());
        }
        if (this.isConst) {
          $globals.world.error("const factory not allowed", mod.get$span());
        }
        if (this.isStatic) {
          $globals.world.error("static factory not allowed", mod.get$span());
        }
        this.isFactory = true;
      }
      else if ($eq(mod.get$kind(), (71))) {
        if (this.isAbstract) {
          if (this.declaringType.get$isClass()) {
            $globals.world.error("duplicate abstract modifier", mod.get$span());
          }
          else if (!this.get$isCallMethod()) {
            $globals.world.error("abstract modifier not allowed on interface members", mod.get$span());
          }
        }
        this.isAbstract = true;
      }
      else {
        $globals.world.error(("" + mod + " modifier not allowed on method"), mod.get$span());
      }
    }
  }
  if (this.isFactory) {
    this.isStatic = true;
  }
  if (this.get$isOperator() && this.isStatic && !this.get$isCallMethod()) {
    $globals.world.error(("operator method may not be static \"" + this.name + "\""), this.get$span());
  }
  if (this.isAbstract) {
    if (this.definition.body != null && !(this.declaringType.get$definition() instanceof FunctionTypeDefinition)) {
      $globals.world.error("abstract method can not have a body", this.get$span());
    }
    if (this.isStatic && !(this.declaringType.get$definition() instanceof FunctionTypeDefinition)) {
      $globals.world.error("static method can not be abstract", this.get$span());
    }
  }
  else {
    if (this.definition.body == null && !this.get$isConstructor() && !this.get$isNative()) {
      $globals.world.error("method needs a body", this.get$span());
    }
  }
  if (this.get$isConstructor() && !this.isFactory) {
    this.returnType = this.declaringType;
  }
  else {
    this.returnType = this.resolveType(this.definition.returnType, false, true);
  }
  this.parameters = [];
  var $$list = this.definition.formals;
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var formal = $$list.$index($$i);
    var param = new Parameter(formal, this);
    param.resolve$0();
    this.parameters.add(param);
  }
  if (!this.isLambda) {
    this.get$library()._addMember(this);
  }
}
MethodMember.prototype.resolveType = function(node, typeErrors, allowVoid) {
  var t = Element.prototype.resolveType.call(this, node, typeErrors);
  if (this.isStatic && !this.isFactory && (t instanceof ParameterType)) {
    $globals.world.error("using type parameter in static context.", node.span);
  }
  if (!allowVoid && t.get$isVoid()) {
    $globals.world.error("\"void\" only allowed as return type", node.span);
  }
  return t;
}
MethodMember.prototype._evalConstConstructor$2 = MethodMember.prototype._evalConstConstructor;
MethodMember.prototype._get$3 = function($0, $1, $2) {
  return this._get($0, $1, $2, false);
};
MethodMember.prototype._get$3$isDynamic = MethodMember.prototype._get;
MethodMember.prototype._get$4 = MethodMember.prototype._get;
MethodMember.prototype._set$4 = function($0, $1, $2, $3) {
  return this._set($0, $1, $2, $3, false);
};
MethodMember.prototype._set$4$isDynamic = MethodMember.prototype._set;
MethodMember.prototype._set$5 = MethodMember.prototype._set;
MethodMember.prototype.canInvoke$2 = MethodMember.prototype.canInvoke;
MethodMember.prototype.invoke$4 = function($0, $1, $2, $3) {
  return this.invoke($0, $1, $2, $3, false);
};
MethodMember.prototype.invoke$4$isDynamic = MethodMember.prototype.invoke;
MethodMember.prototype.invoke$5 = MethodMember.prototype.invoke;
MethodMember.prototype.namesInOrder$1 = MethodMember.prototype.namesInOrder;
MethodMember.prototype.provideFieldSyntax$0 = MethodMember.prototype.provideFieldSyntax;
MethodMember.prototype.providePropertySyntax$0 = MethodMember.prototype.providePropertySyntax;
MethodMember.prototype.resolve$0 = MethodMember.prototype.resolve;
MethodMember.prototype.resolveType$2 = function($0, $1) {
  return this.resolveType($0, $1, false);
};
// ********** Code for MemberSet **************
function MemberSet(member, isVar) {
  this.jsname = member.get$jsname();
  this.name = member.name;
  this.isVar = isVar;
  this.members = [member];
}
MemberSet.prototype.get$name = function() { return this.name; };
MemberSet.prototype.get$members = function() { return this.members; };
MemberSet.prototype.get$jsname = function() { return this.jsname; };
MemberSet.prototype.get$isVar = function() { return this.isVar; };
MemberSet.prototype.toString = function() {
  return ("" + this.name + ":" + this.members.get$length());
}
MemberSet.prototype.get$containsMethods = function() {
  return this.members.some((function (m) {
    return (m instanceof MethodMember);
  })
  );
}
MemberSet.prototype.add = function(member) {
  return this.members.add(member);
}
MemberSet.prototype.get$isStatic = function() {
  return this.members.get$length() == (1) && this.members.$index((0)).get$isStatic();
}
MemberSet.prototype.get$isOperator = function() {
  return this.members.$index((0)).get$isOperator();
}
MemberSet.prototype.canInvoke = function(context, args) {
  return this.members.some((function (m) {
    return m.canInvoke$2(context, args);
  })
  );
}
MemberSet.prototype._makeError = function(node, target, action) {
  if (!target.type.get$isVar()) {
    $globals.world.warning(("could not find applicable " + action + " for \"" + this.name + "\""), node.span);
  }
  return new Value($globals.world.varType, ("" + target.get$code() + "." + this.jsname + "() /*no applicable " + action + "*/"), node.span, true);
}
MemberSet.prototype.get$treatAsField = function() {
  if (this._treatAsField == null) {
    this._treatAsField = !this.isVar && (this.members.some((function (m) {
      return m.get$requiresFieldSyntax();
    })
    ) || this.members.every((function (m) {
      return !m.get$requiresPropertySyntax();
    })
    ));
    var $$list = this.members;
    for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
      var member = $$list.$index($$i);
      if (this._treatAsField) {
        member.provideFieldSyntax$0();
      }
      else {
        member.providePropertySyntax$0();
      }
    }
  }
  return this._treatAsField;
}
MemberSet.prototype._get = function(context, node, target, isDynamic) {
  var returnValue;
  var targets = this.members.filter((function (m) {
    return m.get$canGet();
  })
  );
  if (this.isVar) {
    targets.forEach$1((function (m) {
      return m._get$3$isDynamic(context, node, target, true);
    })
    );
    returnValue = new Value(this._foldTypes(targets), null, node.span, true);
  }
  else {
    if (this.members.get$length() == (1)) {
      return this.members.$index((0))._get$4(context, node, target, isDynamic);
    }
    else if ($eq(targets.get$length(), (1))) {
      return targets.$index((0))._get$4(context, node, target, isDynamic);
    }
    for (var $$i = targets.iterator$0(); $$i.hasNext$0(); ) {
      var member = $$i.next$0();
      var value = member._get$3$isDynamic(context, node, target, true);
      returnValue = this._tryUnion(returnValue, value, node);
    }
    if (returnValue == null) {
      return this._makeError(node, target, "getter");
    }
  }
  if (returnValue.get$code() == null) {
    if (this.get$treatAsField()) {
      return new Value(returnValue.type, ("" + target.get$code() + "." + this.jsname), node.span, true);
    }
    else {
      return new Value(returnValue.type, ("" + target.get$code() + ".get$" + this.jsname + "()"), node.span, true);
    }
  }
  return returnValue;
}
MemberSet.prototype._set = function(context, node, target, value, isDynamic) {
  var returnValue;
  var targets = this.members.filter((function (m) {
    return m.get$canSet();
  })
  );
  if (this.isVar) {
    targets.forEach$1((function (m) {
      return m._set$4$isDynamic(context, node, target, value, true);
    })
    );
    returnValue = new Value(this._foldTypes(targets), null, node.span, true);
  }
  else {
    if (this.members.get$length() == (1)) {
      return this.members.$index((0))._set$5(context, node, target, value, isDynamic);
    }
    else if ($eq(targets.get$length(), (1))) {
      return targets.$index((0))._set$5(context, node, target, value, isDynamic);
    }
    for (var $$i = targets.iterator$0(); $$i.hasNext$0(); ) {
      var member = $$i.next$0();
      var res = member._set$4$isDynamic(context, node, target, value, true);
      returnValue = this._tryUnion(returnValue, res, node);
    }
    if (returnValue == null) {
      return this._makeError(node, target, "setter");
    }
  }
  if (returnValue.get$code() == null) {
    if (this.get$treatAsField()) {
      return new Value(returnValue.type, ("" + target.get$code() + "." + this.jsname + " = " + value.get$code()), node.span, true);
    }
    else {
      return new Value(returnValue.type, ("" + target.get$code() + ".set$" + this.jsname + "(" + value.get$code() + ")"), node.span, true);
    }
  }
  return returnValue;
}
MemberSet.prototype.invoke = function(context, node, target, args, isDynamic) {
  if (this.isVar && !this.get$isOperator()) {
    return this.invokeOnVar(context, node, target, args);
  }
  if (this.members.get$length() == (1)) {
    return this.members.$index((0)).invoke$5(context, node, target, args, isDynamic);
  }
  var targets = this.members.filter((function (m) {
    return m.canInvoke$2(context, args);
  })
  );
  if ($eq(targets.get$length(), (1))) {
    return targets.$index((0)).invoke$5(context, node, target, args, isDynamic);
  }
  var returnValue = null;
  for (var $$i = targets.iterator$0(); $$i.hasNext$0(); ) {
    var member = $$i.next$0();
    var res = member.invoke$4$isDynamic(context, node, target, args, true);
    returnValue = this._tryUnion(returnValue, res, node);
  }
  if (returnValue == null) {
    return this._makeError(node, target, "method");
  }
  if (returnValue.get$code() == null) {
    if (this.name == ":call") {
      return target._varCall(context, node, args);
    }
    else if (this.get$isOperator()) {
      return this.invokeSpecial(target, args, returnValue.type);
    }
    else {
      return this.invokeOnVar(context, node, target, args);
    }
  }
  return returnValue;
}
MemberSet.prototype.invokeSpecial = function(target, args, returnType) {
  var argsString = args.getCode();
  if (this.name == ":index" || this.name == ":setindex") {
    return new Value(returnType, ("" + target.get$code() + "." + this.jsname + "(" + argsString + ")"), target.span, true);
  }
  else {
    if (argsString.get$length() > (0)) argsString = (", " + argsString);
    $globals.world.gen.corejs.useOperator(this.name);
    return new Value(returnType, ("" + this.jsname + "(" + target.get$code() + argsString + ")"), target.span, true);
  }
}
MemberSet.prototype.invokeOnVar = function(context, node, target, args) {
  context.counters.dynamicMethodCalls++;
  var member = this.getVarMember(context, node, args);
  return member.invoke$4(context, node, target, args);
}
MemberSet.prototype._tryUnion = function(x, y, node) {
  if (x == null) return y;
  var type = Type.union(x.type, y.type);
  if (x.get$code() == y.get$code()) {
    if ($eq(type, x.type)) {
      return x;
    }
    else if (x.get$isConst() || y.get$isConst()) {
      $globals.world.internalError("unexpected: union of const values ");
    }
    else {
      var ret = new Value(type, x.get$code(), node.span, true);
      ret.set$isSuper(x.isSuper && y.isSuper);
      ret.set$needsTemp(x.needsTemp || y.needsTemp);
      ret.set$isType(x.isType && y.isType);
      return ret;
    }
  }
  else {
    return new Value(type, null, node.span, true);
  }
}
MemberSet.prototype.getVarMember = function(context, node, args) {
  if ($globals.world.objectType.varStubs == null) {
    $globals.world.objectType.varStubs = new HashMapImplementation();
  }
  var stubName = _getCallStubName(this.name, args);
  var stub = $globals.world.objectType.varStubs.$index(stubName);
  if (stub == null) {
    var mset = context.findMembers(this.name).members;
    var targets = mset.filter$1((function (m) {
      return m.canInvoke$2(context, args);
    })
    );
    stub = new VarMethodSet(this.name, stubName, targets, args, this._foldTypes(targets));
    $globals.world.objectType.varStubs.$setindex(stubName, stub);
  }
  return stub;
}
MemberSet.prototype._foldTypes = function(targets) {
  return reduce(map(targets, (function (t) {
    return t.get$returnType();
  })
  ), Type.union, $globals.world.varType);
}
MemberSet.prototype._get$3 = function($0, $1, $2) {
  return this._get($0, $1, $2, false);
};
MemberSet.prototype._get$3$isDynamic = MemberSet.prototype._get;
MemberSet.prototype._get$4 = MemberSet.prototype._get;
MemberSet.prototype._set$4 = function($0, $1, $2, $3) {
  return this._set($0, $1, $2, $3, false);
};
MemberSet.prototype._set$4$isDynamic = MemberSet.prototype._set;
MemberSet.prototype._set$5 = MemberSet.prototype._set;
MemberSet.prototype.add$1 = MemberSet.prototype.add;
MemberSet.prototype.canInvoke$2 = MemberSet.prototype.canInvoke;
MemberSet.prototype.invoke$4 = function($0, $1, $2, $3) {
  return this.invoke($0, $1, $2, $3, false);
};
MemberSet.prototype.invoke$4$isDynamic = MemberSet.prototype.invoke;
MemberSet.prototype.invoke$5 = MemberSet.prototype.invoke;
MemberSet.prototype.toString$0 = MemberSet.prototype.toString;
// ********** Code for FactoryMap **************
function FactoryMap() {
  this.factories = new HashMapImplementation();
}
FactoryMap.prototype.getFactoriesFor = function(typeName) {
  var ret = this.factories.$index(typeName);
  if (ret == null) {
    ret = new HashMapImplementation();
    this.factories.$setindex(typeName, ret);
  }
  return ret;
}
FactoryMap.prototype.addFactory = function(typeName, name, member) {
  this.getFactoriesFor(typeName).$setindex(name, member);
}
FactoryMap.prototype.getFactory = function(typeName, name) {
  return this.getFactoriesFor(typeName).$index(name);
}
FactoryMap.prototype.forEach = function(f) {
  this.factories.forEach((function (_, constructors) {
    constructors.forEach((function (_, member) {
      f(member);
    })
    );
  })
  );
}
FactoryMap.prototype.forEach$1 = function($0) {
  return this.forEach(to$call$1($0));
};
FactoryMap.prototype.getFactory$2 = FactoryMap.prototype.getFactory;
// ********** Code for Token **************
function Token(kind, source, start, end) {
  this.end = end;
  this.kind = kind;
  this.start = start;
  this.source = source;
}
Token.prototype.get$kind = function() { return this.kind; };
Token.prototype.get$end = function() { return this.end; };
Token.prototype.get$start = function() { return this.start; };
Token.prototype.get$text = function() {
  return this.source.get$text().substring(this.start, this.end);
}
Token.prototype.toString = function() {
  var kindText = TokenKind.kindToString(this.kind);
  var actualText = this.get$text();
  if ($ne(kindText, actualText)) {
    if (actualText.get$length() > (10)) {
      actualText = actualText.substring$2((0), (8)) + "...";
    }
    return ("" + kindText + "(" + actualText + ")");
  }
  else {
    return kindText;
  }
}
Token.prototype.get$span = function() {
  return new SourceSpan(this.source, this.start, this.end);
}
Token.prototype.end$0 = function() {
  return this.end.call$0();
};
Token.prototype.start$0 = function() {
  return this.start();
};
Token.prototype.toString$0 = Token.prototype.toString;
// ********** Code for LiteralToken **************
$inherits(LiteralToken, Token);
function LiteralToken(kind, source, start, end, value) {
  this.value = value;
  Token.call(this, kind, source, start, end);
}
LiteralToken.prototype.get$value = function() { return this.value; };
LiteralToken.prototype.set$value = function(value) { return this.value = value; };
// ********** Code for ErrorToken **************
$inherits(ErrorToken, Token);
function ErrorToken(kind, source, start, end, message) {
  this.message = message;
  Token.call(this, kind, source, start, end);
}
ErrorToken.prototype.get$message = function() { return this.message; };
ErrorToken.prototype.set$message = function(value) { return this.message = value; };
// ********** Code for SourceFile **************
function SourceFile(filename, _text) {
  this._text = _text;
  this.filename = filename;
}
SourceFile.prototype.get$filename = function() { return this.filename; };
SourceFile.prototype.get$orderInLibrary = function() { return this.orderInLibrary; };
SourceFile.prototype.set$orderInLibrary = function(value) { return this.orderInLibrary = value; };
SourceFile.prototype.get$text = function() {
  return this._text;
}
SourceFile.prototype.get$lineStarts = function() {
  if (this._lineStarts == null) {
    var starts = [(0)];
    var index = (0);
    while (index < this.get$text().length) {
      index = this.get$text().indexOf("\n", index) + (1);
      if (index <= (0)) break;
      starts.add$1(index);
    }
    starts.add$1(this.get$text().length + (1));
    this._lineStarts = starts;
  }
  return this._lineStarts;
}
SourceFile.prototype.getLine = function(position) {
  var starts = this.get$lineStarts();
  for (var i = (0);
   i < starts.get$length(); i++) {
    if (starts.$index(i) > position) return i - (1);
  }
  $globals.world.internalError("bad position");
}
SourceFile.prototype.getColumn = function(line, position) {
  return position - this.get$lineStarts().$index(line);
}
SourceFile.prototype.getLocationMessage = function(message, start, end, includeText) {
  var line = this.getLine(start);
  var column = this.getColumn(line, start);
  var buf = new StringBufferImpl(("" + this.filename + ":" + (line + (1)) + ":" + (column + (1)) + ": " + message));
  if (includeText) {
    buf.add$1("\n");
    var textLine;
    if ((line + (2)) < this._lineStarts.get$length()) {
      textLine = this.get$text().substring(this._lineStarts.$index(line), this._lineStarts.$index(line + (1)));
    }
    else {
      textLine = this.get$text().substring(this._lineStarts.$index(line)) + "\n";
    }
    var toColumn = Math.min(column + (end - start), textLine.get$length());
    if ($globals.options.useColors) {
      buf.add$1(textLine.substring$2((0), column));
      buf.add$1($globals._RED_COLOR);
      buf.add$1(textLine.substring$2(column, toColumn));
      buf.add$1($globals._NO_COLOR);
      buf.add$1(textLine.substring$1(toColumn));
    }
    else {
      buf.add$1(textLine);
    }
    var i = (0);
    for (; i < column; i++) {
      buf.add$1(" ");
    }
    if ($globals.options.useColors) buf.add$1($globals._RED_COLOR);
    for (; i < toColumn; i++) {
      buf.add$1("^");
    }
    if ($globals.options.useColors) buf.add$1($globals._NO_COLOR);
  }
  return buf.toString$0();
}
SourceFile.prototype.compareTo = function(other) {
  if (this.orderInLibrary != null && other.orderInLibrary != null) {
    return this.orderInLibrary - other.orderInLibrary;
  }
  else {
    return this.filename.compareTo(other.filename);
  }
}
SourceFile.prototype.compareTo$1 = SourceFile.prototype.compareTo;
SourceFile.prototype.getColumn$2 = SourceFile.prototype.getColumn;
SourceFile.prototype.getLine$1 = SourceFile.prototype.getLine;
// ********** Code for SourceSpan **************
function SourceSpan(file, start, end) {
  this.file = file;
  this.start = start;
  this.end = end;
}
SourceSpan.prototype.get$file = function() { return this.file; };
SourceSpan.prototype.get$start = function() { return this.start; };
SourceSpan.prototype.get$end = function() { return this.end; };
SourceSpan.prototype.get$text = function() {
  return this.file.get$text().substring(this.start, this.end);
}
SourceSpan.prototype.toMessageString = function(message) {
  return this.file.getLocationMessage(message, this.start, this.end, true);
}
SourceSpan.prototype.get$locationText = function() {
  var line = this.file.getLine(this.start);
  var column = this.file.getColumn(line, this.start);
  return ("" + this.file.filename + ":" + (line + (1)) + ":" + (column + (1)));
}
SourceSpan.prototype.compareTo = function(other) {
  if ($eq(this.file, other.file)) {
    var d = this.start - other.start;
    return d == (0) ? (this.end - other.end) : d;
  }
  return this.file.compareTo(other.file);
}
SourceSpan.prototype.compareTo$1 = SourceSpan.prototype.compareTo;
SourceSpan.prototype.end$0 = function() {
  return this.end.call$0();
};
SourceSpan.prototype.start$0 = function() {
  return this.start();
};
// ********** Code for InterpStack **************
function InterpStack(previous, quote, isMultiline) {
  this.quote = quote;
  this.isMultiline = isMultiline;
  this.depth = (-1);
  this.previous = previous;
}
InterpStack.prototype.get$previous = function() { return this.previous; };
InterpStack.prototype.set$previous = function(value) { return this.previous = value; };
InterpStack.prototype.get$quote = function() { return this.quote; };
InterpStack.prototype.get$isMultiline = function() { return this.isMultiline; };
InterpStack.prototype.get$depth = function() { return this.depth; };
InterpStack.prototype.set$depth = function(value) { return this.depth = value; };
InterpStack.prototype.pop = function() {
  return this.previous;
}
InterpStack.push = function(stack, quote, isMultiline) {
  var newStack = new InterpStack(stack, quote, isMultiline);
  if (stack != null) newStack.set$previous(stack);
  return newStack;
}
InterpStack.prototype.next$0 = function() {
  return this.next();
};
// ********** Code for TokenizerHelpers **************
function TokenizerHelpers() {

}
TokenizerHelpers.isIdentifierStart = function(c) {
  return ((c >= (97) && c <= (122)) || (c >= (65) && c <= (90)) || c == (95));
}
TokenizerHelpers.isDigit = function(c) {
  return (c >= (48) && c <= (57));
}
TokenizerHelpers.isIdentifierPart = function(c) {
  return (TokenizerHelpers.isIdentifierStart(c) || TokenizerHelpers.isDigit(c) || c == (36));
}
TokenizerHelpers.isInterpIdentifierPart = function(c) {
  return (TokenizerHelpers.isIdentifierStart(c) || TokenizerHelpers.isDigit(c));
}
// ********** Code for TokenizerBase **************
$inherits(TokenizerBase, TokenizerHelpers);
function TokenizerBase(_source, _skipWhitespace, index) {
  this._lang_index = index;
  this._skipWhitespace = _skipWhitespace;
  this._source = _source;
  TokenizerHelpers.call(this);
  this._text = this._source.get$text();
}
TokenizerBase.prototype._nextChar = function() {
  if (this._lang_index < this._text.length) {
    return this._text.charCodeAt(this._lang_index++);
  }
  else {
    return (0);
  }
}
TokenizerBase.prototype._peekChar = function() {
  if (this._lang_index < this._text.length) {
    return this._text.charCodeAt(this._lang_index);
  }
  else {
    return (0);
  }
}
TokenizerBase.prototype._maybeEatChar = function(ch) {
  if (this._lang_index < this._text.length) {
    if (this._text.charCodeAt(this._lang_index) == ch) {
      this._lang_index++;
      return true;
    }
    else {
      return false;
    }
  }
  else {
    return false;
  }
}
TokenizerBase.prototype._finishToken = function(kind) {
  return new Token(kind, this._source, this._startIndex, this._lang_index);
}
TokenizerBase.prototype._errorToken = function(message) {
  return new ErrorToken((65), this._source, this._startIndex, this._lang_index, message);
}
TokenizerBase.prototype.finishWhitespace = function() {
  this._lang_index--;
  while (this._lang_index < this._text.length) {
    var ch = this._text.charCodeAt(this._lang_index++);
    if ($eq(ch, (32)) || $eq(ch, (9)) || $eq(ch, (13))) {
    }
    else if ($eq(ch, (10))) {
      if (!this._skipWhitespace) {
        return this._finishToken((63));
      }
    }
    else {
      this._lang_index--;
      if (this._skipWhitespace) {
        return this.next();
      }
      else {
        return this._finishToken((63));
      }
    }
  }
  return this._finishToken((1));
}
TokenizerBase.prototype.finishHashBang = function() {
  while (true) {
    var ch = this._nextChar();
    if (ch == (0) || ch == (10) || ch == (13)) {
      return this._finishToken((13));
    }
  }
}
TokenizerBase.prototype.finishSingleLineComment = function() {
  while (true) {
    var ch = this._nextChar();
    if (ch == (0) || ch == (10) || ch == (13)) {
      if (this._skipWhitespace) {
        return this.next();
      }
      else {
        return this._finishToken((64));
      }
    }
  }
}
TokenizerBase.prototype.finishMultiLineComment = function() {
  var nesting = (1);
  do {
    var ch = this._nextChar();
    if (ch == (0)) {
      return this._errorToken();
    }
    else if (ch == (42)) {
      if (this._maybeEatChar((47))) {
        nesting--;
      }
    }
    else if (ch == (47)) {
      if (this._maybeEatChar((42))) {
        nesting++;
      }
    }
  }
  while (nesting > (0))
  if (this._skipWhitespace) {
    return this.next();
  }
  else {
    return this._finishToken((64));
  }
}
TokenizerBase.prototype.eatDigits = function() {
  while (this._lang_index < this._text.length) {
    if (TokenizerHelpers.isDigit(this._text.charCodeAt(this._lang_index))) {
      this._lang_index++;
    }
    else {
      return;
    }
  }
}
TokenizerBase._hexDigit = function(c) {
  if (c >= (48) && c <= (57)) {
    return c - (48);
  }
  else if (c >= (97) && c <= (102)) {
    return c - (87);
  }
  else if (c >= (65) && c <= (70)) {
    return c - (55);
  }
  else {
    return (-1);
  }
}
TokenizerBase.prototype.readHex = function(hexLength) {
  var maxIndex;
  if (hexLength == null) {
    maxIndex = this._text.length - (1);
  }
  else {
    maxIndex = this._lang_index + hexLength;
    if (maxIndex >= this._text.length) return (-1);
  }
  var result = (0);
  while (this._lang_index < maxIndex) {
    var digit = TokenizerBase._hexDigit(this._text.charCodeAt(this._lang_index));
    if ($eq(digit, (-1))) {
      if (hexLength == null) {
        return result;
      }
      else {
        return (-1);
      }
    }
    TokenizerBase._hexDigit(this._text.charCodeAt(this._lang_index));
    result = (result * (16)) + digit;
    this._lang_index++;
  }
  return result;
}
TokenizerBase.prototype.finishHex = function() {
  var value = this.readHex();
  return new LiteralToken((61), this._source, this._startIndex, this._lang_index, value);
}
TokenizerBase.prototype.finishNumber = function() {
  this.eatDigits();
  if (this._peekChar() == (46)) {
    this._nextChar();
    if (TokenizerHelpers.isDigit(this._peekChar())) {
      this.eatDigits();
      return this.finishNumberExtra((62));
    }
    else {
      this._lang_index--;
    }
  }
  return this.finishNumberExtra((60));
}
TokenizerBase.prototype.finishNumberExtra = function(kind) {
  if (this._maybeEatChar((101)) || this._maybeEatChar((69))) {
    kind = (62);
    this._maybeEatChar((45));
    this._maybeEatChar((43));
    this.eatDigits();
  }
  if (this._peekChar() != (0) && TokenizerHelpers.isIdentifierStart(this._peekChar())) {
    this._nextChar();
    return this._errorToken("illegal character in number");
  }
  return this._finishToken(kind);
}
TokenizerBase.prototype._makeStringToken = function(buf, isPart) {
  var s = Strings.String$fromCharCodes$factory(buf);
  var kind = isPart ? (59) : (58);
  return new LiteralToken(kind, this._source, this._startIndex, this._lang_index, s);
}
TokenizerBase.prototype._makeRawStringToken = function(isMultiline) {
  var s;
  if (isMultiline) {
    var start = this._startIndex + (4);
    if (this._source.get$text()[start] == "\n") start++;
    s = this._source.get$text().substring(start, this._lang_index - (3));
  }
  else {
    s = this._source.get$text().substring(this._startIndex + (2), this._lang_index - (1));
  }
  return new LiteralToken((58), this._source, this._startIndex, this._lang_index, s);
}
TokenizerBase.prototype.finishMultilineString = function(quote) {
  var buf = [];
  while (true) {
    var ch = this._nextChar();
    if (ch == (0)) {
      return this._errorToken();
    }
    else if (ch == quote) {
      if (this._maybeEatChar(quote)) {
        if (this._maybeEatChar(quote)) {
          return this._makeStringToken(buf, false);
        }
        buf.add$1(quote);
      }
      buf.add$1(quote);
    }
    else if (ch == (36)) {
      this._interpStack = InterpStack.push(this._interpStack, quote, true);
      return this._makeStringToken(buf, true);
    }
    else if (ch == (92)) {
      var escapeVal = this.readEscapeSequence();
      if ($eq(escapeVal, (-1))) {
        return this._errorToken("invalid hex escape sequence");
      }
      else {
        buf.add$1(escapeVal);
      }
    }
    else {
      buf.add$1(ch);
    }
  }
}
TokenizerBase.prototype._finishOpenBrace = function() {
  var $0;
  if (this._interpStack != null) {
    if (this._interpStack.depth == (-1)) {
      this._interpStack.depth = (1);
    }
    else {
      ($0 = this._interpStack).depth = $0.depth + (1);
    }
  }
  return this._finishToken((6));
}
TokenizerBase.prototype._finishCloseBrace = function() {
  var $0;
  if (this._interpStack != null) {
    ($0 = this._interpStack).depth = $0.depth - (1);
  }
  return this._finishToken((7));
}
TokenizerBase.prototype.finishString = function(quote) {
  if (this._maybeEatChar(quote)) {
    if (this._maybeEatChar(quote)) {
      this._maybeEatChar((10));
      return this.finishMultilineString(quote);
    }
    else {
      return this._makeStringToken(new Array(), false);
    }
  }
  return this.finishStringBody(quote);
}
TokenizerBase.prototype.finishRawString = function(quote) {
  if (this._maybeEatChar(quote)) {
    if (this._maybeEatChar(quote)) {
      return this.finishMultilineRawString(quote);
    }
    else {
      return this._makeStringToken([], false);
    }
  }
  while (true) {
    var ch = this._nextChar();
    if (ch == quote) {
      return this._makeRawStringToken(false);
    }
    else if (ch == (0)) {
      return this._errorToken();
    }
  }
}
TokenizerBase.prototype.finishMultilineRawString = function(quote) {
  while (true) {
    var ch = this._nextChar();
    if (ch == (0)) {
      return this._errorToken();
    }
    else if (ch == quote && this._maybeEatChar(quote) && this._maybeEatChar(quote)) {
      return this._makeRawStringToken(true);
    }
  }
}
TokenizerBase.prototype.finishStringBody = function(quote) {
  var buf = new Array();
  while (true) {
    var ch = this._nextChar();
    if (ch == quote) {
      return this._makeStringToken(buf, false);
    }
    else if (ch == (36)) {
      this._interpStack = InterpStack.push(this._interpStack, quote, false);
      return this._makeStringToken(buf, true);
    }
    else if (ch == (0)) {
      return this._errorToken();
    }
    else if (ch == (92)) {
      var escapeVal = this.readEscapeSequence();
      if ($eq(escapeVal, (-1))) {
        return this._errorToken("invalid hex escape sequence");
      }
      else {
        buf.add$1(escapeVal);
      }
    }
    else {
      buf.add$1(ch);
    }
  }
}
TokenizerBase.prototype.readEscapeSequence = function() {
  var ch = this._nextChar();
  var hexValue;
  switch (ch) {
    case (110):

      return (10);

    case (114):

      return (13);

    case (102):

      return (12);

    case (98):

      return (8);

    case (116):

      return (9);

    case (118):

      return (11);

    case (120):

      hexValue = this.readHex((2));
      break;

    case (117):

      if (this._maybeEatChar((123))) {
        hexValue = this.readHex();
        if (!this._maybeEatChar((125))) {
          return (-1);
        }
        else {
          break;
        }
      }
      else {
        hexValue = this.readHex((4));
        break;
      }

    default:

      return ch;

  }
  if (hexValue == (-1)) return (-1);
  if (hexValue < (55296) || hexValue > (57343) && hexValue <= (65535)) {
    return hexValue;
  }
  else if (hexValue <= (1114111)) {
    $globals.world.fatal("unicode values greater than 2 bytes not implemented yet");
    return (-1);
  }
  else {
    return (-1);
  }
}
TokenizerBase.prototype.finishDot = function() {
  if (TokenizerHelpers.isDigit(this._peekChar())) {
    this.eatDigits();
    return this.finishNumberExtra((62));
  }
  else {
    return this._finishToken((14));
  }
}
TokenizerBase.prototype.finishIdentifier = function(ch) {
  if (this._interpStack != null && this._interpStack.depth == (-1)) {
    this._interpStack.depth = (0);
    if (ch == (36)) {
      return this._errorToken("illegal character after $ in string interpolation");
    }
    while (this._lang_index < this._text.length) {
      if (!TokenizerHelpers.isInterpIdentifierPart(this._text.charCodeAt(this._lang_index++))) {
        this._lang_index--;
        break;
      }
    }
  }
  else {
    while (this._lang_index < this._text.length) {
      if (!TokenizerHelpers.isIdentifierPart(this._text.charCodeAt(this._lang_index++))) {
        this._lang_index--;
        break;
      }
    }
  }
  var kind = this.getIdentifierKind();
  if (kind == (70)) {
    return this._finishToken((70));
  }
  else {
    return this._finishToken(kind);
  }
}
TokenizerBase.prototype.next$0 = TokenizerBase.prototype.next;
// ********** Code for Tokenizer **************
$inherits(Tokenizer, TokenizerBase);
function Tokenizer(source, skipWhitespace, index) {
  TokenizerBase.call(this, source, skipWhitespace, index);
}
Tokenizer.prototype.next = function() {
  this._startIndex = this._lang_index;
  if (this._interpStack != null && this._interpStack.depth == (0)) {
    var istack = this._interpStack;
    this._interpStack = this._interpStack.pop();
    if (istack.get$isMultiline()) {
      return this.finishMultilineString(istack.get$quote());
    }
    else {
      return this.finishStringBody(istack.get$quote());
    }
  }
  var ch;
  ch = this._nextChar();
  switch (ch) {
    case (0):

      return this._finishToken((1));

    case (32):
    case (9):
    case (10):
    case (13):

      return this.finishWhitespace();

    case (33):

      if (this._maybeEatChar((61))) {
        if (this._maybeEatChar((61))) {
          return this._finishToken((51));
        }
        else {
          return this._finishToken((49));
        }
      }
      else {
        return this._finishToken((19));
      }

    case (34):

      return this.finishString((34));

    case (35):

      if (this._maybeEatChar((33))) {
        return this.finishHashBang();
      }
      else {
        return this._finishToken((12));
      }

    case (36):

      if (this._maybeEatChar((34))) {
        return this.finishString((34));
      }
      else if (this._maybeEatChar((39))) {
        return this.finishString((39));
      }
      else {
        return this.finishIdentifier((36));
      }

    case (37):

      if (this._maybeEatChar((61))) {
        return this._finishToken((32));
      }
      else {
        return this._finishToken((47));
      }

    case (38):

      if (this._maybeEatChar((38))) {
        return this._finishToken((35));
      }
      else if (this._maybeEatChar((61))) {
        return this._finishToken((23));
      }
      else {
        return this._finishToken((38));
      }

    case (39):

      return this.finishString((39));

    case (40):

      return this._finishToken((2));

    case (41):

      return this._finishToken((3));

    case (42):

      if (this._maybeEatChar((61))) {
        return this._finishToken((29));
      }
      else {
        return this._finishToken((44));
      }

    case (43):

      if (this._maybeEatChar((43))) {
        return this._finishToken((16));
      }
      else if (this._maybeEatChar((61))) {
        return this._finishToken((27));
      }
      else {
        return this._finishToken((42));
      }

    case (44):

      return this._finishToken((11));

    case (45):

      if (this._maybeEatChar((45))) {
        return this._finishToken((17));
      }
      else if (this._maybeEatChar((61))) {
        return this._finishToken((28));
      }
      else {
        return this._finishToken((43));
      }

    case (46):

      if (this._maybeEatChar((46))) {
        if (this._maybeEatChar((46))) {
          return this._finishToken((15));
        }
        else {
          return this._errorToken();
        }
      }
      else {
        return this.finishDot();
      }

    case (47):

      if (this._maybeEatChar((42))) {
        return this.finishMultiLineComment();
      }
      else if (this._maybeEatChar((47))) {
        return this.finishSingleLineComment();
      }
      else if (this._maybeEatChar((61))) {
        return this._finishToken((30));
      }
      else {
        return this._finishToken((45));
      }

    case (48):

      if (this._maybeEatChar((88))) {
        return this.finishHex();
      }
      else if (this._maybeEatChar((120))) {
        return this.finishHex();
      }
      else {
        return this.finishNumber();
      }

    case (58):

      return this._finishToken((8));

    case (59):

      return this._finishToken((10));

    case (60):

      if (this._maybeEatChar((60))) {
        if (this._maybeEatChar((61))) {
          return this._finishToken((24));
        }
        else {
          return this._finishToken((39));
        }
      }
      else if (this._maybeEatChar((61))) {
        return this._finishToken((54));
      }
      else {
        return this._finishToken((52));
      }

    case (61):

      if (this._maybeEatChar((61))) {
        if (this._maybeEatChar((61))) {
          return this._finishToken((50));
        }
        else {
          return this._finishToken((48));
        }
      }
      else if (this._maybeEatChar((62))) {
        return this._finishToken((9));
      }
      else {
        return this._finishToken((20));
      }

    case (62):

      if (this._maybeEatChar((61))) {
        return this._finishToken((55));
      }
      else if (this._maybeEatChar((62))) {
        if (this._maybeEatChar((61))) {
          return this._finishToken((25));
        }
        else if (this._maybeEatChar((62))) {
          if (this._maybeEatChar((61))) {
            return this._finishToken((26));
          }
          else {
            return this._finishToken((41));
          }
        }
        else {
          return this._finishToken((40));
        }
      }
      else {
        return this._finishToken((53));
      }

    case (63):

      return this._finishToken((33));

    case (64):

      if (this._maybeEatChar((34))) {
        return this.finishRawString((34));
      }
      else if (this._maybeEatChar((39))) {
        return this.finishRawString((39));
      }
      else {
        return this._errorToken();
      }

    case (91):

      if (this._maybeEatChar((93))) {
        if (this._maybeEatChar((61))) {
          return this._finishToken((57));
        }
        else {
          return this._finishToken((56));
        }
      }
      else {
        return this._finishToken((4));
      }

    case (93):

      return this._finishToken((5));

    case (94):

      if (this._maybeEatChar((61))) {
        return this._finishToken((22));
      }
      else {
        return this._finishToken((37));
      }

    case (123):

      return this._finishOpenBrace();

    case (124):

      if (this._maybeEatChar((61))) {
        return this._finishToken((21));
      }
      else if (this._maybeEatChar((124))) {
        return this._finishToken((34));
      }
      else {
        return this._finishToken((36));
      }

    case (125):

      return this._finishCloseBrace();

    case (126):

      if (this._maybeEatChar((47))) {
        if (this._maybeEatChar((61))) {
          return this._finishToken((31));
        }
        else {
          return this._finishToken((46));
        }
      }
      else {
        return this._finishToken((18));
      }

    default:

      if (TokenizerHelpers.isIdentifierStart(ch)) {
        return this.finishIdentifier(ch);
      }
      else if (TokenizerHelpers.isDigit(ch)) {
        return this.finishNumber();
      }
      else {
        return this._errorToken();
      }

  }
}
Tokenizer.prototype.getIdentifierKind = function() {
  var i0 = this._startIndex;
  var ch;
  switch (this._lang_index - i0) {
    case (2):

      ch = this._text.charCodeAt(i0);
      if (ch == (100)) {
        if (this._text.charCodeAt(i0 + (1)) == (111)) return (95);
      }
      else if (ch == (105)) {
        ch = this._text.charCodeAt(i0 + (1));
        if (ch == (102)) {
          return (102);
        }
        else if (ch == (110)) {
          return (103);
        }
        else if (ch == (115)) {
          return (104);
        }
      }
      return (70);

    case (3):

      ch = this._text.charCodeAt(i0);
      if (ch == (102)) {
        if (this._text.charCodeAt(i0 + (1)) == (111) && this._text.charCodeAt(i0 + (2)) == (114)) return (101);
      }
      else if (ch == (103)) {
        if (this._text.charCodeAt(i0 + (1)) == (101) && this._text.charCodeAt(i0 + (2)) == (116)) return (75);
      }
      else if (ch == (110)) {
        if (this._text.charCodeAt(i0 + (1)) == (101) && this._text.charCodeAt(i0 + (2)) == (119)) return (105);
      }
      else if (ch == (115)) {
        if (this._text.charCodeAt(i0 + (1)) == (101) && this._text.charCodeAt(i0 + (2)) == (116)) return (83);
      }
      else if (ch == (116)) {
        if (this._text.charCodeAt(i0 + (1)) == (114) && this._text.charCodeAt(i0 + (2)) == (121)) return (113);
      }
      else if (ch == (118)) {
        if (this._text.charCodeAt(i0 + (1)) == (97) && this._text.charCodeAt(i0 + (2)) == (114)) return (114);
      }
      return (70);

    case (4):

      ch = this._text.charCodeAt(i0);
      if (ch == (99)) {
        ch = this._text.charCodeAt(i0 + (1));
        if (ch == (97)) {
          ch = this._text.charCodeAt(i0 + (2));
          if (ch == (108)) {
            if (this._text.charCodeAt(i0 + (3)) == (108)) return (73);
          }
          else if (ch == (115)) {
            if (this._text.charCodeAt(i0 + (3)) == (101)) return (89);
          }
        }
      }
      else if (ch == (101)) {
        if (this._text.charCodeAt(i0 + (1)) == (108) && this._text.charCodeAt(i0 + (2)) == (115) && this._text.charCodeAt(i0 + (3)) == (101)) return (96);
      }
      else if (ch == (110)) {
        if (this._text.charCodeAt(i0 + (1)) == (117) && this._text.charCodeAt(i0 + (2)) == (108) && this._text.charCodeAt(i0 + (3)) == (108)) return (106);
      }
      else if (ch == (116)) {
        ch = this._text.charCodeAt(i0 + (1));
        if (ch == (104)) {
          if (this._text.charCodeAt(i0 + (2)) == (105) && this._text.charCodeAt(i0 + (3)) == (115)) return (110);
        }
        else if (ch == (114)) {
          if (this._text.charCodeAt(i0 + (2)) == (117) && this._text.charCodeAt(i0 + (3)) == (101)) return (112);
        }
      }
      else if (ch == (118)) {
        if (this._text.charCodeAt(i0 + (1)) == (111) && this._text.charCodeAt(i0 + (2)) == (105) && this._text.charCodeAt(i0 + (3)) == (100)) return (115);
      }
      return (70);

    case (5):

      ch = this._text.charCodeAt(i0);
      if (ch == (97)) {
        if (this._text.charCodeAt(i0 + (1)) == (119) && this._text.charCodeAt(i0 + (2)) == (97) && this._text.charCodeAt(i0 + (3)) == (105) && this._text.charCodeAt(i0 + (4)) == (116)) return (87);
      }
      else if (ch == (98)) {
        if (this._text.charCodeAt(i0 + (1)) == (114) && this._text.charCodeAt(i0 + (2)) == (101) && this._text.charCodeAt(i0 + (3)) == (97) && this._text.charCodeAt(i0 + (4)) == (107)) return (88);
      }
      else if (ch == (99)) {
        ch = this._text.charCodeAt(i0 + (1));
        if (ch == (97)) {
          if (this._text.charCodeAt(i0 + (2)) == (116) && this._text.charCodeAt(i0 + (3)) == (99) && this._text.charCodeAt(i0 + (4)) == (104)) return (90);
        }
        else if (ch == (108)) {
          if (this._text.charCodeAt(i0 + (2)) == (97) && this._text.charCodeAt(i0 + (3)) == (115) && this._text.charCodeAt(i0 + (4)) == (115)) return (91);
        }
        else if (ch == (111)) {
          if (this._text.charCodeAt(i0 + (2)) == (110) && this._text.charCodeAt(i0 + (3)) == (115) && this._text.charCodeAt(i0 + (4)) == (116)) return (92);
        }
      }
      else if (ch == (102)) {
        ch = this._text.charCodeAt(i0 + (1));
        if (ch == (97)) {
          if (this._text.charCodeAt(i0 + (2)) == (108) && this._text.charCodeAt(i0 + (3)) == (115) && this._text.charCodeAt(i0 + (4)) == (101)) return (98);
        }
        else if (ch == (105)) {
          if (this._text.charCodeAt(i0 + (2)) == (110) && this._text.charCodeAt(i0 + (3)) == (97) && this._text.charCodeAt(i0 + (4)) == (108)) return (99);
        }
      }
      else if (ch == (115)) {
        if (this._text.charCodeAt(i0 + (1)) == (117) && this._text.charCodeAt(i0 + (2)) == (112) && this._text.charCodeAt(i0 + (3)) == (101) && this._text.charCodeAt(i0 + (4)) == (114)) return (108);
      }
      else if (ch == (116)) {
        if (this._text.charCodeAt(i0 + (1)) == (104) && this._text.charCodeAt(i0 + (2)) == (114) && this._text.charCodeAt(i0 + (3)) == (111) && this._text.charCodeAt(i0 + (4)) == (119)) return (111);
      }
      else if (ch == (119)) {
        if (this._text.charCodeAt(i0 + (1)) == (104) && this._text.charCodeAt(i0 + (2)) == (105) && this._text.charCodeAt(i0 + (3)) == (108) && this._text.charCodeAt(i0 + (4)) == (101)) return (116);
      }
      return (70);

    case (6):

      ch = this._text.charCodeAt(i0);
      if (ch == (97)) {
        if (this._text.charCodeAt(i0 + (1)) == (115) && this._text.charCodeAt(i0 + (2)) == (115) && this._text.charCodeAt(i0 + (3)) == (101) && this._text.charCodeAt(i0 + (4)) == (114) && this._text.charCodeAt(i0 + (5)) == (116)) return (72);
      }
      else if (ch == (105)) {
        if (this._text.charCodeAt(i0 + (1)) == (109) && this._text.charCodeAt(i0 + (2)) == (112) && this._text.charCodeAt(i0 + (3)) == (111) && this._text.charCodeAt(i0 + (4)) == (114) && this._text.charCodeAt(i0 + (5)) == (116)) return (77);
      }
      else if (ch == (110)) {
        ch = this._text.charCodeAt(i0 + (1));
        if (ch == (97)) {
          if (this._text.charCodeAt(i0 + (2)) == (116) && this._text.charCodeAt(i0 + (3)) == (105) && this._text.charCodeAt(i0 + (4)) == (118) && this._text.charCodeAt(i0 + (5)) == (101)) return (80);
        }
        else if (ch == (101)) {
          if (this._text.charCodeAt(i0 + (2)) == (103) && this._text.charCodeAt(i0 + (3)) == (97) && this._text.charCodeAt(i0 + (4)) == (116) && this._text.charCodeAt(i0 + (5)) == (101)) return (81);
        }
      }
      else if (ch == (114)) {
        if (this._text.charCodeAt(i0 + (1)) == (101) && this._text.charCodeAt(i0 + (2)) == (116) && this._text.charCodeAt(i0 + (3)) == (117) && this._text.charCodeAt(i0 + (4)) == (114) && this._text.charCodeAt(i0 + (5)) == (110)) return (107);
      }
      else if (ch == (115)) {
        ch = this._text.charCodeAt(i0 + (1));
        if (ch == (111)) {
          if (this._text.charCodeAt(i0 + (2)) == (117) && this._text.charCodeAt(i0 + (3)) == (114) && this._text.charCodeAt(i0 + (4)) == (99) && this._text.charCodeAt(i0 + (5)) == (101)) return (84);
        }
        else if (ch == (116)) {
          if (this._text.charCodeAt(i0 + (2)) == (97) && this._text.charCodeAt(i0 + (3)) == (116) && this._text.charCodeAt(i0 + (4)) == (105) && this._text.charCodeAt(i0 + (5)) == (99)) return (85);
        }
        else if (ch == (119)) {
          if (this._text.charCodeAt(i0 + (2)) == (105) && this._text.charCodeAt(i0 + (3)) == (116) && this._text.charCodeAt(i0 + (4)) == (99) && this._text.charCodeAt(i0 + (5)) == (104)) return (109);
        }
      }
      return (70);

    case (7):

      ch = this._text.charCodeAt(i0);
      if (ch == (100)) {
        if (this._text.charCodeAt(i0 + (1)) == (101) && this._text.charCodeAt(i0 + (2)) == (102) && this._text.charCodeAt(i0 + (3)) == (97) && this._text.charCodeAt(i0 + (4)) == (117) && this._text.charCodeAt(i0 + (5)) == (108) && this._text.charCodeAt(i0 + (6)) == (116)) return (94);
      }
      else if (ch == (101)) {
        if (this._text.charCodeAt(i0 + (1)) == (120) && this._text.charCodeAt(i0 + (2)) == (116) && this._text.charCodeAt(i0 + (3)) == (101) && this._text.charCodeAt(i0 + (4)) == (110) && this._text.charCodeAt(i0 + (5)) == (100) && this._text.charCodeAt(i0 + (6)) == (115)) return (97);
      }
      else if (ch == (102)) {
        ch = this._text.charCodeAt(i0 + (1));
        if (ch == (97)) {
          if (this._text.charCodeAt(i0 + (2)) == (99) && this._text.charCodeAt(i0 + (3)) == (116) && this._text.charCodeAt(i0 + (4)) == (111) && this._text.charCodeAt(i0 + (5)) == (114) && this._text.charCodeAt(i0 + (6)) == (121)) return (74);
        }
        else if (ch == (105)) {
          if (this._text.charCodeAt(i0 + (2)) == (110) && this._text.charCodeAt(i0 + (3)) == (97) && this._text.charCodeAt(i0 + (4)) == (108) && this._text.charCodeAt(i0 + (5)) == (108) && this._text.charCodeAt(i0 + (6)) == (121)) return (100);
        }
      }
      else if (ch == (108)) {
        if (this._text.charCodeAt(i0 + (1)) == (105) && this._text.charCodeAt(i0 + (2)) == (98) && this._text.charCodeAt(i0 + (3)) == (114) && this._text.charCodeAt(i0 + (4)) == (97) && this._text.charCodeAt(i0 + (5)) == (114) && this._text.charCodeAt(i0 + (6)) == (121)) return (79);
      }
      else if (ch == (116)) {
        if (this._text.charCodeAt(i0 + (1)) == (121) && this._text.charCodeAt(i0 + (2)) == (112) && this._text.charCodeAt(i0 + (3)) == (101) && this._text.charCodeAt(i0 + (4)) == (100) && this._text.charCodeAt(i0 + (5)) == (101) && this._text.charCodeAt(i0 + (6)) == (102)) return (86);
      }
      return (70);

    case (8):

      ch = this._text.charCodeAt(i0);
      if (ch == (97)) {
        if (this._text.charCodeAt(i0 + (1)) == (98) && this._text.charCodeAt(i0 + (2)) == (115) && this._text.charCodeAt(i0 + (3)) == (116) && this._text.charCodeAt(i0 + (4)) == (114) && this._text.charCodeAt(i0 + (5)) == (97) && this._text.charCodeAt(i0 + (6)) == (99) && this._text.charCodeAt(i0 + (7)) == (116)) return (71);
      }
      else if (ch == (99)) {
        if (this._text.charCodeAt(i0 + (1)) == (111) && this._text.charCodeAt(i0 + (2)) == (110) && this._text.charCodeAt(i0 + (3)) == (116) && this._text.charCodeAt(i0 + (4)) == (105) && this._text.charCodeAt(i0 + (5)) == (110) && this._text.charCodeAt(i0 + (6)) == (117) && this._text.charCodeAt(i0 + (7)) == (101)) return (93);
      }
      else if (ch == (111)) {
        if (this._text.charCodeAt(i0 + (1)) == (112) && this._text.charCodeAt(i0 + (2)) == (101) && this._text.charCodeAt(i0 + (3)) == (114) && this._text.charCodeAt(i0 + (4)) == (97) && this._text.charCodeAt(i0 + (5)) == (116) && this._text.charCodeAt(i0 + (6)) == (111) && this._text.charCodeAt(i0 + (7)) == (114)) return (82);
      }
      return (70);

    case (9):

      if (this._text.charCodeAt(i0) == (105) && this._text.charCodeAt(i0 + (1)) == (110) && this._text.charCodeAt(i0 + (2)) == (116) && this._text.charCodeAt(i0 + (3)) == (101) && this._text.charCodeAt(i0 + (4)) == (114) && this._text.charCodeAt(i0 + (5)) == (102) && this._text.charCodeAt(i0 + (6)) == (97) && this._text.charCodeAt(i0 + (7)) == (99) && this._text.charCodeAt(i0 + (8)) == (101)) return (78);
      return (70);

    case (10):

      if (this._text.charCodeAt(i0) == (105) && this._text.charCodeAt(i0 + (1)) == (109) && this._text.charCodeAt(i0 + (2)) == (112) && this._text.charCodeAt(i0 + (3)) == (108) && this._text.charCodeAt(i0 + (4)) == (101) && this._text.charCodeAt(i0 + (5)) == (109) && this._text.charCodeAt(i0 + (6)) == (101) && this._text.charCodeAt(i0 + (7)) == (110) && this._text.charCodeAt(i0 + (8)) == (116) && this._text.charCodeAt(i0 + (9)) == (115)) return (76);
      return (70);

    default:

      return (70);

  }
}
Tokenizer.prototype.next$0 = Tokenizer.prototype.next;
// ********** Code for TokenKind **************
function TokenKind() {}
TokenKind.kindToString = function(kind) {
  switch (kind) {
    case (1):

      return "end of file";

    case (2):

      return "(";

    case (3):

      return ")";

    case (4):

      return "[";

    case (5):

      return "]";

    case (6):

      return "{";

    case (7):

      return "}";

    case (8):

      return ":";

    case (9):

      return "=>";

    case (10):

      return ";";

    case (11):

      return ",";

    case (12):

      return "#";

    case (13):

      return "#!";

    case (14):

      return ".";

    case (15):

      return "...";

    case (16):

      return "++";

    case (17):

      return "--";

    case (18):

      return "~";

    case (19):

      return "!";

    case (20):

      return "=";

    case (21):

      return "|=";

    case (22):

      return "^=";

    case (23):

      return "&=";

    case (24):

      return "<<=";

    case (25):

      return ">>=";

    case (26):

      return ">>>=";

    case (27):

      return "+=";

    case (28):

      return "-=";

    case (29):

      return "*=";

    case (30):

      return "/=";

    case (31):

      return "~/=";

    case (32):

      return "%=";

    case (33):

      return "?";

    case (34):

      return "||";

    case (35):

      return "&&";

    case (36):

      return "|";

    case (37):

      return "^";

    case (38):

      return "&";

    case (39):

      return "<<";

    case (40):

      return ">>";

    case (41):

      return ">>>";

    case (42):

      return "+";

    case (43):

      return "-";

    case (44):

      return "*";

    case (45):

      return "/";

    case (46):

      return "~/";

    case (47):

      return "%";

    case (48):

      return "==";

    case (49):

      return "!=";

    case (50):

      return "===";

    case (51):

      return "!==";

    case (52):

      return "<";

    case (53):

      return ">";

    case (54):

      return "<=";

    case (55):

      return ">=";

    case (56):

      return "[]";

    case (57):

      return "[]=";

    case (58):

      return "string";

    case (59):

      return "string part";

    case (60):

      return "integer";

    case (61):

      return "hex integer";

    case (62):

      return "double";

    case (63):

      return "whitespace";

    case (64):

      return "comment";

    case (65):

      return "error";

    case (66):

      return "incomplete string";

    case (67):

      return "incomplete comment";

    case (68):

      return "incomplete multiline string dq";

    case (69):

      return "incomplete multiline string sq";

    case (70):

      return "identifier";

    case (71):

      return "pseudo-keyword 'abstract'";

    case (72):

      return "pseudo-keyword 'assert'";

    case (73):

      return "pseudo-keyword 'call'";

    case (74):

      return "pseudo-keyword 'factory'";

    case (75):

      return "pseudo-keyword 'get'";

    case (76):

      return "pseudo-keyword 'implements'";

    case (77):

      return "pseudo-keyword 'import'";

    case (78):

      return "pseudo-keyword 'interface'";

    case (79):

      return "pseudo-keyword 'library'";

    case (80):

      return "pseudo-keyword 'native'";

    case (81):

      return "pseudo-keyword 'negate'";

    case (82):

      return "pseudo-keyword 'operator'";

    case (83):

      return "pseudo-keyword 'set'";

    case (84):

      return "pseudo-keyword 'source'";

    case (85):

      return "pseudo-keyword 'static'";

    case (86):

      return "pseudo-keyword 'typedef'";

    case (87):

      return "keyword 'await'";

    case (88):

      return "keyword 'break'";

    case (89):

      return "keyword 'case'";

    case (90):

      return "keyword 'catch'";

    case (91):

      return "keyword 'class'";

    case (92):

      return "keyword 'const'";

    case (93):

      return "keyword 'continue'";

    case (94):

      return "keyword 'default'";

    case (95):

      return "keyword 'do'";

    case (96):

      return "keyword 'else'";

    case (97):

      return "keyword 'extends'";

    case (98):

      return "keyword 'false'";

    case (99):

      return "keyword 'final'";

    case (100):

      return "keyword 'finally'";

    case (101):

      return "keyword 'for'";

    case (102):

      return "keyword 'if'";

    case (103):

      return "keyword 'in'";

    case (104):

      return "keyword 'is'";

    case (105):

      return "keyword 'new'";

    case (106):

      return "keyword 'null'";

    case (107):

      return "keyword 'return'";

    case (108):

      return "keyword 'super'";

    case (109):

      return "keyword 'switch'";

    case (110):

      return "keyword 'this'";

    case (111):

      return "keyword 'throw'";

    case (112):

      return "keyword 'true'";

    case (113):

      return "keyword 'try'";

    case (114):

      return "keyword 'var'";

    case (115):

      return "keyword 'void'";

    case (116):

      return "keyword 'while'";

    default:

      return "TokenKind(" + kind.toString() + ")";

  }
}
TokenKind.isIdentifier = function(kind) {
  return kind >= (70) && kind < (87);
}
TokenKind.infixPrecedence = function(kind) {
  switch (kind) {
    case (20):

      return (2);

    case (21):

      return (2);

    case (22):

      return (2);

    case (23):

      return (2);

    case (24):

      return (2);

    case (25):

      return (2);

    case (26):

      return (2);

    case (27):

      return (2);

    case (28):

      return (2);

    case (29):

      return (2);

    case (30):

      return (2);

    case (31):

      return (2);

    case (32):

      return (2);

    case (33):

      return (3);

    case (34):

      return (4);

    case (35):

      return (5);

    case (36):

      return (6);

    case (37):

      return (7);

    case (38):

      return (8);

    case (39):

      return (11);

    case (40):

      return (11);

    case (41):

      return (11);

    case (42):

      return (12);

    case (43):

      return (12);

    case (44):

      return (13);

    case (45):

      return (13);

    case (46):

      return (13);

    case (47):

      return (13);

    case (48):

      return (9);

    case (49):

      return (9);

    case (50):

      return (9);

    case (51):

      return (9);

    case (52):

      return (10);

    case (53):

      return (10);

    case (54):

      return (10);

    case (55):

      return (10);

    case (104):

      return (10);

    default:

      return (-1);

  }
}
TokenKind.rawOperatorFromMethod = function(name) {
  switch (name) {
    case ":bit_not":

      return "~";

    case ":bit_or":

      return "|";

    case ":bit_xor":

      return "^";

    case ":bit_and":

      return "&";

    case ":shl":

      return "<<";

    case ":sar":

      return ">>";

    case ":shr":

      return ">>>";

    case ":add":

      return "+";

    case ":sub":

      return "-";

    case ":mul":

      return "*";

    case ":div":

      return "/";

    case ":truncdiv":

      return "~/";

    case ":mod":

      return "%";

    case ":eq":

      return "==";

    case ":lt":

      return "<";

    case ":gt":

      return ">";

    case ":lte":

      return "<=";

    case ":gte":

      return ">=";

    case ":index":

      return "[]";

    case ":setindex":

      return "[]=";

    case ":ne":

      return "!=";

  }
}
TokenKind.binaryMethodName = function(kind) {
  switch (kind) {
    case (18):

      return ":bit_not";

    case (36):

      return ":bit_or";

    case (37):

      return ":bit_xor";

    case (38):

      return ":bit_and";

    case (39):

      return ":shl";

    case (40):

      return ":sar";

    case (41):

      return ":shr";

    case (42):

      return ":add";

    case (43):

      return ":sub";

    case (44):

      return ":mul";

    case (45):

      return ":div";

    case (46):

      return ":truncdiv";

    case (47):

      return ":mod";

    case (48):

      return ":eq";

    case (52):

      return ":lt";

    case (53):

      return ":gt";

    case (54):

      return ":lte";

    case (55):

      return ":gte";

    case (56):

      return ":index";

    case (57):

      return ":setindex";

  }
}
TokenKind.kindFromAssign = function(kind) {
  if (kind == (20)) return (0);
  if (kind > (20) && kind <= (32)) {
    return kind + (15);
  }
  return (-1);
}
// ********** Code for Parser **************
function Parser(source, diet, throwOnIncomplete, optionalSemicolons, startOffset) {
  this.throwOnIncomplete = throwOnIncomplete;
  this.source = source;
  this.optionalSemicolons = optionalSemicolons;
  this._recover = false;
  this._inhibitLambda = false;
  this.diet = diet;
  this._afterParensIndex = (0);
  this.tokenizer = new Tokenizer(this.source, true, startOffset);
  this._peekToken = this.tokenizer.next();
  this._afterParens = [];
}
Parser.prototype.get$enableAwait = function() {
  return $globals.experimentalAwaitPhase != null;
}
Parser.prototype.isPrematureEndOfFile = function() {
  if (this.throwOnIncomplete && this._maybeEat((1))) {
    $throw(new IncompleteSourceException(this._previousToken));
  }
  else if (this._maybeEat((1))) {
    this._lang_error("unexpected end of file", this._peekToken.get$span());
    return true;
  }
  else {
    return false;
  }
}
Parser.prototype._recoverTo = function(kind1, kind2, kind3) {
  while (!this.isPrematureEndOfFile()) {
    var kind = this._peek();
    if (kind == kind1 || kind == kind2 || kind == kind3) {
      this._recover = false;
      return true;
    }
    this._lang_next();
  }
  return false;
}
Parser.prototype._peek = function() {
  return this._peekToken.kind;
}
Parser.prototype._lang_next = function() {
  this._previousToken = this._peekToken;
  this._peekToken = this.tokenizer.next();
  return this._previousToken;
}
Parser.prototype._peekKind = function(kind) {
  return this._peekToken.kind == kind;
}
Parser.prototype._peekIdentifier = function() {
  return this._isIdentifier(this._peekToken.kind);
}
Parser.prototype._isIdentifier = function(kind) {
  return TokenKind.isIdentifier(kind) || (!this.get$enableAwait() && $eq(kind, (87)));
}
Parser.prototype._maybeEat = function(kind) {
  if (this._peekToken.kind == kind) {
    this._previousToken = this._peekToken;
    this._peekToken = this.tokenizer.next();
    return true;
  }
  else {
    return false;
  }
}
Parser.prototype._eat = function(kind) {
  if (!this._maybeEat(kind)) {
    this._errorExpected(TokenKind.kindToString(kind));
  }
}
Parser.prototype._eatSemicolon = function() {
  if (this.optionalSemicolons && this._peekKind((1))) return;
  this._eat((10));
}
Parser.prototype._errorExpected = function(expected) {
  if (this.throwOnIncomplete) this.isPrematureEndOfFile();
  var tok = this._lang_next();
  if ((tok instanceof ErrorToken) && tok.get$message() != null) {
    this._lang_error(tok.get$message(), tok.get$span());
  }
  else {
    this._lang_error(("expected " + expected + ", but found " + tok), tok.get$span());
  }
}
Parser.prototype._lang_error = function(message, location) {
  if (this._recover) return;
  if (location == null) {
    location = this._peekToken.get$span();
  }
  $globals.world.fatal(message, location);
  this._recover = true;
}
Parser.prototype._skipBlock = function() {
  var depth = (1);
  this._eat((6));
  while (true) {
    var tok = this._lang_next();
    if ($eq(tok.get$kind(), (6))) {
      depth += (1);
    }
    else if ($eq(tok.get$kind(), (7))) {
      depth -= (1);
      if (depth == (0)) return;
    }
    else if ($eq(tok.get$kind(), (1))) {
      this._lang_error("unexpected end of file during diet parse", tok.get$span());
      return;
    }
  }
}
Parser.prototype._makeSpan = function(start) {
  return new SourceSpan(this.source, start, this._previousToken.end);
}
Parser.prototype.compilationUnit = function() {
  var ret = [];
  this._maybeEat((13));
  while (this._peekKind((12))) {
    ret.add$1(this.directive());
  }
  this._recover = false;
  while (!this._maybeEat((1))) {
    ret.add$1(this.topLevelDefinition());
  }
  this._recover = false;
  return ret;
}
Parser.prototype.directive = function() {
  var start = this._peekToken.start;
  this._eat((12));
  var name = this.identifier();
  var args = this.arguments();
  this._eatSemicolon();
  return new DirectiveDefinition(name, args, this._makeSpan(start));
}
Parser.prototype.topLevelDefinition = function() {
  switch (this._peek()) {
    case (91):

      return this.classDefinition((91));

    case (78):

      return this.classDefinition((78));

    case (86):

      return this.functionTypeAlias();

    default:

      return this.declaration(true);

  }
}
Parser.prototype.classDefinition = function(kind) {
  var start = this._peekToken.start;
  this._eat(kind);
  var name = this.identifierForType();
  var typeParams = null;
  if (this._peekKind((52))) {
    typeParams = this.typeParameters();
  }
  var _extends = null;
  if (this._maybeEat((97))) {
    _extends = this.typeList();
  }
  var _implements = null;
  if (this._maybeEat((76))) {
    _implements = this.typeList();
  }
  var _native = null;
  if (this._maybeEat((80))) {
    _native = this.maybeStringLiteral();
    if (_native != null) _native = new NativeType(_native);
  }
  var oldFactory = this._maybeEat((74));
  var defaultType = null;
  if (oldFactory || this._maybeEat((94))) {
    if (oldFactory) {
      $globals.world.warning("factory no longer supported, use \"default\" instead", this._previousToken.get$span());
    }
    var baseType = this.nameTypeReference();
    var typeParams0 = null;
    if (this._peekKind((52))) {
      typeParams0 = this.typeParameters();
    }
    defaultType = new DefaultTypeReference(oldFactory, baseType, typeParams0, this._makeSpan(baseType.get$span().get$start()));
  }
  var body = [];
  if (this._maybeEat((6))) {
    while (!this._maybeEat((7))) {
      body.add$1(this.declaration(true));
      if (this._recover) {
        if (!this._recoverTo((7), (10))) break;
        this._maybeEat((10));
      }
    }
  }
  else {
    this._errorExpected("block starting with \"{\" or \";\"");
  }
  return new TypeDefinition(kind == (91), name, typeParams, _extends, _implements, _native, defaultType, body, this._makeSpan(start));
}
Parser.prototype.functionTypeAlias = function() {
  var start = this._peekToken.start;
  this._eat((86));
  var di = this.declaredIdentifier(false);
  var typeParams = null;
  if (this._peekKind((52))) {
    typeParams = this.typeParameters();
  }
  var formals = this.formalParameterList();
  this._eatSemicolon();
  var func = new FunctionDefinition(null, di.get$type(), di.get$name(), formals, null, null, null, this._makeSpan(start));
  return new FunctionTypeDefinition(func, typeParams, this._makeSpan(start));
}
Parser.prototype.initializers = function() {
  this._inhibitLambda = true;
  var ret = [];
  do {
    ret.add$1(this.expression());
  }
  while (this._maybeEat((11)))
  this._inhibitLambda = false;
  return ret;
}
Parser.prototype.get$initializers = function() {
  return this.initializers.bind(this);
}
Parser.prototype.functionBody = function(inExpression) {
  var start = this._peekToken.start;
  if (this._maybeEat((9))) {
    var expr = this.expression();
    if (!inExpression) {
      this._eatSemicolon();
    }
    return new ReturnStatement(expr, this._makeSpan(start));
  }
  else if (this._peekKind((6))) {
    if (this.diet) {
      this._skipBlock();
      return new DietStatement(this._makeSpan(start));
    }
    else {
      return this.block();
    }
  }
  else if (!inExpression) {
    if (this._maybeEat((10))) {
      return null;
    }
  }
  this._lang_error("Expected function body (neither { nor => found)");
}
Parser.prototype.finishField = function(start, modifiers, type, name, value) {
  var names = [name];
  var values = [value];
  while (this._maybeEat((11))) {
    names.add$1(this.identifier());
    if (this._maybeEat((20))) {
      values.add$1(this.expression());
    }
    else {
      values.add$1();
    }
  }
  this._eatSemicolon();
  return new VariableDefinition(modifiers, type, names, values, this._makeSpan(start));
}
Parser.prototype.finishDefinition = function(start, modifiers, di) {
  switch (this._peek()) {
    case (2):

      var formals = this.formalParameterList();
      var inits = null, native_ = null;
      if (this._maybeEat((8))) {
        inits = this.initializers();
      }
      if (this._maybeEat((80))) {
        native_ = this.maybeStringLiteral();
        if (native_ == null) native_ = "";
      }
      var body = this.functionBody(false);
      if (di.get$name() == null) {
        di.set$name(di.get$type().get$name());
      }
      return new FunctionDefinition(modifiers, di.get$type(), di.get$name(), formals, inits, native_, body, this._makeSpan(start));

    case (20):

      this._eat((20));
      var value = this.expression();
      return this.finishField(start, modifiers, di.get$type(), di.get$name(), value);

    case (11):
    case (10):

      return this.finishField(start, modifiers, di.get$type(), di.get$name(), null);

    default:

      this._errorExpected("declaration");
      return null;

  }
}
Parser.prototype.declaration = function(includeOperators) {
  var start = this._peekToken.start;
  if (this._peekKind((74))) {
    return this.factoryConstructorDeclaration();
  }
  var modifiers = this._readModifiers();
  return this.finishDefinition(start, modifiers, this.declaredIdentifier(includeOperators));
}
Parser.prototype.factoryConstructorDeclaration = function() {
  var start = this._peekToken.start;
  var factoryToken = this._lang_next();
  var names = [this.identifier()];
  while (this._maybeEat((14))) {
    names.add$1(this.identifier());
  }
  if (this._peekKind((52))) {
    var tp = this.typeParameters();
    $globals.world.warning("type parameters on factories are no longer supported, place them on the class instead", this._makeSpan(tp.$index((0)).get$span().get$start()));
  }
  var name = null;
  var type = null;
  if (this._maybeEat((14))) {
    name = this.identifier();
  }
  else {
    if (names.get$length() > (1)) {
      name = names.removeLast$0();
    }
    else {
      name = new Identifier("", names.$index((0)).get$span());
    }
  }
  if (names.get$length() > (1)) {
    this._lang_error("unsupported qualified name for factory", names.$index((0)).get$span());
  }
  type = new NameTypeReference(false, names.$index((0)), null, names.$index((0)).get$span());
  var di = new DeclaredIdentifier(type, name, this._makeSpan(start));
  return this.finishDefinition(start, [factoryToken], di);
}
Parser.prototype.statement = function() {
  switch (this._peek()) {
    case (88):

      return this.breakStatement();

    case (93):

      return this.continueStatement();

    case (107):

      return this.returnStatement();

    case (111):

      return this.throwStatement();

    case (72):

      return this.assertStatement();

    case (116):

      return this.whileStatement();

    case (95):

      return this.doStatement();

    case (101):

      return this.forStatement();

    case (102):

      return this.ifStatement();

    case (109):

      return this.switchStatement();

    case (113):

      return this.tryStatement();

    case (6):

      return this.block();

    case (10):

      return this.emptyStatement();

    case (99):

      return this.declaration(false);

    case (114):

      return this.declaration(false);

    default:

      return this.finishExpressionAsStatement(this.expression());

  }
}
Parser.prototype.finishExpressionAsStatement = function(expr) {
  var start = expr.get$span().get$start();
  if (this._maybeEat((8))) {
    var label = this._makeLabel(expr);
    return new LabeledStatement(label, this.statement(), this._makeSpan(start));
  }
  if ((expr instanceof LambdaExpression)) {
    if (!(expr.get$func().get$body() instanceof BlockStatement)) {
      this._eatSemicolon();
      expr.get$func().set$span(this._makeSpan(start));
    }
    return expr.get$func();
  }
  else if ((expr instanceof DeclaredIdentifier)) {
    var value = null;
    if (this._maybeEat((20))) {
      value = this.expression();
    }
    return this.finishField(start, null, expr.get$type(), expr.get$name(), value);
  }
  else if (this._isBin(expr, (20)) && ((expr.get$x() instanceof DeclaredIdentifier))) {
    var di = expr.get$x();
    return this.finishField(start, null, di.type, di.name, expr.get$y());
  }
  else if (this._isBin(expr, (52)) && this._maybeEat((11))) {
    var baseType = this._makeType(expr.get$x());
    var typeArgs = [this._makeType(expr.get$y())];
    var gt = this._finishTypeArguments(baseType, (0), typeArgs);
    var name = this.identifier();
    var value = null;
    if (this._maybeEat((20))) {
      value = this.expression();
    }
    return this.finishField(expr.get$span().get$start(), null, gt, name, value);
  }
  else {
    this._eatSemicolon();
    return new ExpressionStatement(expr, this._makeSpan(expr.get$span().get$start()));
  }
}
Parser.prototype.testCondition = function() {
  this._eatLeftParen();
  var ret = this.expression();
  this._eat((3));
  return ret;
}
Parser.prototype.block = function() {
  var start = this._peekToken.start;
  this._eat((6));
  var stmts = [];
  while (!this._maybeEat((7))) {
    stmts.add$1(this.statement());
    if (this._recover && !this._recoverTo((7), (10))) break;
  }
  this._recover = false;
  return new BlockStatement(stmts, this._makeSpan(start));
}
Parser.prototype.emptyStatement = function() {
  var start = this._peekToken.start;
  this._eat((10));
  return new EmptyStatement(this._makeSpan(start));
}
Parser.prototype.ifStatement = function() {
  var start = this._peekToken.start;
  this._eat((102));
  var test = this.testCondition();
  var trueBranch = this.statement();
  var falseBranch = null;
  if (this._maybeEat((96))) {
    falseBranch = this.statement();
  }
  return new IfStatement(test, trueBranch, falseBranch, this._makeSpan(start));
}
Parser.prototype.whileStatement = function() {
  var start = this._peekToken.start;
  this._eat((116));
  var test = this.testCondition();
  var body = this.statement();
  return new WhileStatement(test, body, this._makeSpan(start));
}
Parser.prototype.doStatement = function() {
  var start = this._peekToken.start;
  this._eat((95));
  var body = this.statement();
  this._eat((116));
  var test = this.testCondition();
  this._eatSemicolon();
  return new DoStatement(body, test, this._makeSpan(start));
}
Parser.prototype.forStatement = function() {
  var start = this._peekToken.start;
  this._eat((101));
  this._eatLeftParen();
  var init = this.forInitializerStatement(start);
  if ((init instanceof ForInStatement)) {
    return init;
  }
  var test = null;
  if (!this._maybeEat((10))) {
    test = this.expression();
    this._eatSemicolon();
  }
  var step = [];
  if (!this._maybeEat((3))) {
    step.add$1(this.expression());
    while (this._maybeEat((11))) {
      step.add$1(this.expression());
    }
    this._eat((3));
  }
  var body = this.statement();
  return new ForStatement(init, test, step, body, this._makeSpan(start));
}
Parser.prototype.forInitializerStatement = function(start) {
  if (this._maybeEat((10))) {
    return null;
  }
  else {
    var init = this.expression();
    if (this._peekKind((11)) && this._isBin(init, (52))) {
      this._eat((11));
      var baseType = this._makeType(init.get$x());
      var typeArgs = [this._makeType(init.get$y())];
      var gt = this._finishTypeArguments(baseType, (0), typeArgs);
      var name = this.identifier();
      init = new DeclaredIdentifier(gt, name, this._makeSpan(init.get$span().get$start()));
    }
    if (this._maybeEat((103))) {
      return this._finishForIn(start, this._makeDeclaredIdentifier(init));
    }
    else {
      return this.finishExpressionAsStatement(init);
    }
  }
}
Parser.prototype._finishForIn = function(start, di) {
  var expr = this.expression();
  this._eat((3));
  var body = this.statement();
  return new ForInStatement(di, expr, body, this._makeSpan(start));
}
Parser.prototype.tryStatement = function() {
  var start = this._peekToken.start;
  this._eat((113));
  var body = this.block();
  var catches = [];
  while (this._peekKind((90))) {
    catches.add$1(this.catchNode());
  }
  var finallyBlock = null;
  if (this._maybeEat((100))) {
    finallyBlock = this.block();
  }
  return new TryStatement(body, catches, finallyBlock, this._makeSpan(start));
}
Parser.prototype.catchNode = function() {
  var start = this._peekToken.start;
  this._eat((90));
  this._eatLeftParen();
  var exc = this.declaredIdentifier(false);
  var trace = null;
  if (this._maybeEat((11))) {
    trace = this.declaredIdentifier(false);
  }
  this._eat((3));
  var body = this.block();
  return new CatchNode(exc, trace, body, this._makeSpan(start));
}
Parser.prototype.switchStatement = function() {
  var start = this._peekToken.start;
  this._eat((109));
  var test = this.testCondition();
  var cases = [];
  this._eat((6));
  while (!this._maybeEat((7))) {
    cases.add$1(this.caseNode());
  }
  return new SwitchStatement(test, cases, this._makeSpan(start));
}
Parser.prototype._peekCaseEnd = function() {
  var kind = this._peek();
  return $eq(kind, (7)) || $eq(kind, (89)) || $eq(kind, (94));
}
Parser.prototype.caseNode = function() {
  var start = this._peekToken.start;
  var label = null;
  if (this._peekIdentifier()) {
    label = this.identifier();
    this._eat((8));
  }
  var cases = [];
  while (true) {
    if (this._maybeEat((89))) {
      cases.add$1(this.expression());
      this._eat((8));
    }
    else if (this._maybeEat((94))) {
      cases.add$1();
      this._eat((8));
    }
    else {
      break;
    }
  }
  if ($eq(cases.get$length(), (0))) {
    this._lang_error("case or default");
  }
  var stmts = [];
  while (!this._peekCaseEnd()) {
    stmts.add$1(this.statement());
    if (this._recover && !this._recoverTo((7), (89), (94))) {
      break;
    }
  }
  return new CaseNode(label, cases, stmts, this._makeSpan(start));
}
Parser.prototype.returnStatement = function() {
  var start = this._peekToken.start;
  this._eat((107));
  var expr;
  if (this._maybeEat((10))) {
    expr = null;
  }
  else {
    expr = this.expression();
    this._eatSemicolon();
  }
  return new ReturnStatement(expr, this._makeSpan(start));
}
Parser.prototype.throwStatement = function() {
  var start = this._peekToken.start;
  this._eat((111));
  var expr;
  if (this._maybeEat((10))) {
    expr = null;
  }
  else {
    expr = this.expression();
    this._eatSemicolon();
  }
  return new ThrowStatement(expr, this._makeSpan(start));
}
Parser.prototype.assertStatement = function() {
  var start = this._peekToken.start;
  this._eat((72));
  this._eatLeftParen();
  var expr = this.expression();
  this._eat((3));
  this._eatSemicolon();
  return new AssertStatement(expr, this._makeSpan(start));
}
Parser.prototype.breakStatement = function() {
  var start = this._peekToken.start;
  this._eat((88));
  var name = null;
  if (this._peekIdentifier()) {
    name = this.identifier();
  }
  this._eatSemicolon();
  return new BreakStatement(name, this._makeSpan(start));
}
Parser.prototype.continueStatement = function() {
  var start = this._peekToken.start;
  this._eat((93));
  var name = null;
  if (this._peekIdentifier()) {
    name = this.identifier();
  }
  this._eatSemicolon();
  return new ContinueStatement(name, this._makeSpan(start));
}
Parser.prototype.expression = function() {
  return this.infixExpression((0));
}
Parser.prototype._makeType = function(expr) {
  if ((expr instanceof VarExpression)) {
    return new NameTypeReference(false, expr.get$name(), null, expr.get$span());
  }
  else if ((expr instanceof DotExpression)) {
    var type = this._makeType(expr.get$self());
    if (type.get$names() == null) {
      type.set$names([expr.get$name()]);
    }
    else {
      type.get$names().add$1(expr.get$name());
    }
    type.set$span(expr.get$span());
    return type;
  }
  else {
    this._lang_error("expected type reference");
    return null;
  }
}
Parser.prototype.infixExpression = function(precedence) {
  return this.finishInfixExpression(this.unaryExpression(), precedence);
}
Parser.prototype._finishDeclaredId = function(type) {
  var name = this.identifier();
  return this.finishPostfixExpression(new DeclaredIdentifier(type, name, this._makeSpan(type.get$span().get$start())));
}
Parser.prototype._fixAsType = function(x) {
  if (this._maybeEat((53))) {
    var base = this._makeType(x.x);
    var typeParam = this._makeType(x.y);
    var type = new GenericTypeReference(base, [typeParam], (0), this._makeSpan(x.span.start));
    return this._finishDeclaredId(type);
  }
  else {
    var base = this._makeType(x.x);
    var paramBase = this._makeType(x.y);
    var firstParam = this.addTypeArguments(paramBase, (1));
    var type;
    if (firstParam.get$depth() <= (0)) {
      type = new GenericTypeReference(base, [firstParam], (0), this._makeSpan(x.span.start));
    }
    else if (this._maybeEat((11))) {
      type = this._finishTypeArguments(base, (0), [firstParam]);
    }
    else {
      this._eat((53));
      type = new GenericTypeReference(base, [firstParam], (0), this._makeSpan(x.span.start));
    }
    return this._finishDeclaredId(type);
  }
}
Parser.prototype.finishInfixExpression = function(x, precedence) {
  while (true) {
    var kind = this._peek();
    var prec = TokenKind.infixPrecedence(this._peek());
    if (prec >= precedence) {
      if (kind == (52) || kind == (53)) {
        if (this._isBin(x, (52))) {
          return this._fixAsType(x);
        }
      }
      var op = this._lang_next();
      if ($eq(op.get$kind(), (104))) {
        var isTrue = !this._maybeEat((19));
        var typeRef = this.type((0));
        x = new IsExpression(isTrue, x, typeRef, this._makeSpan(x.span.start));
        continue;
      }
      var y = this.infixExpression($eq(prec, (2)) ? prec : prec + (1));
      if ($eq(op.get$kind(), (33))) {
        this._eat((8));
        var z = this.infixExpression(prec);
        x = new ConditionalExpression(x, y, z, this._makeSpan(x.span.start));
      }
      else {
        x = new BinaryExpression(op, x, y, this._makeSpan(x.span.start));
      }
    }
    else {
      break;
    }
  }
  return x;
}
Parser.prototype._isPrefixUnaryOperator = function(kind) {
  switch (kind) {
    case (42):
    case (43):
    case (19):
    case (18):
    case (16):
    case (17):

      return true;

    default:

      return false;

  }
}
Parser.prototype.unaryExpression = function() {
  var start = this._peekToken.start;
  if (this._isPrefixUnaryOperator(this._peek())) {
    var tok = this._lang_next();
    var expr = this.unaryExpression();
    return new UnaryExpression(tok, expr, this._makeSpan(start));
  }
  else if (this.get$enableAwait() && this._maybeEat((87))) {
    var expr = this.unaryExpression();
    return new AwaitExpression(expr, this._makeSpan(start));
  }
  return this.finishPostfixExpression(this.primary());
}
Parser.prototype.argument = function() {
  var start = this._peekToken.start;
  var expr;
  var label = null;
  if (this._maybeEat((15))) {
    label = new Identifier("...", this._makeSpan(start));
  }
  expr = this.expression();
  if (label == null && this._maybeEat((8))) {
    label = this._makeLabel(expr);
    expr = this.expression();
  }
  return new ArgumentNode(label, expr, this._makeSpan(start));
}
Parser.prototype.arguments = function() {
  var args = [];
  this._eatLeftParen();
  var saved = this._inhibitLambda;
  this._inhibitLambda = false;
  if (!this._maybeEat((3))) {
    do {
      args.add$1(this.argument());
    }
    while (this._maybeEat((11)))
    this._eat((3));
  }
  this._inhibitLambda = saved;
  return args;
}
Parser.prototype.finishPostfixExpression = function(expr) {
  switch (this._peek()) {
    case (2):

      return this.finishCallOrLambdaExpression(expr);

    case (4):

      this._eat((4));
      var index = this.expression();
      this._eat((5));
      return this.finishPostfixExpression(new IndexExpression(expr, index, this._makeSpan(expr.get$span().get$start())));

    case (14):

      this._eat((14));
      var name = this.identifier();
      var ret = new DotExpression(expr, name, this._makeSpan(expr.get$span().get$start()));
      return this.finishPostfixExpression(ret);

    case (16):
    case (17):

      var tok = this._lang_next();
      return new PostfixExpression(expr, tok, this._makeSpan(expr.get$span().get$start()));

    case (9):
    case (6):

      return expr;

    default:

      if (this._peekIdentifier()) {
        return this.finishPostfixExpression(new DeclaredIdentifier(this._makeType(expr), this.identifier(), this._makeSpan(expr.get$span().get$start())));
      }
      else {
        return expr;
      }

  }
}
Parser.prototype.finishCallOrLambdaExpression = function(expr) {
  if (this._atClosureParameters()) {
    var formals = this.formalParameterList();
    var body = this.functionBody(true);
    return this._makeFunction(expr, formals, body);
  }
  else {
    if ((expr instanceof DeclaredIdentifier)) {
      this._lang_error("illegal target for call, did you mean to declare a function?", expr.get$span());
    }
    var args = this.arguments();
    return this.finishPostfixExpression(new CallExpression(expr, args, this._makeSpan(expr.get$span().get$start())));
  }
}
Parser.prototype._isBin = function(expr, kind) {
  return (expr instanceof BinaryExpression) && $eq(expr.get$op().get$kind(), kind);
}
Parser.prototype._makeLiteral = function(value) {
  return new LiteralExpression(value, value.span);
}
Parser.prototype.primary = function() {
  var start = this._peekToken.start;
  switch (this._peek()) {
    case (110):

      this._eat((110));
      return new ThisExpression(this._makeSpan(start));

    case (108):

      this._eat((108));
      return new SuperExpression(this._makeSpan(start));

    case (92):

      this._eat((92));
      if (this._peekKind((4)) || this._peekKind((56))) {
        return this.finishListLiteral(start, true, null);
      }
      else if (this._peekKind((6))) {
        return this.finishMapLiteral(start, true, null, null);
      }
      else if (this._peekKind((52))) {
        return this.finishTypedLiteral(start, true);
      }
      else {
        return this.finishNewExpression(start, true);
      }

    case (105):

      this._eat((105));
      return this.finishNewExpression(start, false);

    case (2):

      return this._parenOrLambda();

    case (4):
    case (56):

      return this.finishListLiteral(start, false, null);

    case (6):

      return this.finishMapLiteral(start, false, null, null);

    case (106):

      this._eat((106));
      return this._makeLiteral(Value.fromNull(this._makeSpan(start)));

    case (112):

      this._eat((112));
      return this._makeLiteral(Value.fromBool(true, this._makeSpan(start)));

    case (98):

      this._eat((98));
      return this._makeLiteral(Value.fromBool(false, this._makeSpan(start)));

    case (61):

      var t = this._lang_next();
      return this._makeLiteral(Value.fromInt(t.get$value(), t.get$span()));

    case (60):

      var t = this._lang_next();
      return this._makeLiteral(Value.fromInt(Math.parseInt(t.get$text()), t.get$span()));

    case (62):

      var t = this._lang_next();
      return this._makeLiteral(Value.fromDouble(Math.parseDouble(t.get$text()), t.get$span()));

    case (58):

      var t = this._lang_next();
      return this._makeLiteral(Value.fromString(t.get$value(), t.get$span()));

    case (59):

      return this.stringInterpolation();

    case (52):

      return this.finishTypedLiteral(start, false);

    case (115):
    case (114):
    case (99):

      return this.declaredIdentifier(false);

    default:

      if (!this._peekIdentifier()) {
        this._errorExpected("expression");
      }
      return new VarExpression(this.identifier(), this._makeSpan(start));

  }
}
Parser.prototype.stringInterpolation = function() {
  var start = this._peekToken.start;
  var pieces = new Array();
  var startQuote = null, endQuote = null;
  while (this._peekKind((59))) {
    var token = this._lang_next();
    pieces.add$1(this._makeLiteral(Value.fromString(token.get$value(), token.get$span())));
    if (this._maybeEat((6))) {
      pieces.add$1(this.expression());
      this._eat((7));
    }
    else if (this._maybeEat((110))) {
      pieces.add$1(new ThisExpression(this._previousToken.get$span()));
    }
    else {
      var id = this.identifier();
      pieces.add$1(new VarExpression(id, id.get$span()));
    }
  }
  var tok = this._lang_next();
  if ($ne(tok.get$kind(), (58))) {
    this._errorExpected("interpolated string");
  }
  pieces.add$1(this._makeLiteral(Value.fromString(tok.get$value(), tok.get$span())));
  var span = this._makeSpan(start);
  return new StringInterpExpression(pieces, span);
}
Parser.prototype.maybeStringLiteral = function() {
  var kind = this._peek();
  if ($eq(kind, (58))) {
    var t = this._lang_next();
    return t.get$value();
  }
  else if ($eq(kind, (59))) {
    this._lang_next();
    this._errorExpected("string literal, but found interpolated string start");
  }
  return null;
}
Parser.prototype._parenOrLambda = function() {
  var start = this._peekToken.start;
  if (this._atClosureParameters()) {
    var formals = this.formalParameterList();
    var body = this.functionBody(true);
    var func = new FunctionDefinition(null, null, null, formals, null, null, body, this._makeSpan(start));
    return new LambdaExpression(func, func.get$span());
  }
  else {
    this._eatLeftParen();
    var saved = this._inhibitLambda;
    this._inhibitLambda = false;
    var expr = this.expression();
    this._eat((3));
    this._inhibitLambda = saved;
    return new ParenExpression(expr, this._makeSpan(start));
  }
}
Parser.prototype._atClosureParameters = function() {
  if (this._inhibitLambda) return false;
  var after = this._peekAfterCloseParen();
  return after.kind == (9) || after.kind == (6);
}
Parser.prototype._eatLeftParen = function() {
  this._eat((2));
  this._afterParensIndex++;
}
Parser.prototype._peekAfterCloseParen = function() {
  if (this._afterParensIndex < this._afterParens.get$length()) {
    return this._afterParens.$index(this._afterParensIndex);
  }
  this._afterParensIndex = (0);
  this._afterParens.clear();
  var tokens = [this._lang_next()];
  this._lookaheadAfterParens(tokens);
  var after = this._peekToken;
  tokens.add$1(after);
  this.tokenizer = new DivertedTokenSource(tokens, this, this.tokenizer);
  this._lang_next();
  return after;
}
Parser.prototype._lookaheadAfterParens = function(tokens) {
  var saved = this._afterParens.get$length();
  this._afterParens.add(null);
  while (true) {
    var token = this._lang_next();
    tokens.add(token);
    var kind = token.kind;
    if (kind == (3) || kind == (1)) {
      this._afterParens.$setindex(saved, this._peekToken);
      return;
    }
    else if (kind == (2)) {
      this._lookaheadAfterParens(tokens);
    }
  }
}
Parser.prototype._typeAsIdentifier = function(type) {
  if ($eq(type.get$name().get$name(), "void")) {
    this._errorExpected(("identifer, but found \"" + type.get$name().get$name() + "\""));
  }
  return type.get$name();
}
Parser.prototype._specialIdentifier = function(includeOperators) {
  var start = this._peekToken.start;
  var name;
  switch (this._peek()) {
    case (15):

      this._eat((15));
      this._lang_error("rest no longer supported", this._previousToken.get$span());
      name = this.identifier().get$name();
      break;

    case (110):

      this._eat((110));
      this._eat((14));
      name = ("this." + this.identifier().get$name());
      break;

    case (75):

      if (!includeOperators) return null;
      this._eat((75));
      if (this._peekIdentifier()) {
        name = ("get:" + this.identifier().get$name());
      }
      else {
        name = "get";
      }
      break;

    case (83):

      if (!includeOperators) return null;
      this._eat((83));
      if (this._peekIdentifier()) {
        name = ("set:" + this.identifier().get$name());
      }
      else {
        name = "set";
      }
      break;

    case (82):

      if (!includeOperators) return null;
      this._eat((82));
      var kind = this._peek();
      if ($eq(kind, (81))) {
        name = ":negate";
        this._lang_next();
      }
      else {
        name = TokenKind.binaryMethodName(kind);
        if (name == null) {
          name = "operator";
        }
        else {
          this._lang_next();
        }
      }
      break;

    default:

      return null;

  }
  return new Identifier(name, this._makeSpan(start));
}
Parser.prototype.declaredIdentifier = function(includeOperators) {
  var start = this._peekToken.start;
  var myType = null;
  var name = this._specialIdentifier(includeOperators);
  if (name == null) {
    myType = this.type((0));
    name = this._specialIdentifier(includeOperators);
    if (name == null) {
      if (this._peekIdentifier()) {
        name = this.identifier();
      }
      else if ((myType instanceof NameTypeReference) && myType.get$names() == null) {
        name = this._typeAsIdentifier(myType);
        myType = null;
      }
      else {
      }
    }
  }
  return new DeclaredIdentifier(myType, name, this._makeSpan(start));
}
Parser.prototype.finishNewExpression = function(start, isConst) {
  var type = this.type((0));
  var name = null;
  if (this._maybeEat((14))) {
    name = this.identifier();
  }
  var args = this.arguments();
  return new NewExpression(isConst, type, name, args, this._makeSpan(start));
}
Parser.prototype.finishListLiteral = function(start, isConst, itemType) {
  if (this._maybeEat((56))) {
    return new ListExpression(isConst, itemType, [], this._makeSpan(start));
  }
  var values = [];
  this._eat((4));
  while (!this._maybeEat((5))) {
    values.add$1(this.expression());
    if (this._recover && !this._recoverTo((5), (11))) break;
    if (!this._maybeEat((11))) {
      this._eat((5));
      break;
    }
  }
  return new ListExpression(isConst, itemType, values, this._makeSpan(start));
}
Parser.prototype.finishMapLiteral = function(start, isConst, keyType, valueType) {
  var items = [];
  this._eat((6));
  while (!this._maybeEat((7))) {
    items.add$1(this.expression());
    this._eat((8));
    items.add$1(this.expression());
    if (this._recover && !this._recoverTo((7), (11))) break;
    if (!this._maybeEat((11))) {
      this._eat((7));
      break;
    }
  }
  return new MapExpression(isConst, keyType, valueType, items, this._makeSpan(start));
}
Parser.prototype.finishTypedLiteral = function(start, isConst) {
  var span = this._makeSpan(start);
  var typeToBeNamedLater = new NameTypeReference(false, null, null, span);
  var genericType = this.addTypeArguments(typeToBeNamedLater, (0));
  var typeArgs = genericType.get$typeArguments();
  if (this._peekKind((4)) || this._peekKind((56))) {
    if ($ne(typeArgs.get$length(), (1))) {
      $globals.world.error("exactly one type argument expected for list", genericType.get$span());
    }
    return this.finishListLiteral(start, isConst, typeArgs.$index((0)));
  }
  else if (this._peekKind((6))) {
    var keyType, valueType;
    if ($eq(typeArgs.get$length(), (1))) {
      keyType = null;
      valueType = typeArgs.$index((0));
    }
    else if ($eq(typeArgs.get$length(), (2))) {
      var keyType0 = typeArgs.$index((0));
      $globals.world.warning("a map literal takes one type argument specifying the value type", keyType0.get$span());
      valueType = typeArgs.$index((1));
    }
    return this.finishMapLiteral(start, isConst, keyType, valueType);
  }
  else {
    this._errorExpected("array or map literal");
  }
}
Parser.prototype._readModifiers = function() {
  var modifiers = null;
  while (true) {
    switch (this._peek()) {
      case (85):
      case (99):
      case (92):
      case (71):
      case (74):

        if (modifiers == null) modifiers = [];
        modifiers.add$1(this._lang_next());
        break;

      default:

        return modifiers;

    }
  }
  return null;
}
Parser.prototype.typeParameter = function() {
  var start = this._peekToken.start;
  var name = this.identifier();
  var myType = null;
  if (this._maybeEat((97))) {
    myType = this.type((1));
  }
  var tp = new TypeParameter(name, myType, this._makeSpan(start));
  return new ParameterType(name.get$name(), tp);
}
Parser.prototype.get$typeParameter = function() {
  return this.typeParameter.bind(this);
}
Parser.prototype.typeParameters = function() {
  this._eat((52));
  var closed = false;
  var ret = [];
  do {
    var tp = this.typeParameter();
    ret.add$1(tp);
    if ((tp.get$typeParameter().get$extendsType() instanceof GenericTypeReference) && $eq(tp.get$typeParameter().get$extendsType().get$dynamic().get$depth(), (0))) {
      closed = true;
      break;
    }
  }
  while (this._maybeEat((11)))
  if (!closed) {
    this._eat((53));
  }
  return ret;
}
Parser.prototype.get$typeParameters = function() {
  return this.typeParameters.bind(this);
}
Parser.prototype._eatClosingAngle = function(depth) {
  if (this._maybeEat((53))) {
    return depth;
  }
  else if (depth > (0) && this._maybeEat((40))) {
    return depth - (1);
  }
  else if (depth > (1) && this._maybeEat((41))) {
    return depth - (2);
  }
  else {
    this._errorExpected(">");
    return depth;
  }
}
Parser.prototype.addTypeArguments = function(baseType, depth) {
  this._eat((52));
  return this._finishTypeArguments(baseType, depth, []);
}
Parser.prototype._finishTypeArguments = function(baseType, depth, types) {
  var delta = (-1);
  do {
    var myType = this.type(depth + (1));
    types.add$1(myType);
    if ((myType instanceof GenericTypeReference) && myType.get$depth() <= depth) {
      delta = depth - myType.get$depth();
      break;
    }
  }
  while (this._maybeEat((11)))
  if (delta >= (0)) {
    depth = depth - delta;
  }
  else {
    depth = this._eatClosingAngle(depth);
  }
  var span = this._makeSpan(baseType.span.start);
  return new GenericTypeReference(baseType, types, depth, span);
}
Parser.prototype.typeList = function() {
  var types = [];
  do {
    types.add$1(this.type((0)));
  }
  while (this._maybeEat((11)))
  return types;
}
Parser.prototype.nameTypeReference = function() {
  var start = this._peekToken.start;
  var name;
  var names = null;
  var typeArgs = null;
  var isFinal = false;
  switch (this._peek()) {
    case (115):

      return new TypeReference(this._lang_next().get$span(), $globals.world.voidType);

    case (114):

      return new TypeReference(this._lang_next().get$span(), $globals.world.varType);

    case (99):

      this._eat((99));
      isFinal = true;
      name = this.identifier();
      break;

    default:

      name = this.identifier();
      break;

  }
  while (this._maybeEat((14))) {
    if (names == null) names = [];
    names.add$1(this.identifier());
  }
  return new NameTypeReference(isFinal, name, names, this._makeSpan(start));
}
Parser.prototype.type = function(depth) {
  var typeRef = this.nameTypeReference();
  if (this._peekKind((52))) {
    return this.addTypeArguments(typeRef, depth);
  }
  else {
    return typeRef;
  }
}
Parser.prototype.type.$optional = ['depth', '(0)']
Parser.prototype.get$type = function() {
  return this.type.bind(this);
}
Parser.prototype.formalParameter = function(inOptionalBlock) {
  var start = this._peekToken.start;
  var isThis = false;
  var isRest = false;
  var di = this.declaredIdentifier(false);
  var type = di.get$type();
  var name = di.get$name();
  if (name == null) {
    this._lang_error("Formal parameter invalid", this._makeSpan(start));
  }
  var value = null;
  if (this._maybeEat((20))) {
    if (!inOptionalBlock) {
      this._lang_error("default values only allowed inside [optional] section");
    }
    value = this.expression();
  }
  else if (this._peekKind((2))) {
    var formals = this.formalParameterList();
    var func = new FunctionDefinition(null, type, name, formals, null, null, null, this._makeSpan(start));
    type = new FunctionTypeReference(false, func, func.get$span());
  }
  if (inOptionalBlock && value == null) {
    value = this._makeLiteral(Value.fromNull(this._makeSpan(start)));
  }
  return new FormalNode(isThis, isRest, type, name, value, this._makeSpan(start));
}
Parser.prototype.formalParameterList = function() {
  this._eatLeftParen();
  var formals = [];
  var inOptionalBlock = false;
  if (!this._maybeEat((3))) {
    if (this._maybeEat((4))) {
      inOptionalBlock = true;
    }
    formals.add$1(this.formalParameter(inOptionalBlock));
    while (this._maybeEat((11))) {
      if (this._maybeEat((4))) {
        if (inOptionalBlock) {
          this._lang_error("already inside an optional block", this._previousToken.get$span());
        }
        inOptionalBlock = true;
      }
      formals.add$1(this.formalParameter(inOptionalBlock));
    }
    if (inOptionalBlock) {
      this._eat((5));
    }
    this._eat((3));
  }
  return formals;
}
Parser.prototype.identifierForType = function() {
  var tok = this._lang_next();
  if (!this._isIdentifier(tok.get$kind())) {
    this._lang_error(("expected identifier, but found " + tok), tok.get$span());
  }
  if (tok.get$kind() != (70) && $ne(tok.get$kind(), (80))) {
    this._lang_error(("" + tok + " may not be used as a type name"), tok.get$span());
  }
  return new Identifier(tok.get$text(), this._makeSpan(tok.get$start()));
}
Parser.prototype.identifier = function() {
  var tok = this._lang_next();
  if (!this._isIdentifier(tok.get$kind())) {
    this._lang_error(("expected identifier, but found " + tok), tok.get$span());
  }
  return new Identifier(tok.get$text(), this._makeSpan(tok.get$start()));
}
Parser.prototype._makeFunction = function(expr, formals, body) {
  var name, type;
  if ((expr instanceof VarExpression)) {
    name = expr.get$name();
    type = null;
  }
  else if ((expr instanceof DeclaredIdentifier)) {
    name = expr.get$name();
    type = expr.get$type();
    if (name == null) {
      this._lang_error("expected name and type", expr.get$span());
    }
  }
  else {
    this._lang_error("bad function body", expr.get$span());
  }
  var span = new SourceSpan(expr.get$span().get$file(), expr.get$span().get$start(), body.get$span().get$end());
  var func = new FunctionDefinition(null, type, name, formals, null, null, body, span);
  return new LambdaExpression(func, func.get$span());
}
Parser.prototype._makeDeclaredIdentifier = function(e) {
  if ((e instanceof VarExpression)) {
    return new DeclaredIdentifier(null, e.get$name(), e.get$span());
  }
  else if ((e instanceof DeclaredIdentifier)) {
    return e;
  }
  else {
    this._lang_error("expected declared identifier");
    return new DeclaredIdentifier(null, null, e.get$span());
  }
}
Parser.prototype._makeLabel = function(expr) {
  if ((expr instanceof VarExpression)) {
    return expr.get$name();
  }
  else {
    this._errorExpected("label");
    return null;
  }
}
Parser.prototype.block$0 = Parser.prototype.block;
Parser.prototype.compilationUnit$0 = Parser.prototype.compilationUnit;
// ********** Code for IncompleteSourceException **************
function IncompleteSourceException(token) {
  this.token = token;
}
IncompleteSourceException.prototype.toString = function() {
  if (this.token.get$span() == null) return ("Unexpected " + this.token);
  return this.token.get$span().toMessageString(("Unexpected " + this.token));
}
IncompleteSourceException.prototype.toString$0 = IncompleteSourceException.prototype.toString;
// ********** Code for DivertedTokenSource **************
function DivertedTokenSource(tokens, parser, previousTokenizer) {
  this.parser = parser;
  this._lang_pos = (0);
  this.tokens = tokens;
  this.previousTokenizer = previousTokenizer;
}
DivertedTokenSource.prototype.next = function() {
  var token = this.tokens.$index(this._lang_pos);
  ++this._lang_pos;
  if (this._lang_pos == this.tokens.get$length()) {
    this.parser.tokenizer = this.previousTokenizer;
  }
  return token;
}
DivertedTokenSource.prototype.next$0 = DivertedTokenSource.prototype.next;
// ********** Code for Node **************
function Node(span) {
  this.span = span;
}
Node.prototype.get$span = function() { return this.span; };
Node.prototype.set$span = function(value) { return this.span = value; };
Node.prototype.visit$1 = Node.prototype.visit;
// ********** Code for Statement **************
$inherits(Statement, Node);
function Statement(span) {
  Node.call(this, span);
}
// ********** Code for Definition **************
$inherits(Definition, Statement);
function Definition(span) {
  Statement.call(this, span);
}
Definition.prototype.get$typeParameters = function() {
  return null;
}
Definition.prototype.get$nativeType = function() {
  return null;
}
// ********** Code for Expression **************
$inherits(Expression, Node);
function Expression(span) {
  Node.call(this, span);
}
// ********** Code for TypeReference **************
$inherits(TypeReference, Node);
function TypeReference(span, type) {
  this.type = type;
  Node.call(this, span);
}
TypeReference.prototype.get$type = function() { return this.type; };
TypeReference.prototype.set$type = function(value) { return this.type = value; };
TypeReference.prototype.visit = function(visitor) {
  return visitor.visitTypeReference(this);
}
TypeReference.prototype.get$isFinal = function() {
  return false;
}
TypeReference.prototype.visit$1 = TypeReference.prototype.visit;
// ********** Code for DirectiveDefinition **************
$inherits(DirectiveDefinition, Definition);
function DirectiveDefinition(name, arguments, span) {
  this.arguments = arguments;
  this.name = name;
  Definition.call(this, span);
}
DirectiveDefinition.prototype.get$name = function() { return this.name; };
DirectiveDefinition.prototype.set$name = function(value) { return this.name = value; };
DirectiveDefinition.prototype.visit = function(visitor) {
  return visitor.visitDirectiveDefinition(this);
}
DirectiveDefinition.prototype.visit$1 = DirectiveDefinition.prototype.visit;
// ********** Code for TypeDefinition **************
$inherits(TypeDefinition, Definition);
function TypeDefinition(isClass, name, typeParameters, extendsTypes, implementsTypes, nativeType, defaultType, body, span) {
  this.extendsTypes = extendsTypes;
  this.isClass = isClass;
  this.name = name;
  this.body = body;
  this.typeParameters = typeParameters;
  this.nativeType = nativeType;
  this.implementsTypes = implementsTypes;
  this.defaultType = defaultType;
  Definition.call(this, span);
}
TypeDefinition.prototype.get$isClass = function() { return this.isClass; };
TypeDefinition.prototype.set$isClass = function(value) { return this.isClass = value; };
TypeDefinition.prototype.get$name = function() { return this.name; };
TypeDefinition.prototype.set$name = function(value) { return this.name = value; };
TypeDefinition.prototype.get$typeParameters = function() { return this.typeParameters; };
TypeDefinition.prototype.set$typeParameters = function(value) { return this.typeParameters = value; };
TypeDefinition.prototype.get$nativeType = function() { return this.nativeType; };
TypeDefinition.prototype.set$nativeType = function(value) { return this.nativeType = value; };
TypeDefinition.prototype.get$body = function() { return this.body; };
TypeDefinition.prototype.set$body = function(value) { return this.body = value; };
TypeDefinition.prototype.visit = function(visitor) {
  return visitor.visitTypeDefinition(this);
}
TypeDefinition.prototype.visit$1 = TypeDefinition.prototype.visit;
// ********** Code for FunctionTypeDefinition **************
$inherits(FunctionTypeDefinition, Definition);
function FunctionTypeDefinition(func, typeParameters, span) {
  this.typeParameters = typeParameters;
  this.func = func;
  Definition.call(this, span);
}
FunctionTypeDefinition.prototype.get$func = function() { return this.func; };
FunctionTypeDefinition.prototype.set$func = function(value) { return this.func = value; };
FunctionTypeDefinition.prototype.get$typeParameters = function() { return this.typeParameters; };
FunctionTypeDefinition.prototype.set$typeParameters = function(value) { return this.typeParameters = value; };
FunctionTypeDefinition.prototype.visit = function(visitor) {
  return visitor.visitFunctionTypeDefinition(this);
}
FunctionTypeDefinition.prototype.visit$1 = FunctionTypeDefinition.prototype.visit;
// ********** Code for VariableDefinition **************
$inherits(VariableDefinition, Definition);
function VariableDefinition(modifiers, type, names, values, span) {
  this.modifiers = modifiers;
  this.type = type;
  this.names = names;
  this.values = values;
  Definition.call(this, span);
}
VariableDefinition.prototype.get$type = function() { return this.type; };
VariableDefinition.prototype.set$type = function(value) { return this.type = value; };
VariableDefinition.prototype.get$names = function() { return this.names; };
VariableDefinition.prototype.set$names = function(value) { return this.names = value; };
VariableDefinition.prototype.visit = function(visitor) {
  return visitor.visitVariableDefinition(this);
}
VariableDefinition.prototype.visit$1 = VariableDefinition.prototype.visit;
// ********** Code for FunctionDefinition **************
$inherits(FunctionDefinition, Definition);
function FunctionDefinition(modifiers, returnType, name, formals, initializers, nativeBody, body, span) {
  this.modifiers = modifiers;
  this.name = name;
  this.initializers = initializers;
  this.body = body;
  this.returnType = returnType;
  this.formals = formals;
  this.nativeBody = nativeBody;
  Definition.call(this, span);
}
FunctionDefinition.prototype.get$returnType = function() { return this.returnType; };
FunctionDefinition.prototype.set$returnType = function(value) { return this.returnType = value; };
FunctionDefinition.prototype.get$name = function() { return this.name; };
FunctionDefinition.prototype.set$name = function(value) { return this.name = value; };
FunctionDefinition.prototype.get$initializers = function() { return this.initializers; };
FunctionDefinition.prototype.set$initializers = function(value) { return this.initializers = value; };
FunctionDefinition.prototype.get$nativeBody = function() { return this.nativeBody; };
FunctionDefinition.prototype.set$nativeBody = function(value) { return this.nativeBody = value; };
FunctionDefinition.prototype.get$body = function() { return this.body; };
FunctionDefinition.prototype.set$body = function(value) { return this.body = value; };
FunctionDefinition.prototype.visit = function(visitor) {
  return visitor.visitFunctionDefinition(this);
}
FunctionDefinition.prototype.visit$1 = FunctionDefinition.prototype.visit;
// ********** Code for ReturnStatement **************
$inherits(ReturnStatement, Statement);
function ReturnStatement(value, span) {
  this.value = value;
  Statement.call(this, span);
}
ReturnStatement.prototype.get$value = function() { return this.value; };
ReturnStatement.prototype.set$value = function(value) { return this.value = value; };
ReturnStatement.prototype.visit = function(visitor) {
  return visitor.visitReturnStatement(this);
}
ReturnStatement.prototype.visit$1 = ReturnStatement.prototype.visit;
// ********** Code for ThrowStatement **************
$inherits(ThrowStatement, Statement);
function ThrowStatement(value, span) {
  this.value = value;
  Statement.call(this, span);
}
ThrowStatement.prototype.get$value = function() { return this.value; };
ThrowStatement.prototype.set$value = function(value) { return this.value = value; };
ThrowStatement.prototype.visit = function(visitor) {
  return visitor.visitThrowStatement(this);
}
ThrowStatement.prototype.visit$1 = ThrowStatement.prototype.visit;
// ********** Code for AssertStatement **************
$inherits(AssertStatement, Statement);
function AssertStatement(test, span) {
  this.test = test;
  Statement.call(this, span);
}
AssertStatement.prototype.visit = function(visitor) {
  return visitor.visitAssertStatement(this);
}
AssertStatement.prototype.visit$1 = AssertStatement.prototype.visit;
// ********** Code for BreakStatement **************
$inherits(BreakStatement, Statement);
function BreakStatement(label, span) {
  this.label = label;
  Statement.call(this, span);
}
BreakStatement.prototype.get$label = function() { return this.label; };
BreakStatement.prototype.set$label = function(value) { return this.label = value; };
BreakStatement.prototype.visit = function(visitor) {
  return visitor.visitBreakStatement(this);
}
BreakStatement.prototype.visit$1 = BreakStatement.prototype.visit;
// ********** Code for ContinueStatement **************
$inherits(ContinueStatement, Statement);
function ContinueStatement(label, span) {
  this.label = label;
  Statement.call(this, span);
}
ContinueStatement.prototype.get$label = function() { return this.label; };
ContinueStatement.prototype.set$label = function(value) { return this.label = value; };
ContinueStatement.prototype.visit = function(visitor) {
  return visitor.visitContinueStatement(this);
}
ContinueStatement.prototype.visit$1 = ContinueStatement.prototype.visit;
// ********** Code for IfStatement **************
$inherits(IfStatement, Statement);
function IfStatement(test, trueBranch, falseBranch, span) {
  this.test = test;
  this.falseBranch = falseBranch;
  this.trueBranch = trueBranch;
  Statement.call(this, span);
}
IfStatement.prototype.visit = function(visitor) {
  return visitor.visitIfStatement(this);
}
IfStatement.prototype.visit$1 = IfStatement.prototype.visit;
// ********** Code for WhileStatement **************
$inherits(WhileStatement, Statement);
function WhileStatement(test, body, span) {
  this.body = body;
  this.test = test;
  Statement.call(this, span);
}
WhileStatement.prototype.get$body = function() { return this.body; };
WhileStatement.prototype.set$body = function(value) { return this.body = value; };
WhileStatement.prototype.visit = function(visitor) {
  return visitor.visitWhileStatement(this);
}
WhileStatement.prototype.visit$1 = WhileStatement.prototype.visit;
// ********** Code for DoStatement **************
$inherits(DoStatement, Statement);
function DoStatement(body, test, span) {
  this.body = body;
  this.test = test;
  Statement.call(this, span);
}
DoStatement.prototype.get$body = function() { return this.body; };
DoStatement.prototype.set$body = function(value) { return this.body = value; };
DoStatement.prototype.visit = function(visitor) {
  return visitor.visitDoStatement(this);
}
DoStatement.prototype.visit$1 = DoStatement.prototype.visit;
// ********** Code for ForStatement **************
$inherits(ForStatement, Statement);
function ForStatement(init, test, step, body, span) {
  this.body = body;
  this.test = test;
  this.step = step;
  this.init = init;
  Statement.call(this, span);
}
ForStatement.prototype.get$body = function() { return this.body; };
ForStatement.prototype.set$body = function(value) { return this.body = value; };
ForStatement.prototype.visit = function(visitor) {
  return visitor.visitForStatement(this);
}
ForStatement.prototype.visit$1 = ForStatement.prototype.visit;
// ********** Code for ForInStatement **************
$inherits(ForInStatement, Statement);
function ForInStatement(item, list, body, span) {
  this.body = body;
  this.item = item;
  this.list = list;
  Statement.call(this, span);
}
ForInStatement.prototype.get$body = function() { return this.body; };
ForInStatement.prototype.set$body = function(value) { return this.body = value; };
ForInStatement.prototype.visit = function(visitor) {
  return visitor.visitForInStatement(this);
}
ForInStatement.prototype.visit$1 = ForInStatement.prototype.visit;
// ********** Code for TryStatement **************
$inherits(TryStatement, Statement);
function TryStatement(body, catches, finallyBlock, span) {
  this.body = body;
  this.finallyBlock = finallyBlock;
  this.catches = catches;
  Statement.call(this, span);
}
TryStatement.prototype.get$body = function() { return this.body; };
TryStatement.prototype.set$body = function(value) { return this.body = value; };
TryStatement.prototype.visit = function(visitor) {
  return visitor.visitTryStatement(this);
}
TryStatement.prototype.visit$1 = TryStatement.prototype.visit;
// ********** Code for SwitchStatement **************
$inherits(SwitchStatement, Statement);
function SwitchStatement(test, cases, span) {
  this.test = test;
  this.cases = cases;
  Statement.call(this, span);
}
SwitchStatement.prototype.get$cases = function() { return this.cases; };
SwitchStatement.prototype.set$cases = function(value) { return this.cases = value; };
SwitchStatement.prototype.visit = function(visitor) {
  return visitor.visitSwitchStatement(this);
}
SwitchStatement.prototype.visit$1 = SwitchStatement.prototype.visit;
// ********** Code for BlockStatement **************
$inherits(BlockStatement, Statement);
function BlockStatement(body, span) {
  this.body = body;
  Statement.call(this, span);
}
BlockStatement.prototype.get$body = function() { return this.body; };
BlockStatement.prototype.set$body = function(value) { return this.body = value; };
BlockStatement.prototype.visit = function(visitor) {
  return visitor.visitBlockStatement(this);
}
BlockStatement.prototype.visit$1 = BlockStatement.prototype.visit;
// ********** Code for LabeledStatement **************
$inherits(LabeledStatement, Statement);
function LabeledStatement(name, body, span) {
  this.body = body;
  this.name = name;
  Statement.call(this, span);
}
LabeledStatement.prototype.get$name = function() { return this.name; };
LabeledStatement.prototype.set$name = function(value) { return this.name = value; };
LabeledStatement.prototype.get$body = function() { return this.body; };
LabeledStatement.prototype.set$body = function(value) { return this.body = value; };
LabeledStatement.prototype.visit = function(visitor) {
  return visitor.visitLabeledStatement(this);
}
LabeledStatement.prototype.visit$1 = LabeledStatement.prototype.visit;
// ********** Code for ExpressionStatement **************
$inherits(ExpressionStatement, Statement);
function ExpressionStatement(body, span) {
  this.body = body;
  Statement.call(this, span);
}
ExpressionStatement.prototype.get$body = function() { return this.body; };
ExpressionStatement.prototype.set$body = function(value) { return this.body = value; };
ExpressionStatement.prototype.visit = function(visitor) {
  return visitor.visitExpressionStatement(this);
}
ExpressionStatement.prototype.visit$1 = ExpressionStatement.prototype.visit;
// ********** Code for EmptyStatement **************
$inherits(EmptyStatement, Statement);
function EmptyStatement(span) {
  Statement.call(this, span);
}
EmptyStatement.prototype.visit = function(visitor) {
  return visitor.visitEmptyStatement(this);
}
EmptyStatement.prototype.visit$1 = EmptyStatement.prototype.visit;
// ********** Code for DietStatement **************
$inherits(DietStatement, Statement);
function DietStatement(span) {
  Statement.call(this, span);
}
DietStatement.prototype.visit = function(visitor) {
  return visitor.visitDietStatement(this);
}
DietStatement.prototype.visit$1 = DietStatement.prototype.visit;
// ********** Code for LambdaExpression **************
$inherits(LambdaExpression, Expression);
function LambdaExpression(func, span) {
  this.func = func;
  Expression.call(this, span);
}
LambdaExpression.prototype.get$func = function() { return this.func; };
LambdaExpression.prototype.set$func = function(value) { return this.func = value; };
LambdaExpression.prototype.visit = function(visitor) {
  return visitor.visitLambdaExpression(this);
}
LambdaExpression.prototype.visit$1 = LambdaExpression.prototype.visit;
// ********** Code for CallExpression **************
$inherits(CallExpression, Expression);
function CallExpression(target, arguments, span) {
  this.target = target;
  this.arguments = arguments;
  Expression.call(this, span);
}
CallExpression.prototype.visit = function(visitor) {
  return visitor.visitCallExpression(this);
}
CallExpression.prototype.visit$1 = CallExpression.prototype.visit;
// ********** Code for IndexExpression **************
$inherits(IndexExpression, Expression);
function IndexExpression(target, index, span) {
  this.target = target;
  this.index = index;
  Expression.call(this, span);
}
IndexExpression.prototype.visit = function(visitor) {
  return visitor.visitIndexExpression(this);
}
IndexExpression.prototype.visit$1 = IndexExpression.prototype.visit;
// ********** Code for BinaryExpression **************
$inherits(BinaryExpression, Expression);
function BinaryExpression(op, x, y, span) {
  this.y = y;
  this.x = x;
  this.op = op;
  Expression.call(this, span);
}
BinaryExpression.prototype.get$op = function() { return this.op; };
BinaryExpression.prototype.set$op = function(value) { return this.op = value; };
BinaryExpression.prototype.get$x = function() { return this.x; };
BinaryExpression.prototype.set$x = function(value) { return this.x = value; };
BinaryExpression.prototype.get$y = function() { return this.y; };
BinaryExpression.prototype.set$y = function(value) { return this.y = value; };
BinaryExpression.prototype.visit = function(visitor) {
  return visitor.visitBinaryExpression$1(this);
}
BinaryExpression.prototype.visit$1 = BinaryExpression.prototype.visit;
// ********** Code for UnaryExpression **************
$inherits(UnaryExpression, Expression);
function UnaryExpression(op, self, span) {
  this.self = self;
  this.op = op;
  Expression.call(this, span);
}
UnaryExpression.prototype.get$op = function() { return this.op; };
UnaryExpression.prototype.set$op = function(value) { return this.op = value; };
UnaryExpression.prototype.get$self = function() { return this.self; };
UnaryExpression.prototype.set$self = function(value) { return this.self = value; };
UnaryExpression.prototype.visit = function(visitor) {
  return visitor.visitUnaryExpression(this);
}
UnaryExpression.prototype.visit$1 = UnaryExpression.prototype.visit;
// ********** Code for PostfixExpression **************
$inherits(PostfixExpression, Expression);
function PostfixExpression(body, op, span) {
  this.body = body;
  this.op = op;
  Expression.call(this, span);
}
PostfixExpression.prototype.get$body = function() { return this.body; };
PostfixExpression.prototype.set$body = function(value) { return this.body = value; };
PostfixExpression.prototype.get$op = function() { return this.op; };
PostfixExpression.prototype.set$op = function(value) { return this.op = value; };
PostfixExpression.prototype.visit = function(visitor) {
  return visitor.visitPostfixExpression$1(this);
}
PostfixExpression.prototype.visit$1 = PostfixExpression.prototype.visit;
// ********** Code for NewExpression **************
$inherits(NewExpression, Expression);
function NewExpression(isConst, type, name, arguments, span) {
  this.arguments = arguments;
  this.name = name;
  this.type = type;
  this.isConst = isConst;
  Expression.call(this, span);
}
NewExpression.prototype.get$isConst = function() { return this.isConst; };
NewExpression.prototype.set$isConst = function(value) { return this.isConst = value; };
NewExpression.prototype.get$type = function() { return this.type; };
NewExpression.prototype.set$type = function(value) { return this.type = value; };
NewExpression.prototype.get$name = function() { return this.name; };
NewExpression.prototype.set$name = function(value) { return this.name = value; };
NewExpression.prototype.visit = function(visitor) {
  return visitor.visitNewExpression(this);
}
NewExpression.prototype.visit$1 = NewExpression.prototype.visit;
// ********** Code for ListExpression **************
$inherits(ListExpression, Expression);
function ListExpression(isConst, itemType, values, span) {
  this.itemType = itemType;
  this.isConst = isConst;
  this.values = values;
  Expression.call(this, span);
}
ListExpression.prototype.get$isConst = function() { return this.isConst; };
ListExpression.prototype.set$isConst = function(value) { return this.isConst = value; };
ListExpression.prototype.visit = function(visitor) {
  return visitor.visitListExpression(this);
}
ListExpression.prototype.visit$1 = ListExpression.prototype.visit;
// ********** Code for MapExpression **************
$inherits(MapExpression, Expression);
function MapExpression(isConst, keyType, valueType, items, span) {
  this.keyType = keyType;
  this.valueType = valueType;
  this.items = items;
  this.isConst = isConst;
  Expression.call(this, span);
}
MapExpression.prototype.get$isConst = function() { return this.isConst; };
MapExpression.prototype.set$isConst = function(value) { return this.isConst = value; };
MapExpression.prototype.visit = function(visitor) {
  return visitor.visitMapExpression(this);
}
MapExpression.prototype.visit$1 = MapExpression.prototype.visit;
// ********** Code for ConditionalExpression **************
$inherits(ConditionalExpression, Expression);
function ConditionalExpression(test, trueBranch, falseBranch, span) {
  this.test = test;
  this.falseBranch = falseBranch;
  this.trueBranch = trueBranch;
  Expression.call(this, span);
}
ConditionalExpression.prototype.visit = function(visitor) {
  return visitor.visitConditionalExpression(this);
}
ConditionalExpression.prototype.visit$1 = ConditionalExpression.prototype.visit;
// ********** Code for IsExpression **************
$inherits(IsExpression, Expression);
function IsExpression(isTrue, x, type, span) {
  this.isTrue = isTrue;
  this.x = x;
  this.type = type;
  Expression.call(this, span);
}
IsExpression.prototype.get$x = function() { return this.x; };
IsExpression.prototype.set$x = function(value) { return this.x = value; };
IsExpression.prototype.get$type = function() { return this.type; };
IsExpression.prototype.set$type = function(value) { return this.type = value; };
IsExpression.prototype.visit = function(visitor) {
  return visitor.visitIsExpression(this);
}
IsExpression.prototype.visit$1 = IsExpression.prototype.visit;
// ********** Code for ParenExpression **************
$inherits(ParenExpression, Expression);
function ParenExpression(body, span) {
  this.body = body;
  Expression.call(this, span);
}
ParenExpression.prototype.get$body = function() { return this.body; };
ParenExpression.prototype.set$body = function(value) { return this.body = value; };
ParenExpression.prototype.visit = function(visitor) {
  return visitor.visitParenExpression(this);
}
ParenExpression.prototype.visit$1 = ParenExpression.prototype.visit;
// ********** Code for AwaitExpression **************
$inherits(AwaitExpression, Expression);
function AwaitExpression(body, span) {
  this.body = body;
  Expression.call(this, span);
}
AwaitExpression.prototype.get$body = function() { return this.body; };
AwaitExpression.prototype.set$body = function(value) { return this.body = value; };
AwaitExpression.prototype.visit = function(visitor) {
  return visitor.visitAwaitExpression(this);
}
AwaitExpression.prototype.visit$1 = AwaitExpression.prototype.visit;
// ********** Code for DotExpression **************
$inherits(DotExpression, Expression);
function DotExpression(self, name, span) {
  this.self = self;
  this.name = name;
  Expression.call(this, span);
}
DotExpression.prototype.get$self = function() { return this.self; };
DotExpression.prototype.set$self = function(value) { return this.self = value; };
DotExpression.prototype.get$name = function() { return this.name; };
DotExpression.prototype.set$name = function(value) { return this.name = value; };
DotExpression.prototype.visit = function(visitor) {
  return visitor.visitDotExpression(this);
}
DotExpression.prototype.visit$1 = DotExpression.prototype.visit;
// ********** Code for VarExpression **************
$inherits(VarExpression, Expression);
function VarExpression(name, span) {
  this.name = name;
  Expression.call(this, span);
}
VarExpression.prototype.get$name = function() { return this.name; };
VarExpression.prototype.set$name = function(value) { return this.name = value; };
VarExpression.prototype.visit = function(visitor) {
  return visitor.visitVarExpression(this);
}
VarExpression.prototype.visit$1 = VarExpression.prototype.visit;
// ********** Code for ThisExpression **************
$inherits(ThisExpression, Expression);
function ThisExpression(span) {
  Expression.call(this, span);
}
ThisExpression.prototype.visit = function(visitor) {
  return visitor.visitThisExpression(this);
}
ThisExpression.prototype.visit$1 = ThisExpression.prototype.visit;
// ********** Code for SuperExpression **************
$inherits(SuperExpression, Expression);
function SuperExpression(span) {
  Expression.call(this, span);
}
SuperExpression.prototype.visit = function(visitor) {
  return visitor.visitSuperExpression(this);
}
SuperExpression.prototype.visit$1 = SuperExpression.prototype.visit;
// ********** Code for LiteralExpression **************
$inherits(LiteralExpression, Expression);
function LiteralExpression(value, span) {
  this.value = value;
  Expression.call(this, span);
}
LiteralExpression.prototype.get$value = function() { return this.value; };
LiteralExpression.prototype.set$value = function(value) { return this.value = value; };
LiteralExpression.prototype.visit = function(visitor) {
  return visitor.visitLiteralExpression(this);
}
LiteralExpression.prototype.visit$1 = LiteralExpression.prototype.visit;
// ********** Code for StringInterpExpression **************
$inherits(StringInterpExpression, Expression);
function StringInterpExpression(pieces, span) {
  this.pieces = pieces;
  Expression.call(this, span);
}
StringInterpExpression.prototype.visit = function(visitor) {
  return visitor.visitStringInterpExpression(this);
}
StringInterpExpression.prototype.visit$1 = StringInterpExpression.prototype.visit;
// ********** Code for NameTypeReference **************
$inherits(NameTypeReference, TypeReference);
function NameTypeReference(isFinal, name, names, span) {
  this.name = name;
  this.names = names;
  this.isFinal = isFinal;
  TypeReference.call(this, span);
}
NameTypeReference.prototype.get$isFinal = function() { return this.isFinal; };
NameTypeReference.prototype.set$isFinal = function(value) { return this.isFinal = value; };
NameTypeReference.prototype.get$name = function() { return this.name; };
NameTypeReference.prototype.set$name = function(value) { return this.name = value; };
NameTypeReference.prototype.get$names = function() { return this.names; };
NameTypeReference.prototype.set$names = function(value) { return this.names = value; };
NameTypeReference.prototype.visit = function(visitor) {
  return visitor.visitNameTypeReference(this);
}
NameTypeReference.prototype.visit$1 = NameTypeReference.prototype.visit;
// ********** Code for GenericTypeReference **************
$inherits(GenericTypeReference, TypeReference);
function GenericTypeReference(baseType, typeArguments, depth, span) {
  this.depth = depth;
  this.baseType = baseType;
  this.typeArguments = typeArguments;
  TypeReference.call(this, span);
}
GenericTypeReference.prototype.get$baseType = function() { return this.baseType; };
GenericTypeReference.prototype.set$baseType = function(value) { return this.baseType = value; };
GenericTypeReference.prototype.get$typeArguments = function() { return this.typeArguments; };
GenericTypeReference.prototype.set$typeArguments = function(value) { return this.typeArguments = value; };
GenericTypeReference.prototype.get$depth = function() { return this.depth; };
GenericTypeReference.prototype.set$depth = function(value) { return this.depth = value; };
GenericTypeReference.prototype.visit = function(visitor) {
  return visitor.visitGenericTypeReference(this);
}
GenericTypeReference.prototype.visit$1 = GenericTypeReference.prototype.visit;
// ********** Code for FunctionTypeReference **************
$inherits(FunctionTypeReference, TypeReference);
function FunctionTypeReference(isFinal, func, span) {
  this.func = func;
  this.isFinal = isFinal;
  TypeReference.call(this, span);
}
FunctionTypeReference.prototype.get$isFinal = function() { return this.isFinal; };
FunctionTypeReference.prototype.set$isFinal = function(value) { return this.isFinal = value; };
FunctionTypeReference.prototype.get$func = function() { return this.func; };
FunctionTypeReference.prototype.set$func = function(value) { return this.func = value; };
FunctionTypeReference.prototype.visit = function(visitor) {
  return visitor.visitFunctionTypeReference(this);
}
FunctionTypeReference.prototype.visit$1 = FunctionTypeReference.prototype.visit;
// ********** Code for DefaultTypeReference **************
$inherits(DefaultTypeReference, TypeReference);
function DefaultTypeReference(oldFactory, baseType, typeParameters, span) {
  this.typeParameters = typeParameters;
  this.oldFactory = oldFactory;
  this.baseType = baseType;
  TypeReference.call(this, span);
}
DefaultTypeReference.prototype.get$baseType = function() { return this.baseType; };
DefaultTypeReference.prototype.set$baseType = function(value) { return this.baseType = value; };
DefaultTypeReference.prototype.get$typeParameters = function() { return this.typeParameters; };
DefaultTypeReference.prototype.set$typeParameters = function(value) { return this.typeParameters = value; };
DefaultTypeReference.prototype.visit = function(visitor) {
  return visitor.visitDefaultTypeReference(this);
}
DefaultTypeReference.prototype.visit$1 = DefaultTypeReference.prototype.visit;
// ********** Code for ArgumentNode **************
$inherits(ArgumentNode, Node);
function ArgumentNode(label, value, span) {
  this.label = label;
  this.value = value;
  Node.call(this, span);
}
ArgumentNode.prototype.get$label = function() { return this.label; };
ArgumentNode.prototype.set$label = function(value) { return this.label = value; };
ArgumentNode.prototype.get$value = function() { return this.value; };
ArgumentNode.prototype.set$value = function(value) { return this.value = value; };
ArgumentNode.prototype.visit = function(visitor) {
  return visitor.visitArgumentNode(this);
}
ArgumentNode.prototype.visit$1 = ArgumentNode.prototype.visit;
// ********** Code for FormalNode **************
$inherits(FormalNode, Node);
function FormalNode(isThis, isRest, type, name, value, span) {
  this.name = name;
  this.isThis = isThis;
  this.type = type;
  this.isRest = isRest;
  this.value = value;
  Node.call(this, span);
}
FormalNode.prototype.get$type = function() { return this.type; };
FormalNode.prototype.set$type = function(value) { return this.type = value; };
FormalNode.prototype.get$name = function() { return this.name; };
FormalNode.prototype.set$name = function(value) { return this.name = value; };
FormalNode.prototype.get$value = function() { return this.value; };
FormalNode.prototype.set$value = function(value) { return this.value = value; };
FormalNode.prototype.visit = function(visitor) {
  return visitor.visitFormalNode(this);
}
FormalNode.prototype.visit$1 = FormalNode.prototype.visit;
// ********** Code for CatchNode **************
$inherits(CatchNode, Node);
function CatchNode(exception, trace, body, span) {
  this.body = body;
  this.exception = exception;
  this.trace = trace;
  Node.call(this, span);
}
CatchNode.prototype.get$exception = function() { return this.exception; };
CatchNode.prototype.set$exception = function(value) { return this.exception = value; };
CatchNode.prototype.get$trace = function() { return this.trace; };
CatchNode.prototype.set$trace = function(value) { return this.trace = value; };
CatchNode.prototype.get$body = function() { return this.body; };
CatchNode.prototype.set$body = function(value) { return this.body = value; };
CatchNode.prototype.visit = function(visitor) {
  return visitor.visitCatchNode(this);
}
CatchNode.prototype.visit$1 = CatchNode.prototype.visit;
// ********** Code for CaseNode **************
$inherits(CaseNode, Node);
function CaseNode(label, cases, statements, span) {
  this.label = label;
  this.statements = statements;
  this.cases = cases;
  Node.call(this, span);
}
CaseNode.prototype.get$label = function() { return this.label; };
CaseNode.prototype.set$label = function(value) { return this.label = value; };
CaseNode.prototype.get$cases = function() { return this.cases; };
CaseNode.prototype.set$cases = function(value) { return this.cases = value; };
CaseNode.prototype.get$statements = function() { return this.statements; };
CaseNode.prototype.set$statements = function(value) { return this.statements = value; };
CaseNode.prototype.visit = function(visitor) {
  return visitor.visitCaseNode(this);
}
CaseNode.prototype.visit$1 = CaseNode.prototype.visit;
// ********** Code for TypeParameter **************
$inherits(TypeParameter, Node);
function TypeParameter(name, extendsType, span) {
  this.extendsType = extendsType;
  this.name = name;
  Node.call(this, span);
}
TypeParameter.prototype.get$name = function() { return this.name; };
TypeParameter.prototype.set$name = function(value) { return this.name = value; };
TypeParameter.prototype.get$extendsType = function() { return this.extendsType; };
TypeParameter.prototype.set$extendsType = function(value) { return this.extendsType = value; };
TypeParameter.prototype.visit = function(visitor) {
  return visitor.visitTypeParameter(this);
}
TypeParameter.prototype.visit$1 = TypeParameter.prototype.visit;
// ********** Code for Identifier **************
$inherits(Identifier, Node);
function Identifier(name, span) {
  this.name = name;
  Node.call(this, span);
}
Identifier.prototype.get$name = function() { return this.name; };
Identifier.prototype.set$name = function(value) { return this.name = value; };
Identifier.prototype.visit = function(visitor) {
  return visitor.visitIdentifier(this);
}
Identifier.prototype.visit$1 = Identifier.prototype.visit;
// ********** Code for DeclaredIdentifier **************
$inherits(DeclaredIdentifier, Expression);
function DeclaredIdentifier(type, name, span) {
  this.name = name;
  this.type = type;
  Expression.call(this, span);
}
DeclaredIdentifier.prototype.get$type = function() { return this.type; };
DeclaredIdentifier.prototype.set$type = function(value) { return this.type = value; };
DeclaredIdentifier.prototype.get$name = function() { return this.name; };
DeclaredIdentifier.prototype.set$name = function(value) { return this.name = value; };
DeclaredIdentifier.prototype.visit = function(visitor) {
  return visitor.visitDeclaredIdentifier(this);
}
DeclaredIdentifier.prototype.visit$1 = DeclaredIdentifier.prototype.visit;
// ********** Code for Type **************
$inherits(Type, Element);
function Type(name) {
  this.isTested = false;
  this._resolvedMembers = new HashMapImplementation();
  this.isChecked = false;
  this.isWritten = false;
  this.varStubs = new HashMapImplementation();
  Element.call(this, name, null);
}
Type.prototype.get$typeCheckCode = function() { return this.typeCheckCode; };
Type.prototype.set$typeCheckCode = function(value) { return this.typeCheckCode = value; };
Type.prototype.get$varStubs = function() { return this.varStubs; };
Type.prototype.set$varStubs = function(value) { return this.varStubs = value; };
Type.prototype.markUsed = function() {

}
Type.prototype.get$typeMember = function() {
  if (this._typeMember == null) {
    this._typeMember = new TypeMember(this);
  }
  return this._typeMember;
}
Type.prototype.getMember = function(name) {
  return null;
}
Type.prototype.get$subtypes = function() {
  return null;
}
Type.prototype.get$isVar = function() {
  return false;
}
Type.prototype.get$isTop = function() {
  return false;
}
Type.prototype.get$isObject = function() {
  return false;
}
Type.prototype.get$isString = function() {
  return false;
}
Type.prototype.get$isBool = function() {
  return false;
}
Type.prototype.get$isFunction = function() {
  return false;
}
Type.prototype.get$isList = function() {
  return false;
}
Type.prototype.get$isNum = function() {
  return false;
}
Type.prototype.get$isVoid = function() {
  return false;
}
Type.prototype.get$isNullable = function() {
  return true;
}
Type.prototype.get$isVarOrFunction = function() {
  return this.get$isVar() || this.get$isFunction();
}
Type.prototype.get$isVarOrObject = function() {
  return this.get$isVar() || this.get$isObject();
}
Type.prototype.getCallMethod = function() {
  return null;
}
Type.prototype.get$isClosed = function() {
  return this.get$isString() || this.get$isBool() || this.get$isNum() || this.get$isFunction() || this.get$isVar();
}
Type.prototype.get$isUsed = function() {
  return false;
}
Type.prototype.get$isGeneric = function() {
  return false;
}
Type.prototype.get$nativeType = function() {
  return null;
}
Type.prototype.get$isHiddenNativeType = function() {
  return (this.get$nativeType() != null && this.get$nativeType().isConstructorHidden);
}
Type.prototype.get$isSingletonNative = function() {
  return (this.get$nativeType() != null && this.get$nativeType().isSingleton);
}
Type.prototype.get$isJsGlobalObject = function() {
  return (this.get$nativeType() != null && this.get$nativeType().isJsGlobalObject);
}
Type.prototype.get$hasTypeParams = function() {
  return false;
}
Type.prototype.get$typeofName = function() {
  return null;
}
Type.prototype.get$members = function() {
  return null;
}
Type.prototype.get$definition = function() {
  return null;
}
Type.prototype.get$factories = function() {
  return null;
}
Type.prototype.get$typeArgsInOrder = function() {
  return null;
}
Type.prototype.get$genericType = function() {
  return this;
}
Type.prototype.get$interfaces = function() {
  return null;
}
Type.prototype.get$parent = function() {
  return null;
}
Type.prototype.getAllMembers = function() {
  return new HashMapImplementation();
}
Type.prototype.get$nativeName = function() {
  return this.get$isNative() ? this.get$definition().get$nativeType().get$name() : this.get$jsname();
}
Type.prototype.get$avoidNativeName = function() {
  return this.get$isHiddenNativeType();
}
Type.prototype.get$hasNativeSubtypes = function() {
  if (this._hasNativeSubtypes == null) {
    this._hasNativeSubtypes = this.get$subtypes().some((function (t) {
      return t.get$isNative();
    })
    );
  }
  return this._hasNativeSubtypes;
}
Type.prototype._checkExtends = function() {
  var typeParams = this.get$genericType().typeParameters;
  if (typeParams != null && this.get$typeArgsInOrder() != null) {
    var args = this.get$typeArgsInOrder().iterator$0();
    var params = typeParams.iterator$0();
    while (args.hasNext$0() && params.hasNext$0()) {
      var typeParam = params.next$0();
      var typeArg = args.next$0();
      if (typeParam.get$extendsType() != null && typeArg != null) {
        typeArg.ensureSubtypeOf$3(typeParam.get$extendsType(), typeParam.get$span(), true);
      }
    }
  }
  if (this.get$interfaces() != null) {
    var $$list = this.get$interfaces();
    for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
      var i = $$list.$index($$i);
      i._checkExtends$0();
    }
  }
}
Type.prototype._checkOverride = function(member) {
  var parentMember = this._getMemberInParents(member.name);
  if (parentMember != null) {
    if (!member.get$isPrivate() || $eq(member.get$library(), parentMember.get$library())) {
      member.override(parentMember);
    }
  }
}
Type.prototype._createNotEqualMember = function() {
  var eq = this.get$members().$index(":eq");
  if (eq == null) {
    return;
  }
  var ne = new MethodMember(":ne", this, eq.definition);
  ne.set$isGenerated(true);
  ne.set$returnType(eq.returnType);
  ne.set$parameters(eq.parameters);
  ne.set$isStatic(eq.isStatic);
  ne.set$isAbstract(eq.isAbstract);
  this.get$members().$setindex(":ne", ne);
}
Type.prototype._getMemberInParents = function(memberName) {
  if (this.get$isClass()) {
    if (this.get$parent() != null) {
      return this.get$parent().getMember(memberName);
    }
    else {
      return null;
    }
  }
  else {
    if (this.get$interfaces() != null && this.get$interfaces().get$length() > (0)) {
      var $$list = this.get$interfaces();
      for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
        var i = $$list.$index($$i);
        var ret = i.getMember$1(memberName);
        if (ret != null) {
          return ret;
        }
      }
    }
    return $globals.world.objectType.getMember(memberName);
  }
}
Type.prototype.resolveMember = function(memberName) {
  var ret = this._resolvedMembers.$index(memberName);
  if (ret != null) return ret;
  var member = this.getMember(memberName);
  if (member == null) {
    return null;
  }
  ret = new MemberSet(member, false);
  this._resolvedMembers.$setindex(memberName, ret);
  if (member.get$isStatic()) {
    return ret;
  }
  else {
    var $$list = this.get$subtypes();
    for (var $$i = $$list.iterator(); $$i.hasNext$0(); ) {
      var t = $$i.next$0();
      if (!this.get$isClass() && t.get$isClass()) {
        var m = t.getMember$1(memberName);
        if (m != null && ret.members.indexOf(m) == (-1)) {
          ret.add(m);
        }
      }
      else {
        var m = t.get$members().$index(memberName);
        if (m != null) ret.add(m);
      }
    }
    return ret;
  }
}
Type.prototype.ensureSubtypeOf = function(other, span, typeErrors) {
  if (!this.isSubtypeOf(other)) {
    var msg = ("type " + this.name + " is not a subtype of " + other.name);
    if (typeErrors) {
      $globals.world.error(msg, span);
    }
    else {
      $globals.world.warning(msg, span);
    }
  }
}
Type.prototype.needsVarCall = function(args) {
  if (this.get$isVarOrFunction()) {
    return true;
  }
  var call = this.getCallMethod();
  if (call != null) {
    if (args.get$length() != call.get$parameters().get$length() || !call.namesInOrder$1(args)) {
      return true;
    }
  }
  return false;
}
Type.union = function(x, y) {
  if ($eq(x, y)) return x;
  if (x.get$isNum() && y.get$isNum()) return $globals.world.numType;
  if (x.get$isString() && y.get$isString()) return $globals.world.stringType;
  return $globals.world.varType;
}
Type.prototype.isAssignable = function(other) {
  return this.isSubtypeOf(other) || other.isSubtypeOf(this);
}
Type.prototype._isDirectSupertypeOf = function(other) {
  var $this = this; // closure support
  if (other.get$isClass()) {
    return $eq(other.get$parent(), this) || this.get$isObject() && other.get$parent() == null;
  }
  else {
    if (other.get$interfaces() == null || other.get$interfaces().isEmpty()) {
      return this.get$isObject();
    }
    else {
      return other.get$interfaces().some((function (i) {
        return $eq(i, $this);
      })
      );
    }
  }
}
Type.prototype.isSubtypeOf = function(other) {
  if ((other instanceof ParameterType)) {
    return true;
  }
  if ($eq(this, other)) return true;
  if (this.get$isVar()) return true;
  if (other.get$isVar()) return true;
  if (other._isDirectSupertypeOf(this)) return true;
  var call = this.getCallMethod();
  var otherCall = other.getCallMethod();
  if (call != null && otherCall != null) {
    return Type._isFunctionSubtypeOf(call, otherCall);
  }
  if ($eq(this.get$genericType(), other.get$genericType()) && this.get$typeArgsInOrder() != null && other.get$typeArgsInOrder() != null && $eq(this.get$typeArgsInOrder().get$length(), other.get$typeArgsInOrder().get$length())) {
    var t = this.get$typeArgsInOrder().iterator$0();
    var s = other.get$typeArgsInOrder().iterator$0();
    while (t.hasNext$0()) {
      if (!t.next$0().isSubtypeOf$1(s.next$0())) return false;
    }
    return true;
  }
  if (this.get$parent() != null && this.get$parent().isSubtypeOf(other)) {
    return true;
  }
  if (this.get$interfaces() != null && this.get$interfaces().some((function (i) {
    return i.isSubtypeOf$1(other);
  })
  )) {
    return true;
  }
  return false;
}
Type.prototype.hashCode = function() {
  var libraryCode = this.get$library() == null ? (1) : this.get$library().hashCode();
  var nameCode = this.name == null ? (1) : this.name.hashCode();
  return (libraryCode << (4)) ^ nameCode;
}
Type.prototype.$eq = function(other) {
  return (other instanceof Type) && $eq(other.get$name(), this.name) && $eq(this.get$library(), other.get$library());
}
Type._isFunctionSubtypeOf = function(t, s) {
  if (!s.returnType.get$isVoid() && !s.returnType.isAssignable(t.returnType)) {
    return false;
  }
  var tp = t.parameters;
  var sp = s.parameters;
  if (tp.get$length() < sp.get$length()) return false;
  for (var i = (0);
   i < sp.get$length(); i++) {
    if ($ne(tp.$index(i).get$isOptional(), sp.$index(i).get$isOptional())) return false;
    if (tp.$index(i).get$isOptional() && $ne(tp.$index(i).get$name(), sp.$index(i).get$name())) return false;
    if (!tp.$index(i).get$type().isAssignable$1(sp.$index(i).get$type())) return false;
  }
  if (tp.get$length() > sp.get$length() && !tp.$index(sp.get$length()).get$isOptional()) return false;
  return true;
}
Type.prototype._checkExtends$0 = Type.prototype._checkExtends;
Type.prototype.addDirectSubtype$1 = Type.prototype.addDirectSubtype;
Type.prototype.ensureSubtypeOf$3 = Type.prototype.ensureSubtypeOf;
Type.prototype.getConstructor$1 = Type.prototype.getConstructor;
Type.prototype.getFactory$2 = Type.prototype.getFactory;
Type.prototype.getMember$1 = Type.prototype.getMember;
Type.prototype.getOrMakeConcreteType$1 = Type.prototype.getOrMakeConcreteType;
Type.prototype.hashCode$0 = Type.prototype.hashCode;
Type.prototype.isAssignable$1 = Type.prototype.isAssignable;
Type.prototype.isSubtypeOf$1 = Type.prototype.isSubtypeOf;
Type.prototype.markUsed$0 = Type.prototype.markUsed;
Type.prototype.resolveTypeParams$1 = Type.prototype.resolveTypeParams;
// ********** Code for ParameterType **************
$inherits(ParameterType, Type);
function ParameterType(name, typeParameter) {
  this.typeParameter = typeParameter;
  Type.call(this, name);
}
ParameterType.prototype.get$typeParameter = function() { return this.typeParameter; };
ParameterType.prototype.set$typeParameter = function(value) { return this.typeParameter = value; };
ParameterType.prototype.get$extendsType = function() { return this.extendsType; };
ParameterType.prototype.set$extendsType = function(value) { return this.extendsType = value; };
ParameterType.prototype.get$isClass = function() {
  return false;
}
ParameterType.prototype.get$library = function() {
  return null;
}
ParameterType.prototype.get$span = function() {
  return this.typeParameter.span;
}
ParameterType.prototype.get$constructors = function() {
  $globals.world.internalError("no constructors on type parameters yet");
}
ParameterType.prototype.getCallMethod = function() {
  return this.extendsType.getCallMethod();
}
ParameterType.prototype.genMethod = function(method) {
  this.extendsType.genMethod(method);
}
ParameterType.prototype.isSubtypeOf = function(other) {
  return true;
}
ParameterType.prototype.resolveMember = function(memberName) {
  return this.extendsType.resolveMember(memberName);
}
ParameterType.prototype.getConstructor = function(constructorName) {
  $globals.world.internalError("no constructors on type parameters yet");
}
ParameterType.prototype.getOrMakeConcreteType = function(typeArgs) {
  $globals.world.internalError("no concrete types of type parameters yet", this.get$span());
}
ParameterType.prototype.resolveTypeParams = function(inType) {
  return inType.typeArguments.$index(this.name);
}
ParameterType.prototype.addDirectSubtype = function(type) {
  $globals.world.internalError("no subtypes of type parameters yet", this.get$span());
}
ParameterType.prototype.resolve = function() {
  if (this.typeParameter.extendsType != null) {
    this.extendsType = this.get$enclosingElement().resolveType$2(this.typeParameter.extendsType, true);
  }
  else {
    this.extendsType = $globals.world.objectType;
  }
}
ParameterType.prototype.addDirectSubtype$1 = ParameterType.prototype.addDirectSubtype;
ParameterType.prototype.getConstructor$1 = ParameterType.prototype.getConstructor;
ParameterType.prototype.getOrMakeConcreteType$1 = ParameterType.prototype.getOrMakeConcreteType;
ParameterType.prototype.isSubtypeOf$1 = ParameterType.prototype.isSubtypeOf;
ParameterType.prototype.resolve$0 = ParameterType.prototype.resolve;
ParameterType.prototype.resolveTypeParams$1 = ParameterType.prototype.resolveTypeParams;
// ********** Code for NonNullableType **************
$inherits(NonNullableType, Type);
function NonNullableType(type) {
  this.type = type;
  Type.call(this, type.name);
}
NonNullableType.prototype.get$type = function() { return this.type; };
NonNullableType.prototype.get$isNullable = function() {
  return false;
}
NonNullableType.prototype.get$isBool = function() {
  return this.type.get$isBool();
}
NonNullableType.prototype.get$isUsed = function() {
  return false;
}
NonNullableType.prototype.isSubtypeOf = function(other) {
  return $eq(this, other) || $eq(this.type, other) || this.type.isSubtypeOf(other);
}
NonNullableType.prototype.resolveType = function(node, isRequired) {
  return this.type.resolveType(node, isRequired);
}
NonNullableType.prototype.resolveTypeParams = function(inType) {
  return this.type.resolveTypeParams(inType);
}
NonNullableType.prototype.addDirectSubtype = function(subtype) {
  this.type.addDirectSubtype(subtype);
}
NonNullableType.prototype.markUsed = function() {
  this.type.markUsed();
}
NonNullableType.prototype.genMethod = function(method) {
  this.type.genMethod(method);
}
NonNullableType.prototype.get$span = function() {
  return this.type.get$span();
}
NonNullableType.prototype.resolveMember = function(name) {
  return this.type.resolveMember(name);
}
NonNullableType.prototype.getMember = function(name) {
  return this.type.getMember(name);
}
NonNullableType.prototype.getConstructor = function(name) {
  return this.type.getConstructor(name);
}
NonNullableType.prototype.getFactory = function(t, name) {
  return this.type.getFactory(t, name);
}
NonNullableType.prototype.getOrMakeConcreteType = function(typeArgs) {
  return this.type.getOrMakeConcreteType(typeArgs);
}
NonNullableType.prototype.get$constructors = function() {
  return this.type.get$constructors();
}
NonNullableType.prototype.get$isClass = function() {
  return this.type.get$isClass();
}
NonNullableType.prototype.get$library = function() {
  return this.type.get$library();
}
NonNullableType.prototype.getCallMethod = function() {
  return this.type.getCallMethod();
}
NonNullableType.prototype.get$isGeneric = function() {
  return this.type.get$isGeneric();
}
NonNullableType.prototype.get$hasTypeParams = function() {
  return this.type.get$hasTypeParams();
}
NonNullableType.prototype.get$typeofName = function() {
  return this.type.get$typeofName();
}
NonNullableType.prototype.get$jsname = function() {
  return this.type.get$jsname();
}
NonNullableType.prototype.get$members = function() {
  return this.type.get$members();
}
NonNullableType.prototype.get$definition = function() {
  return this.type.get$definition();
}
NonNullableType.prototype.get$factories = function() {
  return this.type.get$factories();
}
NonNullableType.prototype.get$typeArgsInOrder = function() {
  return this.type.get$typeArgsInOrder();
}
NonNullableType.prototype.get$genericType = function() {
  return this.type.get$genericType();
}
NonNullableType.prototype.get$interfaces = function() {
  return this.type.get$interfaces();
}
NonNullableType.prototype.get$parent = function() {
  return this.type.get$parent();
}
NonNullableType.prototype.getAllMembers = function() {
  return this.type.getAllMembers();
}
NonNullableType.prototype.get$isNative = function() {
  return this.type.get$isNative();
}
NonNullableType.prototype.addDirectSubtype$1 = NonNullableType.prototype.addDirectSubtype;
NonNullableType.prototype.getConstructor$1 = NonNullableType.prototype.getConstructor;
NonNullableType.prototype.getFactory$2 = NonNullableType.prototype.getFactory;
NonNullableType.prototype.getMember$1 = NonNullableType.prototype.getMember;
NonNullableType.prototype.getOrMakeConcreteType$1 = NonNullableType.prototype.getOrMakeConcreteType;
NonNullableType.prototype.isSubtypeOf$1 = NonNullableType.prototype.isSubtypeOf;
NonNullableType.prototype.markUsed$0 = NonNullableType.prototype.markUsed;
NonNullableType.prototype.resolveType$2 = NonNullableType.prototype.resolveType;
NonNullableType.prototype.resolveTypeParams$1 = NonNullableType.prototype.resolveTypeParams;
// ********** Code for ConcreteType **************
$inherits(ConcreteType, Type);
function ConcreteType(name, genericType, typeArguments, typeArgsInOrder) {
  this.isUsed = false;
  this.constructors = new HashMapImplementation();
  this.genericType = genericType;
  this.factories = new FactoryMap();
  this.members = new HashMapImplementation();
  this.typeArguments = typeArguments;
  this.typeArgsInOrder = typeArgsInOrder;
  Type.call(this, name);
}
ConcreteType.prototype.get$genericType = function() { return this.genericType; };
ConcreteType.prototype.get$typeArguments = function() { return this.typeArguments; };
ConcreteType.prototype.set$typeArguments = function(value) { return this.typeArguments = value; };
ConcreteType.prototype.get$_parent = function() { return this._parent; };
ConcreteType.prototype.set$_parent = function(value) { return this._parent = value; };
ConcreteType.prototype.get$typeArgsInOrder = function() { return this.typeArgsInOrder; };
ConcreteType.prototype.set$typeArgsInOrder = function(value) { return this.typeArgsInOrder = value; };
ConcreteType.prototype.get$isList = function() {
  return this.genericType.get$isList();
}
ConcreteType.prototype.get$isClass = function() {
  return this.genericType.isClass;
}
ConcreteType.prototype.get$library = function() {
  return this.genericType.library;
}
ConcreteType.prototype.get$span = function() {
  return this.genericType.get$span();
}
ConcreteType.prototype.get$hasTypeParams = function() {
  return this.typeArguments.getValues().some$1((function (e) {
    return (e instanceof ParameterType);
  })
  );
}
ConcreteType.prototype.get$isUsed = function() { return this.isUsed; };
ConcreteType.prototype.set$isUsed = function(value) { return this.isUsed = value; };
ConcreteType.prototype.get$members = function() { return this.members; };
ConcreteType.prototype.set$members = function(value) { return this.members = value; };
ConcreteType.prototype.get$constructors = function() { return this.constructors; };
ConcreteType.prototype.set$constructors = function(value) { return this.constructors = value; };
ConcreteType.prototype.get$factories = function() { return this.factories; };
ConcreteType.prototype.set$factories = function(value) { return this.factories = value; };
ConcreteType.prototype.resolveTypeParams = function(inType) {
  var newTypeArgs = [];
  var needsNewType = false;
  var $$list = this.typeArgsInOrder;
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var t = $$list.$index($$i);
    var newType = t.resolveTypeParams$1(inType);
    if ($ne(newType, t)) needsNewType = true;
    newTypeArgs.add$1(newType);
  }
  if (!needsNewType) return this;
  return this.genericType.getOrMakeConcreteType(newTypeArgs);
}
ConcreteType.prototype.getOrMakeConcreteType = function(typeArgs) {
  return this.genericType.getOrMakeConcreteType(typeArgs);
}
ConcreteType.prototype.get$parent = function() {
  if (this._parent == null && this.genericType.get$parent() != null) {
    this._parent = this.genericType.get$parent().resolveTypeParams(this);
  }
  return this._parent;
}
ConcreteType.prototype.get$interfaces = function() {
  if (this._interfaces == null && this.genericType.interfaces != null) {
    this._interfaces = [];
    var $$list = this.genericType.interfaces;
    for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
      var i = $$list.$index($$i);
      this._interfaces.add(i.resolveTypeParams$1(this));
    }
  }
  return this._interfaces;
}
ConcreteType.prototype.get$subtypes = function() {
  if (this._subtypes == null) {
    this._subtypes = new HashSetImplementation();
    var $$list = this.genericType.get$subtypes();
    for (var $$i = $$list.iterator(); $$i.hasNext$0(); ) {
      var s = $$i.next$0();
      this._subtypes.add(s.resolveTypeParams$1(this));
    }
  }
  return this._subtypes;
}
ConcreteType.prototype.getCallMethod = function() {
  return this.genericType.getCallMethod();
}
ConcreteType.prototype.getAllMembers = function() {
  var result = this.genericType.getAllMembers();
  var $$list = result.getKeys$0();
  for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
    var memberName = $$i.next$0();
    var myMember = this.members.$index(memberName);
    if (myMember != null) {
      result.$setindex(memberName, myMember);
    }
  }
  return result;
}
ConcreteType.prototype.markUsed = function() {
  if (this.isUsed) return;
  this.isUsed = true;
  this._checkExtends();
  this.genericType.markUsed();
}
ConcreteType.prototype.genMethod = function(method) {
  return this.genericType.genMethod(method);
}
ConcreteType.prototype.getFactory = function(type, constructorName) {
  return this.genericType.getFactory(type, constructorName);
}
ConcreteType.prototype.getConstructor = function(constructorName) {
  var ret = this.constructors.$index(constructorName);
  if (ret != null) return ret;
  ret = this.factories.getFactory(this.name, constructorName);
  if (ret != null) return ret;
  var genericMember = this.genericType.getConstructor(constructorName);
  if (genericMember == null) return null;
  if ($ne(genericMember.get$declaringType(), this.genericType)) {
    if (!genericMember.get$declaringType().get$isGeneric()) return genericMember;
    var newDeclaringType = genericMember.get$declaringType().getOrMakeConcreteType$1(this.typeArgsInOrder);
    var factory = newDeclaringType.getFactory$2(this.genericType, constructorName);
    if (factory != null) return factory;
    return newDeclaringType.getConstructor$1(constructorName);
  }
  if (genericMember.get$isFactory()) {
    ret = new ConcreteMember(genericMember.get$name(), this, genericMember);
    this.factories.addFactory(this.name, constructorName, ret);
  }
  else {
    ret = new ConcreteMember(this.name, this, genericMember);
    this.constructors.$setindex(constructorName, ret);
  }
  return ret;
}
ConcreteType.prototype.getMember = function(memberName) {
  var member = this.members.$index(memberName);
  if (member != null) {
    this._checkOverride(member);
    return member;
  }
  var genericMember = this.genericType.members.$index(memberName);
  if (genericMember != null) {
    member = new ConcreteMember(genericMember.get$name(), this, genericMember);
    this.members.$setindex(memberName, member);
    return member;
  }
  return this._getMemberInParents(memberName);
}
ConcreteType.prototype.resolveType = function(node, isRequired) {
  var ret = this.genericType.resolveType(node, isRequired);
  return ret;
}
ConcreteType.prototype.addDirectSubtype = function(type) {
  this.genericType.addDirectSubtype(type);
}
ConcreteType.prototype.addDirectSubtype$1 = ConcreteType.prototype.addDirectSubtype;
ConcreteType.prototype.getConstructor$1 = ConcreteType.prototype.getConstructor;
ConcreteType.prototype.getFactory$2 = ConcreteType.prototype.getFactory;
ConcreteType.prototype.getMember$1 = ConcreteType.prototype.getMember;
ConcreteType.prototype.getOrMakeConcreteType$1 = ConcreteType.prototype.getOrMakeConcreteType;
ConcreteType.prototype.markUsed$0 = ConcreteType.prototype.markUsed;
ConcreteType.prototype.resolveType$2 = ConcreteType.prototype.resolveType;
ConcreteType.prototype.resolveTypeParams$1 = ConcreteType.prototype.resolveTypeParams;
// ********** Code for DefinedType **************
$inherits(DefinedType, Type);
function DefinedType(name, library, definition, isClass) {
  this.isUsed = false;
  this.directSubtypes = new HashSetImplementation();
  this.isNative = false;
  this.library = library;
  this.isClass = isClass;
  this.constructors = new HashMapImplementation();
  this.factories = new FactoryMap();
  this.members = new HashMapImplementation();
  Type.call(this, name);
  this.setDefinition(definition);
}
DefinedType.prototype.get$definition = function() { return this.definition; };
DefinedType.prototype.set$definition = function(value) { return this.definition = value; };
DefinedType.prototype.get$library = function() { return this.library; };
DefinedType.prototype.get$isClass = function() { return this.isClass; };
DefinedType.prototype.get$_parent = function() { return this._parent; };
DefinedType.prototype.set$_parent = function(value) { return this._parent = value; };
DefinedType.prototype.get$parent = function() {
  return this._parent;
}
DefinedType.prototype.set$parent = function(p) {
  this._parent = p;
}
DefinedType.prototype.get$interfaces = function() { return this.interfaces; };
DefinedType.prototype.set$interfaces = function(value) { return this.interfaces = value; };
DefinedType.prototype.get$directSubtypes = function() { return this.directSubtypes; };
DefinedType.prototype.set$directSubtypes = function(value) { return this.directSubtypes = value; };
DefinedType.prototype.get$typeParameters = function() { return this.typeParameters; };
DefinedType.prototype.set$typeParameters = function(value) { return this.typeParameters = value; };
DefinedType.prototype.get$constructors = function() { return this.constructors; };
DefinedType.prototype.set$constructors = function(value) { return this.constructors = value; };
DefinedType.prototype.get$members = function() { return this.members; };
DefinedType.prototype.set$members = function(value) { return this.members = value; };
DefinedType.prototype.get$factories = function() { return this.factories; };
DefinedType.prototype.set$factories = function(value) { return this.factories = value; };
DefinedType.prototype.get$_concreteTypes = function() { return this._concreteTypes; };
DefinedType.prototype.set$_concreteTypes = function(value) { return this._concreteTypes = value; };
DefinedType.prototype.get$isUsed = function() { return this.isUsed; };
DefinedType.prototype.set$isUsed = function(value) { return this.isUsed = value; };
DefinedType.prototype.get$isNative = function() { return this.isNative; };
DefinedType.prototype.set$isNative = function(value) { return this.isNative = value; };
DefinedType.prototype.setDefinition = function(def) {
  this.definition = def;
  if ((this.definition instanceof TypeDefinition) && this.definition.get$nativeType() != null) {
    this.isNative = true;
  }
  if (this.definition != null && this.definition.get$typeParameters() != null) {
    this._concreteTypes = new HashMapImplementation();
    this.typeParameters = this.definition.get$typeParameters();
  }
}
DefinedType.prototype.get$nativeType = function() {
  return (this.definition != null ? this.definition.get$nativeType() : null);
}
DefinedType.prototype.get$typeArgsInOrder = function() {
  if (this.typeParameters == null) return null;
  if (this._typeArgsInOrder == null) {
    this._typeArgsInOrder = new FixedCollection_Type($globals.world.varType, this.typeParameters.get$length());
  }
  return this._typeArgsInOrder;
}
DefinedType.prototype.get$isVar = function() {
  return $eq(this, $globals.world.varType);
}
DefinedType.prototype.get$isVoid = function() {
  return $eq(this, $globals.world.voidType);
}
DefinedType.prototype.get$isTop = function() {
  return this.name == null;
}
DefinedType.prototype.get$isObject = function() {
  return this.library.get$isCore() && this.name == "Object";
}
DefinedType.prototype.get$isString = function() {
  return this.library.get$isCore() && this.name == "String" || this.library.get$isCoreImpl() && this.name == "StringImplementation";
}
DefinedType.prototype.get$isBool = function() {
  return this.library.get$isCore() && this.name == "bool";
}
DefinedType.prototype.get$isFunction = function() {
  return this.library.get$isCore() && this.name == "Function";
}
DefinedType.prototype.get$isList = function() {
  return this.library.get$isCore() && this.name == "List";
}
DefinedType.prototype.get$isGeneric = function() {
  return this.typeParameters != null;
}
DefinedType.prototype.get$span = function() {
  return this.definition == null ? null : this.definition.span;
}
DefinedType.prototype.get$typeofName = function() {
  if (!this.library.get$isCore()) return null;
  if (this.get$isBool()) return "boolean";
  else if (this.get$isNum()) return "number";
  else if (this.get$isString()) return "string";
  else if (this.get$isFunction()) return "function";
  else return null;
}
DefinedType.prototype.get$isNum = function() {
  return this.library != null && this.library.get$isCore() && (this.name == "num" || this.name == "int" || this.name == "double");
}
DefinedType.prototype.getCallMethod = function() {
  return this.members.$index(":call");
}
DefinedType.prototype.getAllMembers = function() {
  return HashMapImplementation.HashMapImplementation$from$factory(this.members);
}
DefinedType.prototype.markUsed = function() {
  if (this.isUsed) return;
  this.isUsed = true;
  this._checkExtends();
  if (this._lazyGenMethods != null) {
    var $$list = orderValuesByKeys(this._lazyGenMethods);
    for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
      var method = $$list.$index($$i);
      $globals.world.gen.genMethod(method);
    }
    this._lazyGenMethods = null;
  }
  if (this.get$parent() != null) this.get$parent().markUsed();
}
DefinedType.prototype.genMethod = function(method) {
  if (this.isUsed) {
    $globals.world.gen.genMethod(method);
  }
  else if (this.isClass) {
    if (this._lazyGenMethods == null) this._lazyGenMethods = new HashMapImplementation();
    this._lazyGenMethods.$setindex(method.name, method);
  }
}
DefinedType.prototype._resolveInterfaces = function(types) {
  if (types == null) return [];
  var interfaces = [];
  for (var $$i = 0;$$i < types.get$length(); $$i++) {
    var type = types.$index($$i);
    var resolvedInterface = this.resolveType(type, true);
    if (resolvedInterface.get$isClosed() && !(this.library.get$isCore() || this.library.get$isCoreImpl())) {
      $globals.world.error(("can not implement \"" + resolvedInterface.get$name() + "\": ") + "only native implementation allowed", type.get$span());
    }
    resolvedInterface.addDirectSubtype$1(this);
    interfaces.add$1(resolvedInterface);
  }
  return interfaces;
}
DefinedType.prototype.addDirectSubtype = function(type) {
  this.directSubtypes.add(type);
}
DefinedType.prototype.get$subtypes = function() {
  if (this._subtypes == null) {
    this._subtypes = new HashSetImplementation();
    var $$list = this.directSubtypes;
    for (var $$i = $$list.iterator(); $$i.hasNext$0(); ) {
      var st = $$i.next$0();
      this._subtypes.add(st);
      this._subtypes.addAll(st.get$subtypes());
    }
  }
  return this._subtypes;
}
DefinedType.prototype._cycleInClassExtends = function() {
  var seen = new HashSetImplementation();
  seen.add$1(this);
  var ancestor = this.get$parent();
  while (ancestor != null) {
    if (ancestor == this) {
      return true;
    }
    if (seen.contains$1(ancestor)) {
      return false;
    }
    seen.add$1(ancestor);
    ancestor = ancestor.get$parent();
  }
  return false;
}
DefinedType.prototype._cycleInInterfaceExtends = function() {
  var $this = this; // closure support
  var seen = new HashSetImplementation();
  seen.add$1(this);
  function _helper(ancestor) {
    if (ancestor == null) return false;
    if (ancestor == $this) return true;
    if (seen.contains$1(ancestor)) {
      return false;
    }
    seen.add$1(ancestor);
    if (ancestor.get$interfaces() != null) {
      var $$list = ancestor.get$interfaces();
      for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
        var parent = $$i.next$0();
        if (_helper(parent)) return true;
      }
    }
    return false;
  }
  for (var i = (0);
   i < this.interfaces.get$length(); i++) {
    if (_helper(this.interfaces.$index(i))) return i;
  }
  return (-1);
}
DefinedType.prototype.resolve = function() {
  if ((this.definition instanceof TypeDefinition)) {
    var typeDef = this.definition;
    if (this.isClass) {
      if (typeDef.extendsTypes != null && typeDef.extendsTypes.get$length() > (0)) {
        if (typeDef.extendsTypes.get$length() > (1)) {
          $globals.world.error("more than one base class", typeDef.extendsTypes.$index((1)).get$span());
        }
        var extendsTypeRef = typeDef.extendsTypes.$index((0));
        if ((extendsTypeRef instanceof GenericTypeReference)) {
          var g = extendsTypeRef;
          this.set$parent(this.resolveType(g.baseType, true));
        }
        this.set$parent(this.resolveType(extendsTypeRef, true));
        if (!this.get$parent().get$isClass()) {
          $globals.world.error("class may not extend an interface - use implements", typeDef.extendsTypes.$index((0)).get$span());
        }
        this.get$parent().addDirectSubtype(this);
        if (this._cycleInClassExtends()) {
          $globals.world.error(("class \"" + this.name + "\" has a cycle in its inheritance chain"), extendsTypeRef.get$span());
        }
      }
      else {
        if (!this.get$isObject()) {
          this.set$parent($globals.world.objectType);
          this.get$parent().addDirectSubtype(this);
        }
      }
      this.interfaces = this._resolveInterfaces(typeDef.implementsTypes);
      if (typeDef.defaultType != null) {
        $globals.world.error("default not allowed on classes", typeDef.defaultType.span);
      }
    }
    else {
      if (typeDef.implementsTypes != null && typeDef.implementsTypes.get$length() > (0)) {
        $globals.world.error("implements not allowed on interfaces (use extends)", typeDef.implementsTypes.$index((0)).get$span());
      }
      this.interfaces = this._resolveInterfaces(typeDef.extendsTypes);
      var res = this._cycleInInterfaceExtends();
      if (res >= (0)) {
        $globals.world.error(("interface \"" + this.name + "\" has a cycle in its inheritance chain"), typeDef.extendsTypes.$index(res).get$span());
      }
      if (typeDef.defaultType != null) {
        this.defaultType = this.resolveType(typeDef.defaultType.baseType, true);
        if (this.defaultType == null) {
          $globals.world.warning("unresolved default class", typeDef.defaultType.span);
        }
        else {
          this.defaultType._resolveTypeParams(typeDef.defaultType.typeParameters);
        }
      }
    }
  }
  else if ((this.definition instanceof FunctionTypeDefinition)) {
    this.interfaces = [$globals.world.functionType];
  }
  this._resolveTypeParams(this.typeParameters);
  if (this.get$isObject()) this._createNotEqualMember();
  $globals.world._addType(this);
  var $$list = this.constructors.getValues();
  for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
    var c = $$i.next$0();
    c.resolve$0();
  }
  var $$list = this.members.getValues();
  for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
    var m = $$i.next$0();
    m.resolve$0();
  }
  this.factories.forEach((function (f) {
    return f.resolve$0();
  })
  );
  if (this.get$isJsGlobalObject()) {
    var $$list = this.members.getValues();
    for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
      var m = $$i.next$0();
      if (!m.get$isStatic()) $globals.world._addTopName(m);
    }
  }
}
DefinedType.prototype._resolveTypeParams = function(params) {
  if (params == null) return;
  for (var $$i = 0;$$i < params.get$length(); $$i++) {
    var tp = params.$index($$i);
    tp.set$enclosingElement(this);
    tp.resolve$0();
  }
}
DefinedType.prototype.addMethod = function(methodName, definition) {
  if (methodName == null) methodName = definition.name.name;
  var method = new MethodMember(methodName, this, definition);
  if (method.get$isConstructor()) {
    if (this.constructors.containsKey(method.get$constructorName())) {
      $globals.world.error(("duplicate constructor definition of " + method.get$name()), definition.span);
      return;
    }
    this.constructors.$setindex(method.get$constructorName(), method);
    return;
  }
  if (definition.modifiers != null && definition.modifiers.get$length() == (1) && $eq(definition.modifiers.$index((0)).get$kind(), (74))) {
    if (this.factories.getFactory(method.get$constructorName(), method.get$name()) != null) {
      $globals.world.error(("duplicate factory definition of \"" + method.get$name() + "\""), definition.span);
      return;
    }
    this.factories.addFactory(method.get$constructorName(), method.get$name(), method);
    return;
  }
  if (methodName.startsWith("get:") || methodName.startsWith("set:")) {
    var propName = methodName.substring((4));
    var prop = this.members.$index(propName);
    if (prop == null) {
      prop = new PropertyMember(propName, this);
      this.members.$setindex(propName, prop);
    }
    if (!(prop instanceof PropertyMember)) {
      $globals.world.error(("property conflicts with field \"" + propName + "\""), definition.span);
      return;
    }
    if (methodName[(0)] == "g") {
      if (prop.get$getter() != null) {
        $globals.world.error(("duplicate getter definition for \"" + propName + "\""), definition.span);
      }
      prop.set$getter(method);
    }
    else {
      if (prop.get$setter() != null) {
        $globals.world.error(("duplicate setter definition for \"" + propName + "\""), definition.span);
      }
      prop.set$setter(method);
    }
    return;
  }
  if (this.members.containsKey(methodName)) {
    $globals.world.error(("duplicate method definition of \"" + method.get$name() + "\""), definition.span);
    return;
  }
  this.members.$setindex(methodName, method);
}
DefinedType.prototype.addField = function(definition) {
  for (var i = (0);
   i < definition.names.get$length(); i++) {
    var name = definition.names.$index(i).get$name();
    if (this.members.containsKey(name)) {
      $globals.world.error(("duplicate field definition of \"" + name + "\""), definition.span);
      return;
    }
    var value = null;
    if (definition.values != null) {
      value = definition.values.$index(i);
    }
    var field = new FieldMember(name, this, definition, value);
    this.members.$setindex(name, field);
    if (this.isNative) {
      field.set$isNative(true);
    }
  }
}
DefinedType.prototype.getFactory = function(type, constructorName) {
  var ret = this.factories.getFactory(type.name, constructorName);
  if (ret != null) return ret;
  ret = this.factories.getFactory(this.name, constructorName);
  if (ret != null) return ret;
  ret = this.constructors.$index(constructorName);
  if (ret != null) return ret;
  return this._tryCreateDefaultConstructor(constructorName);
}
DefinedType.prototype.getConstructor = function(constructorName) {
  var ret = this.constructors.$index(constructorName);
  if (ret != null) {
    if (this.defaultType != null) {
      this._checkDefaultTypeParams();
      return this.defaultType.getFactory(this, constructorName);
    }
    return ret;
  }
  ret = this.factories.getFactory(this.name, constructorName);
  if (ret != null) return ret;
  return this._tryCreateDefaultConstructor(constructorName);
}
DefinedType.prototype._checkDefaultTypeParams = function() {
  function toList(list) {
    return (list != null ? list : const$0008);
  }
  var typeDef = this.definition;
  if (typeDef.defaultType.oldFactory) {
    return;
  }
  var interfaceParams = toList(this.typeParameters);
  var defaultParams = toList(typeDef.defaultType.typeParameters);
  var classParams = toList(this.defaultType.typeParameters);
  if ($ne(interfaceParams.get$length(), defaultParams.get$length()) || $ne(defaultParams.get$length(), classParams.get$length())) {
    $globals.world.error("\"default\" must have the same number of type parameters as the class and interface do", this.get$span(), typeDef.defaultType.span, this.defaultType.get$span());
    return;
  }
  for (var i = (0);
   i < interfaceParams.get$length(); i++) {
    var ip = interfaceParams.$index(i);
    var dp = defaultParams.$index(i);
    var cp = classParams.$index(i);
    dp.resolve$0();
    if ($ne(ip.get$name(), dp.get$name()) || $ne(dp.get$name(), cp.get$name())) {
      $globals.world.error("default class must have the same type parameter names as the class and interface", ip.get$span(), dp.get$span(), cp.get$span());
    }
    else if ($ne(dp.get$extendsType(), cp.get$extendsType())) {
      $globals.world.error("default class type parameters must have the same extends as the class does", dp.get$span(), cp.get$span());
    }
    else if (!dp.get$extendsType().isSubtypeOf$1(ip.get$extendsType())) {
      $globals.world.warning("\"default\" can only have tighter type parameter \"extends\" than the interface", dp.get$span(), ip.get$span());
    }
  }
}
DefinedType.prototype._tryCreateDefaultConstructor = function(name) {
  if (name == "" && this.definition != null && this.isClass && this.constructors.get$length() == (0)) {
    var span = this.definition.span;
    var inits = null, native_ = null, body = null;
    if (this.isNative) {
      native_ = "";
      inits = null;
    }
    else {
      body = null;
      inits = [new CallExpression(new SuperExpression(span), [], span)];
    }
    var typeDef = this.definition;
    var c = new FunctionDefinition(null, null, typeDef.name, [], inits, native_, body, span);
    this.addMethod(null, c);
    this.constructors.$index("").resolve$0();
    return this.constructors.$index("");
  }
  return null;
}
DefinedType.prototype.getMember = function(memberName) {
  var member = this.members.$index(memberName);
  if (member != null) {
    this._checkOverride(member);
    return member;
  }
  if (this.get$isTop()) {
    var libType = this.library.findTypeByName(memberName);
    if (libType != null) {
      return libType.get$typeMember();
    }
  }
  return this._getMemberInParents(memberName);
}
DefinedType.prototype.resolveTypeParams = function(inType) {
  return this;
}
DefinedType.prototype.getOrMakeConcreteType = function(typeArgs) {
  var jsnames = [];
  var names = [];
  var typeMap = new HashMapImplementation();
  for (var i = (0);
   i < typeArgs.get$length(); i++) {
    var paramName = this.typeParameters.$index(i).get$name();
    typeMap.$setindex(paramName, typeArgs.$index(i));
    names.add$1(typeArgs.$index(i).get$name());
    jsnames.add$1(typeArgs.$index(i).get$jsname());
  }
  var jsname = ("" + this.get$jsname() + "_" + Strings.join(jsnames, "$"));
  var simpleName = ("" + this.name + "<" + Strings.join(names, ", ") + ">");
  var key = Strings.join(names, "$");
  var ret = this._concreteTypes.$index(key);
  if (ret == null) {
    ret = new ConcreteType(simpleName, this, typeMap, typeArgs);
    ret.set$_jsname(jsname);
    this._concreteTypes.$setindex(key, ret);
  }
  return ret;
}
DefinedType.prototype.getCallStub = function(args) {
  var name = _getCallStubName("call", args);
  var stub = this.varStubs.$index(name);
  if (stub == null) {
    stub = new VarFunctionStub(name, args);
    this.varStubs.$setindex(name, stub);
  }
  return stub;
}
DefinedType.prototype.addDirectSubtype$1 = DefinedType.prototype.addDirectSubtype;
DefinedType.prototype.addMethod$2 = DefinedType.prototype.addMethod;
DefinedType.prototype.getConstructor$1 = DefinedType.prototype.getConstructor;
DefinedType.prototype.getFactory$2 = DefinedType.prototype.getFactory;
DefinedType.prototype.getMember$1 = DefinedType.prototype.getMember;
DefinedType.prototype.getOrMakeConcreteType$1 = DefinedType.prototype.getOrMakeConcreteType;
DefinedType.prototype.markUsed$0 = DefinedType.prototype.markUsed;
DefinedType.prototype.resolve$0 = DefinedType.prototype.resolve;
DefinedType.prototype.resolveTypeParams$1 = DefinedType.prototype.resolveTypeParams;
DefinedType.prototype.setDefinition$1 = DefinedType.prototype.setDefinition;
// ********** Code for NativeType **************
function NativeType(name) {
  this.isConstructorHidden = false;
  this.isSingleton = false;
  this.isJsGlobalObject = false;
  this.name = name;
  while (true) {
    if (this.name.startsWith("@")) {
      this.name = this.name.substring((1));
      this.isJsGlobalObject = true;
    }
    else if (this.name.startsWith("*")) {
      this.name = this.name.substring((1));
      this.isConstructorHidden = true;
    }
    else {
      break;
    }
  }
  if (this.name.startsWith("=")) {
    this.name = this.name.substring((1));
    this.isSingleton = true;
  }
}
NativeType.prototype.get$name = function() { return this.name; };
NativeType.prototype.set$name = function(value) { return this.name = value; };
// ********** Code for FixedCollection **************
function FixedCollection(value, length) {
  this.length = length;
  this.value = value;
}
FixedCollection.prototype.get$value = function() { return this.value; };
FixedCollection.prototype.get$length = function() { return this.length; };
FixedCollection.prototype.iterator = function() {
  return new FixedIterator_E(this.value, this.length);
}
FixedCollection.prototype.forEach = function(f) {
  Collections.forEach(this, f);
}
FixedCollection.prototype.filter = function(f) {
  return Collections.filter(this, new Array(), f);
}
FixedCollection.prototype.every = function(f) {
  return Collections.every(this, f);
}
FixedCollection.prototype.some = function(f) {
  return Collections.some(this, f);
}
FixedCollection.prototype.isEmpty = function() {
  return this.length == (0);
}
FixedCollection.prototype.every$1 = function($0) {
  return this.every(to$call$1($0));
};
FixedCollection.prototype.filter$1 = function($0) {
  return this.filter(to$call$1($0));
};
FixedCollection.prototype.forEach$1 = function($0) {
  return this.forEach(to$call$1($0));
};
FixedCollection.prototype.isEmpty$0 = FixedCollection.prototype.isEmpty;
FixedCollection.prototype.iterator$0 = FixedCollection.prototype.iterator;
FixedCollection.prototype.some$1 = function($0) {
  return this.some(to$call$1($0));
};
// ********** Code for FixedCollection_Type **************
$inherits(FixedCollection_Type, FixedCollection);
function FixedCollection_Type(value, length) {
  this.value = value;
  this.length = length;
}
// ********** Code for FixedIterator **************
function FixedIterator(value, length) {
  this.length = length;
  this._index = (0);
  this.value = value;
}
FixedIterator.prototype.get$value = function() { return this.value; };
FixedIterator.prototype.get$length = function() { return this.length; };
FixedIterator.prototype.hasNext = function() {
  return this._index < this.length;
}
FixedIterator.prototype.next = function() {
  this._index++;
  return this.value;
}
FixedIterator.prototype.hasNext$0 = FixedIterator.prototype.hasNext;
FixedIterator.prototype.next$0 = FixedIterator.prototype.next;
// ********** Code for FixedIterator_E **************
$inherits(FixedIterator_E, FixedIterator);
function FixedIterator_E(value, length) {
  this._index = (0);
  this.value = value;
  this.length = length;
}
// ********** Code for _SharedBackingMap **************
$inherits(_SharedBackingMap, HashMapImplementation_K$V);
function _SharedBackingMap() {
  this.shared = (0);
  HashMapImplementation_K$V.call(this);
}
_SharedBackingMap._SharedBackingMap$from$factory = function(other) {
  var result = new _SharedBackingMap_K$V();
  other.forEach((function (k, v) {
    result.$setindex(k, v);
  })
  );
  return result;
}
// ********** Code for _SharedBackingMap_K$V **************
$inherits(_SharedBackingMap_K$V, _SharedBackingMap);
function _SharedBackingMap_K$V() {
  this.shared = (0);
  HashMapImplementation_K$V.call(this);
}
_SharedBackingMap_K$V._SharedBackingMap$from$factory = function(other) {
  var result = new _SharedBackingMap_K$V();
  other.forEach((function (k, v) {
    result.$setindex(k, v);
  })
  );
  return result;
}
// ********** Code for _SharedBackingMap_dart_core_String$Value **************
$inherits(_SharedBackingMap_dart_core_String$Value, _SharedBackingMap);
function _SharedBackingMap_dart_core_String$Value() {
  this.shared = (0);
  HashMapImplementation_dart_core_String$Value.call(this);
}
_SharedBackingMap_dart_core_String$Value._SharedBackingMap$from$factory = function(other) {
  var result = new _SharedBackingMap_dart_core_String$Value();
  other.forEach((function (k, v) {
    result.$setindex(k, v);
  })
  );
  return result;
}
// ********** Code for CopyOnWriteMap **************
function CopyOnWriteMap() {
  this._lang_map = new _SharedBackingMap_K$V();
}
CopyOnWriteMap._wrap$ctor = function(_map) {
  this._lang_map = _map;
}
CopyOnWriteMap._wrap$ctor.prototype = CopyOnWriteMap.prototype;
CopyOnWriteMap.prototype.clone = function() {
  this._lang_map.shared++;
  return new CopyOnWriteMap_K$V._wrap$ctor(this._lang_map);
}
CopyOnWriteMap.prototype._ensureWritable = function() {
  if (this._lang_map.shared > (0)) {
    this._lang_map.shared--;
    this._lang_map = _SharedBackingMap._SharedBackingMap$from$factory(this._lang_map);
  }
}
CopyOnWriteMap.prototype.$setindex = function(key, value) {
  this._ensureWritable();
  this._lang_map.$setindex(key, value);
}
CopyOnWriteMap.prototype.putIfAbsent = function(key, ifAbsent) {
  this._ensureWritable();
  return this._lang_map.putIfAbsent(key, ifAbsent);
}
CopyOnWriteMap.prototype.$index = function(key) {
  return this._lang_map.$index(key);
}
CopyOnWriteMap.prototype.isEmpty = function() {
  return this._lang_map.isEmpty();
}
CopyOnWriteMap.prototype.get$length = function() {
  return this._lang_map.get$length();
}
CopyOnWriteMap.prototype.forEach = function(f) {
  return this._lang_map.forEach(f);
}
CopyOnWriteMap.prototype.getKeys = function() {
  return this._lang_map.getKeys();
}
CopyOnWriteMap.prototype.getValues = function() {
  return this._lang_map.getValues();
}
CopyOnWriteMap.prototype.containsKey = function(key) {
  return this._lang_map.containsKey(key);
}
CopyOnWriteMap.prototype.containsKey$1 = CopyOnWriteMap.prototype.containsKey;
CopyOnWriteMap.prototype.forEach$1 = function($0) {
  return this.forEach(to$call$2($0));
};
CopyOnWriteMap.prototype.getKeys$0 = CopyOnWriteMap.prototype.getKeys;
CopyOnWriteMap.prototype.getValues$0 = CopyOnWriteMap.prototype.getValues;
CopyOnWriteMap.prototype.isEmpty$0 = CopyOnWriteMap.prototype.isEmpty;
// ********** Code for CopyOnWriteMap_K$V **************
$inherits(CopyOnWriteMap_K$V, CopyOnWriteMap);
function CopyOnWriteMap_K$V() {}
CopyOnWriteMap_K$V._wrap$ctor = function(_map) {
  this._lang_map = _map;
}
CopyOnWriteMap_K$V._wrap$ctor.prototype = CopyOnWriteMap_K$V.prototype;
// ********** Code for CopyOnWriteMap_dart_core_String$Value **************
$inherits(CopyOnWriteMap_dart_core_String$Value, CopyOnWriteMap);
function CopyOnWriteMap_dart_core_String$Value() {
  this._lang_map = new _SharedBackingMap_dart_core_String$Value();
}
CopyOnWriteMap_dart_core_String$Value._wrap$ctor = function(_map) {
  this._lang_map = _map;
}
CopyOnWriteMap_dart_core_String$Value._wrap$ctor.prototype = CopyOnWriteMap_dart_core_String$Value.prototype;
CopyOnWriteMap_dart_core_String$Value.prototype.clone = function() {
  this._lang_map.shared++;
  return new CopyOnWriteMap_dart_core_String$Value._wrap$ctor(this._lang_map);
}
CopyOnWriteMap_dart_core_String$Value.prototype._ensureWritable = function() {
  if (this._lang_map.shared > (0)) {
    this._lang_map.shared--;
    this._lang_map = _SharedBackingMap._SharedBackingMap$from$factory(this._lang_map);
  }
}
CopyOnWriteMap_dart_core_String$Value.prototype.$setindex = function(key, value) {
  this._ensureWritable();
  this._lang_map.$setindex(key, value);
}
CopyOnWriteMap_dart_core_String$Value.prototype.$index = function(key) {
  return this._lang_map.$index(key);
}
CopyOnWriteMap_dart_core_String$Value.prototype.forEach = function(f) {
  return this._lang_map.forEach(f);
}
CopyOnWriteMap_dart_core_String$Value.prototype.containsKey = function(key) {
  return this._lang_map.containsKey(key);
}
// ********** Code for Value **************
function Value(type, code, span, needsTemp, staticType) {
  this.isFinal = false;
  this.isType = false;
  this.needsTemp = needsTemp;
  this.isSuper = false;
  this.staticType = staticType;
  this.type = type;
  this.span = span;
  this.code = code;
  if (this.type == null) $globals.world.internalError("type passed as null", this.span);
  if (this.staticType == null) this.staticType = this.type;
  if ($globals.options.forceDynamic) {
    if (!(this.isSuper || this.get$isConst() || this.get$code() == "this" || this.get$code() == "$this" || (this instanceof BareValue))) {
      this.type = $globals.world.varType;
    }
  }
}
Value.type$ctor = function(type, span) {
  this.isFinal = false;
  this.isType = true;
  this.needsTemp = false;
  this.isSuper = false;
  this.type = type;
  this.span = span;
  this.code = null;
  if (this.type == null) $globals.world.internalError("type passed as null", this.span);
  this.staticType = this.type;
}
Value.type$ctor.prototype = Value.prototype;
Value.prototype.get$staticType = function() { return this.staticType; };
Value.prototype.set$staticType = function(value) { return this.staticType = value; };
Value.prototype.get$type = function() { return this.type; };
Value.prototype.set$type = function(value) { return this.type = value; };
Value.prototype.get$code = function() { return this.code; };
Value.prototype.set$code = function(value) { return this.code = value; };
Value.prototype.get$span = function() { return this.span; };
Value.prototype.set$span = function(value) { return this.span = value; };
Value.prototype.get$isSuper = function() { return this.isSuper; };
Value.prototype.set$isSuper = function(value) { return this.isSuper = value; };
Value.prototype.get$isType = function() { return this.isType; };
Value.prototype.set$isType = function(value) { return this.isType = value; };
Value.prototype.get$isFinal = function() { return this.isFinal; };
Value.prototype.set$isFinal = function(value) { return this.isFinal = value; };
Value.prototype.get$needsTemp = function() { return this.needsTemp; };
Value.prototype.set$needsTemp = function(value) { return this.needsTemp = value; };
Value.union = function(x, y) {
  if (y == null || $eq(x, y)) return x;
  if (x == null) return y;
  var t = Type.union(x.type, y.type);
  var ret = new Value(t, null, null, true);
  ret.set$isSuper(x.isSuper && y.isSuper);
  ret.set$needsTemp(y.needsTemp || y.needsTemp);
  ret.set$isType(x.isType && y.isType);
  return ret;
}
Value.prototype.get$isConst = function() {
  return false;
}
Value.prototype.validateInitialized = function(span) {

}
Value.prototype.clone = function() {
  var v = new Value(this.type, this.get$code(), this.span, this.needsTemp, this.staticType);
  v.set$isSuper(this.isSuper);
  v.set$isType(this.isType);
  v.set$isFinal(this.isFinal);
  return v;
}
Value.prototype.replaceCode = function(code, span, needsTemp, staticType) {
  if (needsTemp == null) needsTemp = this.needsTemp;
  if (staticType == null) staticType = this.staticType;
  var v = new Value(this.type, code, span, needsTemp, staticType);
  v.set$isSuper(this.isSuper);
  v.set$isType(this.isType);
  v.set$isFinal(this.isFinal);
  return v;
}
Value.prototype.get_ = function(context, name, node) {
  var member = this._resolveMember(context, name, node, false);
  if (member != null) {
    return member._get$3(context, node, this);
  }
  else {
    return this.invokeNoSuchMethod(context, ("get:" + name), node);
  }
}
Value.prototype.set_ = function(context, name, node, value, isDynamic) {
  var member = this._resolveMember(context, name, node, isDynamic);
  if (member != null) {
    return member._set$5(context, node, this, value, isDynamic);
  }
  else {
    return this.invokeNoSuchMethod(context, ("set:" + name), node, new Arguments(null, [value]));
  }
}
Value.prototype.unop = function(kind, context, node) {
  switch (kind) {
    case (19):

      var newVal = this.convertTo(context, $globals.world.nonNullBool, false);
      return new Value(newVal.get$type(), ("!" + newVal.get$code()), node.get$span(), true);

    case (42):

      $globals.world.error("no unary add operator in dart", node.get$span());
      break;

    case (43):

      return this.invoke(context, ":negate", node, Arguments.get$EMPTY(), false);

    case (18):

      return this.invoke(context, ":bit_not", node, Arguments.get$EMPTY(), false);

  }
  $globals.world.internalError(("unimplemented: " + node.get$op()), node.get$span());
}
Value.prototype.binop = function(kind, other, context, node) {
  switch (kind) {
    case (35):
    case (34):

      var code = ("" + this.get$code() + " " + node.get$op() + " " + other.get$code());
      return new Value($globals.world.nonNullBool, code, node.get$span(), true);

    case (50):

      return new Value($globals.world.nonNullBool, ("" + this.get$code() + " == " + other.get$code()), node.get$span(), true);

    case (51):

      return new Value($globals.world.nonNullBool, ("" + this.get$code() + " != " + other.get$code()), node.get$span(), true);

  }
  var name = kind == (49) ? ":ne" : TokenKind.binaryMethodName(kind);
  return this.invoke(context, name, node, new Arguments(null, [other]), false);
}
Value.prototype.invoke = function(context, name, node, args, isDynamic) {
  if (name == ":call") {
    if (this.isType) {
      $globals.world.error("must use \"new\" or \"const\" to construct a new instance", node.span);
    }
    if (this.type.needsVarCall(args)) {
      return this._varCall(context, node, args);
    }
  }
  var member = this._resolveMember(context, name, node, isDynamic);
  if (member == null) {
    return this.invokeNoSuchMethod(context, name, node, args);
  }
  else {
    return member.invoke$5(context, node, this, args, isDynamic);
  }
}
Value.prototype.canInvoke = function(context, name, args) {
  if (this.type.get$isVarOrFunction() && name == ":call") {
    return true;
  }
  var member = this._resolveMember(context, name, null, true);
  return member != null && member.canInvoke$2(context, args);
}
Value.prototype._hasOverriddenNoSuchMethod = function() {
  if (this.isSuper) {
    var m = this.staticType.getMember("noSuchMethod");
    return m != null && !m.get$declaringType().get$isObject();
  }
  else {
    var m = this.staticType.resolveMember("noSuchMethod");
    return m != null && m.get$members().get$length() > (1);
  }
}
Value.prototype._tryResolveMember = function(context, resolvetype, name) {
  if (this.isSuper) {
    return resolvetype.getMember(name);
  }
  else {
    return resolvetype.resolveMember(name);
  }
}
Value.prototype._isVarOrParameterType = function(t) {
  return t.get$isVar() || (t instanceof ParameterType);
}
Value.prototype._resolveMember = function(context, name, node, isDynamic) {
  var member;
  if (!this._isVarOrParameterType(this.type)) {
    member = this._tryResolveMember(context, this.type, name);
    if (member == null && $ne(this.type, this.staticType)) {
      member = this._tryResolveMember(context, this.staticType, name);
    }
    if (member != null && this.isType && !member.get$isStatic()) {
      if (!isDynamic) {
        $globals.world.error("can not refer to instance member as static", node.span);
      }
      return null;
    }
    if (member == null && !isDynamic && !this._isVarOrParameterType(this.staticType) && !this._hasOverriddenNoSuchMethod()) {
      var typeName = this.staticType.name;
      if (typeName == null) typeName = this.staticType.get$library().name;
      var message = ("can not resolve \"" + name + "\" on \"" + typeName + "\"");
      if (this.isType) {
        $globals.world.error(message, node.span);
      }
      else {
        $globals.world.warning(message, node.span);
      }
    }
  }
  if (member == null && !this.isSuper && !this.isType) {
    member = context.findMembers(name);
    if (member == null && !isDynamic) {
      var where = "the world";
      if (name.startsWith("_")) {
        where = ("library \"" + context.get$library().name + "\"");
      }
      $globals.world.warning(("" + name + " is not defined anywhere in " + where + "."), node.span);
    }
  }
  return member;
}
Value.prototype.checkFirstClass = function(span) {
  if (this.isType) {
    $globals.world.error("Types are not first class", span);
  }
}
Value.prototype._varCall = function(context, node, args) {
  var stub = $globals.world.functionType.getCallStub(args);
  return stub.invoke$4(context, node, this, args);
}
Value.prototype.needsConversion = function(toType) {
  var c = this.convertTo(null, toType, true);
  return c == null || this.get$code() != c.get$code();
}
Value.prototype.convertTo = function(context, toType, isDynamic) {
  var checked = !isDynamic;
  var callMethod = toType.getCallMethod();
  if (callMethod != null) {
    if (checked && !toType.isAssignable(this.type)) {
      this.convertWarning(toType);
    }
    return this._maybeWrapFunction(toType, callMethod);
  }
  var fromType = this.type;
  if (this.type.get$isVar() && (this.get$code() != "null" || !toType.get$isNullable())) {
    fromType = $globals.world.objectType;
  }
  var bothNum = this.type.get$isNum() && toType.get$isNum();
  if (fromType.isSubtypeOf(toType) || bothNum) {
    return this.changeStaticType(toType);
  }
  if (checked && !toType.isSubtypeOf(this.type)) {
    this.convertWarning(toType);
  }
  if ($globals.options.enableTypeChecks) {
    if (context == null && isDynamic) {
      return null;
    }
    return this._typeAssert(context, toType, isDynamic);
  }
  else {
    return this.changeStaticType(toType);
  }
}
Value.prototype.changeStaticType = function(toType) {
  if ($eq(toType, this.type)) return this;
  var ret = this.clone();
  ret.set$staticType(toType);
  return ret;
}
Value.prototype._maybeWrapFunction = function(toType, callMethod) {
  var arity = callMethod.parameters.get$length();
  var myCall = this.type.getCallMethod();
  var result = this;
  if (myCall == null || $ne(myCall.get$parameters().get$length(), arity)) {
    var stub = $globals.world.functionType.getCallStub(Arguments.Arguments$bare$factory(arity));
    result = new Value(toType, ("to$" + stub.get$name() + "(" + this.get$code() + ")"), this.span, true);
  }
  if (toType.get$library().get$isDom() && !this.type.get$library().get$isDom()) {
    if (arity == (0)) {
      $globals.world.gen.corejs.useWrap0 = true;
    }
    else {
      $globals.world.gen.corejs.useWrap1 = true;
    }
    result = new Value(toType, ("$wrap_call$" + arity + "(" + result.get$code() + ")"), this.span, true);
  }
  if (result == this) result = this.changeStaticType(toType);
  return result;
}
Value.prototype._typeAssert = function(context, toType, isDynamic) {
  if ((toType instanceof ParameterType)) {
    var p = toType;
    toType = p.extendsType;
  }
  if (toType.get$isObject() || toType.get$isVar()) {
    $globals.world.internalError(("We thought " + this.type.name + " is not a subtype of " + toType.name + "?"));
  }
  function throwTypeError(paramName) {
    return $globals.world.withoutForceDynamic((function () {
      var typeErrorCtor = $globals.world.typeErrorType.getConstructor("_internal");
      $globals.world.gen.corejs.ensureTypeNameOf();
      var result = typeErrorCtor.invoke$5(context, null, new Value.type$ctor($globals.world.typeErrorType, null), new Arguments(null, [new Value($globals.world.objectType, paramName, null, true), new Value($globals.world.stringType, ("\"" + toType.name + "\""), null, true)]), isDynamic);
      $globals.world.gen.corejs.useThrow = true;
      return ("$throw(" + result.get$code() + ")");
    })
    );
  }
  if (toType.get$isNum()) toType = $globals.world.numType;
  var check;
  if (toType.get$isVoid()) {
    check = ("$assert_void(" + this.get$code() + ")");
    if (toType.typeCheckCode == null) {
      toType.typeCheckCode = ("function $assert_void(x) {\n  if (x == null) return null;\n  " + throwTypeError("x") + "\n}");
    }
  }
  else if ($eq(toType, $globals.world.nonNullBool)) {
    $globals.world.gen.corejs.useNotNullBool = true;
    check = ("$notnull_bool(" + this.get$code() + ")");
  }
  else if (toType.get$library().get$isCore() && toType.get$typeofName() != null) {
    check = ("$assert_" + toType.name + "(" + this.get$code() + ")");
    if (toType.typeCheckCode == null) {
      toType.typeCheckCode = ("function $assert_" + toType.name + "(x) {\n  if (x == null || typeof(x) == \"" + toType.get$typeofName() + "\") return x;\n  " + throwTypeError("x") + "\n}");
    }
  }
  else {
    toType.isChecked = true;
    var checkName = "assert$" + toType.get$jsname();
    var temp = context.getTemp(this);
    check = ("(" + context.assignTemp(temp, this).get$code() + " == null ? null :");
    check = check + (" " + temp.get$code() + "." + checkName + "())");
    if ($ne(this, temp)) context.freeTemp(temp);
    $globals.world.objectType.varStubs.putIfAbsent(checkName, (function () {
      return new VarMethodStub(checkName, null, Arguments.get$EMPTY(), throwTypeError("this"));
    })
    );
  }
  context.counters.typeAsserts++;
  return new Value(toType, check, this.span, true);
}
Value.prototype.instanceOf = function(context, toType, span, isTrue, forceCheck) {
  if (toType.get$isVar()) {
    $globals.world.error("can not resolve type", span);
  }
  var testCode = null;
  if (toType.get$isVar() || toType.get$isObject() || (toType instanceof ParameterType)) {
    if (this.needsTemp) {
      return new Value($globals.world.nonNullBool, ("(" + this.get$code() + ", true)"), span, true);
    }
    else {
      return Value.fromBool(true, span);
    }
  }
  if (toType.get$library().get$isCore()) {
    var typeofName = toType.get$typeofName();
    if (typeofName != null) {
      testCode = ("(typeof(" + this.get$code() + ") " + (isTrue ? "==" : "!=") + " '" + typeofName + "')");
    }
  }
  if (toType.get$isClass() && !(toType instanceof ConcreteType) && !toType.get$isHiddenNativeType()) {
    toType.markUsed();
    testCode = ("(" + this.get$code() + " instanceof " + toType.get$jsname() + ")");
    if (!isTrue) {
      testCode = "!" + testCode;
    }
  }
  if (testCode == null) {
    toType.isTested = true;
    var temp = context.getTemp(this);
    var checkName = ("is$" + toType.get$jsname());
    testCode = ("(" + context.assignTemp(temp, this).get$code() + " &&");
    testCode = testCode + (" " + temp.get$code() + "." + checkName + "())");
    if (isTrue) {
      testCode = "!!" + testCode;
    }
    else {
      testCode = "!" + testCode;
    }
    if ($ne(this, temp)) context.freeTemp(temp);
    if (!$globals.world.objectType.varStubs.containsKey(checkName)) {
      $globals.world.objectType.varStubs.$setindex(checkName, new VarMethodStub(checkName, null, Arguments.get$EMPTY(), "return false"));
    }
  }
  return new Value($globals.world.nonNullBool, testCode, span, true);
}
Value.prototype.convertWarning = function(toType) {
  $globals.world.warning(("type \"" + this.type.name + "\" is not assignable to \"" + toType.name + "\""), this.span);
}
Value.prototype.invokeNoSuchMethod = function(context, name, node, args) {
  var pos = "";
  if (args != null) {
    var argsCode = [];
    for (var i = (0);
     i < args.get$length(); i++) {
      argsCode.add$1(args.values.$index(i).get$code());
    }
    pos = Strings.join(argsCode, ", ");
  }
  var noSuchArgs = [new Value($globals.world.stringType, ("\"" + name + "\""), node.span, true), new Value($globals.world.listType, ("[" + pos + "]"), node.span, true)];
  return this._resolveMember(context, "noSuchMethod", node, false).invoke$4(context, node, this, new Arguments(null, noSuchArgs));
}
Value.fromBool = function(value, span) {
  return new BoolValue(value, true, span);
}
Value.fromInt = function(value, span) {
  return new IntValue(value, true, span);
}
Value.fromDouble = function(value, span) {
  return new DoubleValue(value, true, span);
}
Value.fromString = function(value, span) {
  return new StringValue(value, true, span);
}
Value.fromNull = function(span) {
  return new NullValue(true, span);
}
Value.prototype.binop$4 = Value.prototype.binop;
Value.prototype.checkFirstClass$1 = Value.prototype.checkFirstClass;
Value.prototype.convertTo$2 = function($0, $1) {
  return this.convertTo($0, $1, false);
};
Value.prototype.convertTo$3 = Value.prototype.convertTo;
Value.prototype.get_$3 = Value.prototype.get_;
Value.prototype.instanceOf$3$isTrue$forceCheck = Value.prototype.instanceOf;
Value.prototype.instanceOf$4 = function($0, $1, $2, $3) {
  return this.instanceOf($0, $1, $2, $3, false);
};
Value.prototype.invoke$4 = function($0, $1, $2, $3) {
  return this.invoke($0, $1, $2, $3, false);
};
Value.prototype.invoke$4$isDynamic = Value.prototype.invoke;
Value.prototype.invoke$5 = Value.prototype.invoke;
Value.prototype.invokeNoSuchMethod$4 = Value.prototype.invokeNoSuchMethod;
Value.prototype.needsConversion$1 = Value.prototype.needsConversion;
Value.prototype.set_$4 = function($0, $1, $2, $3) {
  return this.set_($0, $1, $2, $3, false);
};
Value.prototype.unop$3 = Value.prototype.unop;
// ********** Code for EvaluatedValue **************
$inherits(EvaluatedValue, Value);
function EvaluatedValue(isConst, type, span) {
  this.isConst = isConst;
  Value.call(this, type, "@@@", span, false);
}
EvaluatedValue.prototype.get$isConst = function() { return this.isConst; };
EvaluatedValue.prototype.set$isConst = function(value) { return this.isConst = value; };
EvaluatedValue.prototype.get$code = function() {
  $globals.world.internalError("Should not be getting code from raw EvaluatedValue", this.span);
}
EvaluatedValue.prototype.hashCode = function() {
  return this.get$code().hashCode();
}
EvaluatedValue.prototype.$eq = function(other) {
  return (other instanceof EvaluatedValue) && $eq(other.get$type(), this.type) && $eq(other.get$code(), this.get$code());
}
EvaluatedValue.prototype.hashCode$0 = EvaluatedValue.prototype.hashCode;
// ********** Code for NullValue **************
$inherits(NullValue, EvaluatedValue);
function NullValue(isConst, span) {
  EvaluatedValue.call(this, isConst, $globals.world.varType, span);
}
NullValue.prototype.get$actualValue = function() {
  return null;
}
NullValue.prototype.get$code = function() {
  return "null";
}
NullValue.prototype.binop = function(kind, other, context, node) {
  if (!(other instanceof NullValue)) return Value.prototype.binop.call(this, kind, other, context, node);
  var c = this.isConst && other.get$isConst();
  var s = node.get$span();
  switch (kind) {
    case (50):
    case (48):

      return new BoolValue(true, c, s);

    case (51):
    case (49):

      return new BoolValue(false, c, s);

  }
  return Value.prototype.binop.call(this, kind, other, context, node);
}
NullValue.prototype.binop$4 = NullValue.prototype.binop;
// ********** Code for BoolValue **************
$inherits(BoolValue, EvaluatedValue);
function BoolValue(actualValue, isConst, span) {
  this.actualValue = actualValue;
  EvaluatedValue.call(this, isConst, $globals.world.nonNullBool, span);
}
BoolValue.prototype.get$actualValue = function() { return this.actualValue; };
BoolValue.prototype.set$actualValue = function(value) { return this.actualValue = value; };
BoolValue.prototype.clone = function() {
  return new BoolValue(this.actualValue, this.isConst, this.span);
}
BoolValue.prototype.get$code = function() {
  return this.actualValue ? "true" : "false";
}
BoolValue.prototype.unop = function(kind, context, node) {
  switch (kind) {
    case (19):

      return new BoolValue(!this.actualValue, this.isConst, node.get$span());

  }
  return Value.prototype.unop.call(this, kind, context, node);
}
BoolValue.prototype.binop = function(kind, other, context, node) {
  if (!(other instanceof BoolValue)) return Value.prototype.binop.call(this, kind, other, context, node);
  var c = this.isConst && other.get$isConst();
  var s = node.get$span();
  var x = this.actualValue, y = other.get$actualValue();
  switch (kind) {
    case (50):
    case (48):

      return new BoolValue($eq(x, y), c, s);

    case (51):
    case (49):

      return new BoolValue($ne(x, y), c, s);

    case (35):

      return new BoolValue(x && y, c, s);

    case (34):

      return new BoolValue(x || y, c, s);

  }
  return Value.prototype.binop.call(this, kind, other, context, node);
}
BoolValue.prototype.binop$4 = BoolValue.prototype.binop;
BoolValue.prototype.unop$3 = BoolValue.prototype.unop;
// ********** Code for IntValue **************
$inherits(IntValue, EvaluatedValue);
function IntValue(actualValue, isConst, span) {
  this.actualValue = actualValue;
  EvaluatedValue.call(this, isConst, $globals.world.intType, span);
}
IntValue.prototype.get$actualValue = function() { return this.actualValue; };
IntValue.prototype.set$actualValue = function(value) { return this.actualValue = value; };
IntValue.prototype.clone = function() {
  return new IntValue(this.actualValue, this.isConst, this.span);
}
IntValue.prototype.get$code = function() {
  return ("(" + this.actualValue + ")");
}
IntValue.prototype.unop = function(kind, context, node) {
  switch (kind) {
    case (42):

      return new IntValue(this.actualValue, this.isConst, this.span);

    case (43):

      return new IntValue(-this.actualValue, this.isConst, this.span);

    case (18):

      return new IntValue(~this.actualValue, this.isConst, this.span);

  }
  return Value.prototype.unop.call(this, kind, context, node);
}
IntValue.prototype.binop = function(kind, other, context, node) {
  var c = this.isConst && other.get$isConst();
  var s = node.get$span();
  if ((other instanceof IntValue)) {
    var x = this.actualValue;
    var y = other.get$actualValue();
    switch (kind) {
      case (50):
      case (48):

        return new BoolValue(x == y, c, s);

      case (51):
      case (49):

        return new BoolValue(x != y, c, s);

      case (36):

        return new IntValue(x | y, c, s);

      case (37):

        return new IntValue(x ^ y, c, s);

      case (38):

        return new IntValue(x & y, c, s);

      case (39):

        return new IntValue(x << y, c, s);

      case (40):

        return new IntValue(x >> y, c, s);

      case (41):

        return new IntValue(x >>> y, c, s);

      case (42):

        return new IntValue(x + y, c, s);

      case (43):

        return new IntValue(x - y, c, s);

      case (44):

        return new IntValue(x * y, c, s);

      case (45):

        return new DoubleValue(x / y, c, s);

      case (46):

        return new IntValue($truncdiv(x, y), c, s);

      case (47):

        return new IntValue($mod(x, y), c, s);

      case (52):

        return new BoolValue(x < y, c, s);

      case (53):

        return new BoolValue(x > y, c, s);

      case (54):

        return new BoolValue(x <= y, c, s);

      case (55):

        return new BoolValue(x >= y, c, s);

    }
  }
  else if ((other instanceof DoubleValue)) {
    var x = this.actualValue;
    var y = other.get$actualValue();
    switch (kind) {
      case (50):
      case (48):

        return new BoolValue(x == y, c, s);

      case (51):
      case (49):

        return new BoolValue(x != y, c, s);

      case (42):

        return new DoubleValue(x + y, c, s);

      case (43):

        return new DoubleValue(x - y, c, s);

      case (44):

        return new DoubleValue(x * y, c, s);

      case (45):

        return new DoubleValue(x / y, c, s);

      case (46):

        return new DoubleValue($truncdiv(x, y), c, s);

      case (47):

        return new DoubleValue($mod(x, y), c, s);

      case (52):

        return new BoolValue(x < y, c, s);

      case (53):

        return new BoolValue(x > y, c, s);

      case (54):

        return new BoolValue(x <= y, c, s);

      case (55):

        return new BoolValue(x >= y, c, s);

    }
  }
  return Value.prototype.binop.call(this, kind, other, context, node);
}
IntValue.prototype.binop$4 = IntValue.prototype.binop;
IntValue.prototype.unop$3 = IntValue.prototype.unop;
// ********** Code for DoubleValue **************
$inherits(DoubleValue, EvaluatedValue);
function DoubleValue(actualValue, isConst, span) {
  this.actualValue = actualValue;
  EvaluatedValue.call(this, isConst, $globals.world.doubleType, span);
}
DoubleValue.prototype.get$actualValue = function() { return this.actualValue; };
DoubleValue.prototype.set$actualValue = function(value) { return this.actualValue = value; };
DoubleValue.prototype.clone = function() {
  return new DoubleValue(this.actualValue, this.isConst, this.span);
}
DoubleValue.prototype.get$code = function() {
  return ("(" + this.actualValue + ")");
}
DoubleValue.prototype.unop = function(kind, context, node) {
  switch (kind) {
    case (42):

      return new DoubleValue(this.actualValue, this.isConst, this.span);

    case (43):

      return new DoubleValue(-this.actualValue, this.isConst, this.span);

  }
  return Value.prototype.unop.call(this, kind, context, node);
}
DoubleValue.prototype.binop = function(kind, other, context, node) {
  var c = this.isConst && other.get$isConst();
  var s = node.get$span();
  if ((other instanceof DoubleValue)) {
    var x = this.actualValue;
    var y = other.get$actualValue();
    switch (kind) {
      case (50):
      case (48):

        return new BoolValue(x == y, c, s);

      case (51):
      case (49):

        return new BoolValue(x != y, c, s);

      case (42):

        return new DoubleValue(x + y, c, s);

      case (43):

        return new DoubleValue(x - y, c, s);

      case (44):

        return new DoubleValue(x * y, c, s);

      case (45):

        return new DoubleValue(x / y, c, s);

      case (46):

        return new DoubleValue($truncdiv(x, y), c, s);

      case (47):

        return new DoubleValue($mod(x, y), c, s);

      case (52):

        return new BoolValue(x < y, c, s);

      case (53):

        return new BoolValue(x > y, c, s);

      case (54):

        return new BoolValue(x <= y, c, s);

      case (55):

        return new BoolValue(x >= y, c, s);

    }
  }
  else if ((other instanceof IntValue)) {
    var x = this.actualValue;
    var y = other.get$actualValue();
    switch (kind) {
      case (50):
      case (48):

        return new BoolValue(x == y, c, s);

      case (51):
      case (49):

        return new BoolValue(x != y, c, s);

      case (42):

        return new DoubleValue(x + y, c, s);

      case (43):

        return new DoubleValue(x - y, c, s);

      case (44):

        return new DoubleValue(x * y, c, s);

      case (45):

        return new DoubleValue(x / y, c, s);

      case (46):

        return new DoubleValue($truncdiv(x, y), c, s);

      case (47):

        return new DoubleValue($mod(x, y), c, s);

      case (52):

        return new BoolValue(x < y, c, s);

      case (53):

        return new BoolValue(x > y, c, s);

      case (54):

        return new BoolValue(x <= y, c, s);

      case (55):

        return new BoolValue(x >= y, c, s);

    }
  }
  return Value.prototype.binop.call(this, kind, other, context, node);
}
DoubleValue.prototype.binop$4 = DoubleValue.prototype.binop;
DoubleValue.prototype.unop$3 = DoubleValue.prototype.unop;
// ********** Code for StringValue **************
$inherits(StringValue, EvaluatedValue);
function StringValue(actualValue, isConst, span) {
  this.actualValue = actualValue;
  EvaluatedValue.call(this, isConst, $globals.world.stringType, span);
}
StringValue.prototype.get$actualValue = function() { return this.actualValue; };
StringValue.prototype.set$actualValue = function(value) { return this.actualValue = value; };
StringValue.prototype.clone = function() {
  return new StringValue(this.actualValue, this.isConst, this.span);
}
StringValue.prototype.binop = function(kind, other, context, node) {
  if (!(other instanceof StringValue)) return Value.prototype.binop.call(this, kind, other, context, node);
  var c = this.isConst && other.get$isConst();
  var s = node.get$span();
  var x = this.actualValue, y = other.get$actualValue();
  switch (kind) {
    case (50):
    case (48):

      return new BoolValue(x == y, c, s);

    case (51):
    case (49):

      return new BoolValue(x != y, c, s);

    case (42):

      return new StringValue(x + y, c, s);

  }
  return Value.prototype.binop.call(this, kind, other, context, node);
}
StringValue.prototype.get$code = function() {
  var buf = new StringBufferImpl("");
  buf.add("\"");
  for (var i = (0);
   i < this.actualValue.length; i++) {
    var ch = this.actualValue.charCodeAt(i);
    switch (ch) {
      case (9):

        buf.add("\\t");
        break;

      case (10):

        buf.add("\\n");
        break;

      case (13):

        buf.add("\\r");
        break;

      case (34):

        buf.add("\\\"");
        break;

      case (92):

        buf.add("\\\\");
        break;

      default:

        if (ch >= (32) && ch <= (126)) {
          buf.add(this.actualValue[i]);
        }
        else {
          var hex = ch.toRadixString$1((16));
          switch (hex.get$length()) {
            case (1):

              buf.add("\\x0");
              buf.add(hex);
              break;

            case (2):

              buf.add("\\x");
              buf.add(hex);
              break;

            case (3):

              buf.add("\\u0");
              buf.add(hex);
              break;

            case (4):

              buf.add("\\u");
              buf.add(hex);
              break;

            default:

              $globals.world.internalError("unicode values greater than 2 bytes not implemented");
              break;

          }
        }
        break;

    }
  }
  buf.add("\"");
  return buf.toString();
}
StringValue.prototype.binop$4 = StringValue.prototype.binop;
// ********** Code for ListValue **************
$inherits(ListValue, EvaluatedValue);
function ListValue(values, isConst, type, span) {
  this.values = values;
  EvaluatedValue.call(this, isConst, type, span);
}
ListValue.prototype.clone = function() {
  return new ListValue(this.values, this.isConst, this.type, this.span);
}
ListValue.prototype.get$code = function() {
  var buf = new StringBufferImpl("");
  buf.add$1("[");
  for (var i = (0);
   i < this.values.get$length(); i = i + (1)) {
    if (i > (0)) buf.add$1(", ");
    buf.add$1(this.values.$index(i).get$code());
  }
  buf.add$1("]");
  var listCode = buf.toString$0();
  if (!this.isConst) return listCode;
  var v = new Value($globals.world.listType, listCode, this.span, true);
  var immutableListCtor = $globals.world.immutableListType.getConstructor("from");
  var result = immutableListCtor.invoke$4(null, null, new Value.type$ctor(v.get$type(), this.span), new Arguments(null, [v]));
  return result.get$code();
}
ListValue.prototype.binop = function(kind, other, context, node) {
  if (!(other instanceof ListValue)) return Value.prototype.binop.call(this, kind, other, context, node);
  switch (kind) {
    case (50):

      return new BoolValue($eq(this.type, other.get$type()) && this.get$code() == other.get$code(), this.isConst && other.get$isConst(), node.get$span());

    case (51):

      return new BoolValue($ne(this.type, other.get$type()) || this.get$code() != other.get$code(), this.isConst && other.get$isConst(), node.get$span());

  }
  return Value.prototype.binop.call(this, kind, other, context, node);
}
ListValue.prototype.getGlobalValue = function() {
  return $globals.world.gen.globalForConst(this, this.values);
}
ListValue.prototype.binop$4 = ListValue.prototype.binop;
ListValue.prototype.getGlobalValue$0 = ListValue.prototype.getGlobalValue;
// ********** Code for MapValue **************
$inherits(MapValue, EvaluatedValue);
function MapValue(values, isConst, type, span) {
  this.values = values;
  EvaluatedValue.call(this, isConst, type, span);
}
MapValue.prototype.clone = function() {
  return new MapValue(this.values, this.isConst, this.type, this.span);
}
MapValue.prototype.get$code = function() {
  var items = new ListValue(this.values, false, $globals.world.listType, this.span);
  var tp = $globals.world.coreimpl.topType;
  var f = this.isConst ? tp.getMember$1("_constMap") : tp.getMember$1("_map");
  var value = f.invoke(null, null, new Value.type$ctor(tp, null), new Arguments(null, [items]), false);
  return value.get$code();
}
MapValue.prototype.getGlobalValue = function() {
  return $globals.world.gen.globalForConst(this, this.values);
}
MapValue.prototype.binop = function(kind, other, context, node) {
  if (!(other instanceof MapValue)) return Value.prototype.binop.call(this, kind, other, context, node);
  switch (kind) {
    case (50):

      return new BoolValue($eq(this.type, other.get$type()) && this.get$code() == other.get$code(), this.isConst && other.get$isConst(), node.get$span());

    case (51):

      return new BoolValue($ne(this.type, other.get$type()) || this.get$code() != other.get$code(), this.isConst && other.get$isConst(), node.get$span());

  }
  return Value.prototype.binop.call(this, kind, other, context, node);
}
MapValue.prototype.binop$4 = MapValue.prototype.binop;
MapValue.prototype.getGlobalValue$0 = MapValue.prototype.getGlobalValue;
// ********** Code for ObjectValue **************
$inherits(ObjectValue, EvaluatedValue);
function ObjectValue(isConst, type, span) {
  this.seenNativeInitializer = false;
  this.fields = new HashMapImplementation();
  EvaluatedValue.call(this, isConst, type, span);
}
ObjectValue.prototype.get$fields = function() { return this.fields; };
ObjectValue.prototype.set$fields = function(value) { return this.fields = value; };
ObjectValue.prototype.get$seenNativeInitializer = function() { return this.seenNativeInitializer; };
ObjectValue.prototype.set$seenNativeInitializer = function(value) { return this.seenNativeInitializer = value; };
ObjectValue.prototype.get$code = function() {
  if (this._code == null) this.validateInitialized(null);
  return this._code;
}
ObjectValue.prototype.initFields = function() {
  var allMembers = $globals.world.gen._orderValues(this.type.getAllMembers());
  for (var $$i = allMembers.iterator$0(); $$i.hasNext$0(); ) {
    var f = $$i.next$0();
    if (f.get$isField() && !f.get$isStatic() && f.get$declaringType().get$isClass()) {
      this.fields.$setindex(f, f.computeValue$0());
    }
  }
}
ObjectValue.prototype.setField = function(field, value, duringInit) {
  var currentValue = this.fields.$index(field);
  if (this.isConst && !value.get$isConst()) {
    $globals.world.error("used of non-const value in const intializer", value.span);
  }
  if (currentValue == null) {
    this.fields.$setindex(field, value);
    if (field.get$isFinal() && !duringInit) {
      $globals.world.error("can not initialize final fields outside of initializer", value.span);
    }
  }
  else {
    if (field.get$isFinal() && field.computeValue() == null) {
      $globals.world.error("reassignment of field not allowed", value.span, field.get$span());
    }
    else {
      this.fields.$setindex(field, value);
    }
  }
}
ObjectValue.prototype.validateInitialized = function(span) {
  var buf = new StringBufferImpl("");
  buf.add$1("Object.create(");
  buf.add$1(("" + this.type.get$jsname() + ".prototype, "));
  buf.add$1("{");
  var $$list = this.fields.getKeys();
  for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
    var field = $$i.next$0();
    buf.add$1(field.get$name());
    buf.add$1(": ");
    buf.add$1("{\"value\": ");
    if (this.fields.$index(field) == null) {
      $globals.world.error(("Required field \"" + field.get$name() + "\" was not initialized"), span, field.get$span());
      buf.add$1("null");
    }
    else {
      buf.add$1(this.fields.$index(field).get$code());
    }
    buf.add$1(", writeable: false}, ");
  }
  buf.add$1("})");
  this._code = buf.toString$0();
}
ObjectValue.prototype.binop = function(kind, other, context, node) {
  if (!(other instanceof ObjectValue)) return Value.prototype.binop.call(this, kind, other, context, node);
  switch (kind) {
    case (50):
    case (48):

      return new BoolValue($eq(this.type, other.get$type()) && this.get$code() == other.get$code(), this.isConst && other.get$isConst(), node.get$span());

    case (51):
    case (49):

      return new BoolValue($ne(this.type, other.get$type()) || this.get$code() != other.get$code(), this.isConst && other.get$isConst(), node.get$span());

  }
  return Value.prototype.binop.call(this, kind, other, context, node);
}
ObjectValue.prototype.binop$4 = ObjectValue.prototype.binop;
ObjectValue.prototype.initFields$0 = ObjectValue.prototype.initFields;
// ********** Code for GlobalValue **************
$inherits(GlobalValue, Value);
function GlobalValue(type, code, isConst, field, name, exp, span, deps, walkDeps) {
  this.exp = exp;
  this.field = field;
  this.name = name;
  this.isConst = isConst;
  Value.call(this, type, code, span, !isConst);
  if (walkDeps) {
    this.dependencies = [];
    for (var $$i = 0;$$i < deps.get$length(); $$i++) {
      var dep = deps.$index($$i);
      if ((dep instanceof GlobalValue)) {
        this.dependencies.add(dep);
        this.dependencies.addAll(dep.get$dependencies());
      }
    }
  }
  else {
    this.dependencies = deps;
  }
}
GlobalValue.prototype.get$field = function() { return this.field; };
GlobalValue.prototype.set$field = function(value) { return this.field = value; };
GlobalValue.prototype.get$name = function() { return this.name; };
GlobalValue.prototype.set$name = function(value) { return this.name = value; };
GlobalValue.prototype.get$exp = function() { return this.exp; };
GlobalValue.prototype.set$exp = function(value) { return this.exp = value; };
GlobalValue.prototype.get$isConst = function() { return this.isConst; };
GlobalValue.prototype.set$isConst = function(value) { return this.isConst = value; };
GlobalValue.prototype.get$actualValue = function() {
  return this.exp.get$dynamic().get$actualValue();
}
GlobalValue.prototype.get$dependencies = function() { return this.dependencies; };
GlobalValue.prototype.set$dependencies = function(value) { return this.dependencies = value; };
GlobalValue.prototype.clone = function() {
  return new GlobalValue(this.type, this.code, this.isConst, this.field, this.name, this.exp, this.span, this.dependencies, false);
}
GlobalValue.prototype.compareTo = function(other) {
  if ($eq(other, this)) {
    return (0);
  }
  else if (this.dependencies.indexOf(other) >= (0)) {
    return (1);
  }
  else if (other.dependencies.indexOf(this) >= (0)) {
    return (-1);
  }
  else if (this.dependencies.get$length() > other.dependencies.get$length()) {
    return (1);
  }
  else if (this.dependencies.get$length() < other.dependencies.get$length()) {
    return (-1);
  }
  else if (this.name == null && other.name != null) {
    return (1);
  }
  else if (this.name != null && other.name == null) {
    return (-1);
  }
  else if (this.name != null) {
    return this.name.compareTo(other.name);
  }
  else {
    return this.field.name.compareTo(other.field.name);
  }
}
GlobalValue.prototype.compareTo$1 = GlobalValue.prototype.compareTo;
// ********** Code for BareValue **************
$inherits(BareValue, Value);
function BareValue(home, outermost, span) {
  this.home = home;
  Value.call(this, outermost.method.declaringType, null, span, false);
  this.isType = outermost.get$isStatic();
}
BareValue.prototype.clone = function() {
  return new BareValue(this.home, this.home._getOutermostMethod(), this.span);
}
BareValue.prototype._ensureCode = function() {
  if (this.code != null) return;
  if (this.isType) {
    this.code = this.type.get$jsname();
  }
  else {
    this.code = this.home._makeThisCode();
  }
}
BareValue.prototype._tryResolveMember = function(context, resolveType, name) {
  var member = resolveType.resolveMember(name);
  if (member != null) {
    if ($globals.options.forceDynamic && !member.get$isStatic()) {
      member = context.findMembers(name);
    }
    this._ensureCode();
    return member;
  }
  member = this.home.get$library().lookup(name, this.span);
  if (member != null) {
    return member;
  }
  this._ensureCode();
  return null;
}
// ********** Code for CompilerException **************
function CompilerException(_message, _location) {
  this._lang_message = _message;
  this._location = _location;
}
CompilerException.prototype.toString = function() {
  if (this._location != null) {
    return ("CompilerException: " + this._location.toMessageString(this._lang_message));
  }
  else {
    return ("CompilerException: " + this._lang_message);
  }
}
CompilerException.prototype.toString$0 = CompilerException.prototype.toString;
// ********** Code for CounterLog **************
function CounterLog() {
  this.objectProtoMembers = (0);
  this.dynamicMethodCalls = (0);
  this.typeAsserts = (0);
}
CounterLog.prototype.info = function() {
  $globals.world.info(("Dynamically typed method calls: " + this.dynamicMethodCalls));
  $globals.world.info(("Generated type assertions: " + this.typeAsserts));
  $globals.world.info(("Members on Object.prototype: " + this.objectProtoMembers));
}
CounterLog.prototype.add = function(other) {
  this.dynamicMethodCalls += other.dynamicMethodCalls;
  this.typeAsserts += other.typeAsserts;
  this.objectProtoMembers += other.objectProtoMembers;
}
CounterLog.prototype.add$1 = CounterLog.prototype.add;
// ********** Code for World **************
function World(files) {
  this.files = files;
  this._members = new HashMapImplementation();
  this._topNames = new HashMapImplementation();
  this.warnings = (0);
  this.seenFatal = false;
  this.libraries = new HashMapImplementation();
  this.dartBytesRead = (0);
  this._todo = [];
  this.jsBytesWritten = (0);
  this.counters = new CounterLog();
  this.errors = (0);
  this.reader = new LibraryReader();
}
World.prototype.get$functionType = function() { return this.functionType; };
World.prototype.set$functionType = function(value) { return this.functionType = value; };
World.prototype.init = function() {
  this.corelib = new Library(this.readFile("dart:core"));
  this.libraries.$setindex("dart:core", this.corelib);
  this._todo.add(this.corelib);
  this.coreimpl = this.getOrAddLibrary("dart:coreimpl");
  this.voidType = this.corelib.addType("void", null, false);
  this.dynamicType = this.corelib.addType("Dynamic", null, false);
  this.varType = this.dynamicType;
  this.objectType = this.corelib.addType("Object", null, true);
  this.numType = this.corelib.addType("num", null, false);
  this.intType = this.corelib.addType("int", null, false);
  this.doubleType = this.corelib.addType("double", null, false);
  this.boolType = this.corelib.addType("bool", null, false);
  this.stringType = this.corelib.addType("String", null, false);
  this.listType = this.corelib.addType("List", null, false);
  this.mapType = this.corelib.addType("Map", null, false);
  this.functionType = this.corelib.addType("Function", null, false);
  this.typeErrorType = this.corelib.addType("TypeError", null, false);
  this.numImplType = this.coreimpl.addType("NumImplementation", null, true);
  this.stringImplType = this.coreimpl.addType("StringImplementation", null, true);
  this.immutableListType = this.coreimpl.addType("ImmutableList", null, true);
  this.listFactoryType = this.coreimpl.addType("ListFactory", null, true);
  this.functionImplType = this.coreimpl.addType("_FunctionImplementation", null, true);
  this.nonNullBool = new NonNullableType(this.boolType);
}
World.prototype._addMember = function(member) {
  if (member.get$isStatic()) {
    if (member.declaringType.get$isTop()) {
      this._addTopName(member);
    }
    return;
  }
  var mset = this._members.$index(member.name);
  if (mset == null) {
    mset = new MemberSet(member, true);
    this._members.$setindex(mset.get$name(), mset);
  }
  else {
    mset.get$members().add$1(member);
  }
}
World.prototype._addTopName = function(named) {
  if ((named instanceof Type) && named.get$isNative()) {
    this._addJavascriptTopName(named, named.get$nativeName());
  }
  this._addJavascriptTopName(named, named.get$jsname());
}
World.prototype._addJavascriptTopName = function(named, name) {
  var existing = this._topNames.$index(name);
  if (existing == named) {
    if (named.get$avoidNativeName()) {
      this._renameJavascriptTopName(named);
    }
  }
  else if (existing != null) {
    this.info(("mangling matching top level name \"" + named.get$jsname() + "\" in ") + ("both \"" + named.get$library().get$jsname() + "\" and \"" + existing.get$library().get$jsname() + "\""));
    var existingPri = existing.get$jsnamePriority();
    var namedPri = named.get$jsnamePriority();
    if (existingPri > namedPri || namedPri == (0)) {
      this._renameJavascriptTopName(named);
    }
    else if (namedPri > existingPri) {
      this._renameJavascriptTopName(existing);
    }
    else {
      var msg = ("conflicting JS name \"" + name + "\" of same ") + ("priority " + existingPri + ": (already defined in) ") + ("" + existing.get$span().get$locationText() + " with priority " + namedPri + ")");
      if (named.get$isNative()) {
        $globals.world.info(msg, named.get$span(), existing.get$span());
      }
      else {
        $globals.world.internalError(msg, named.get$span(), existing.get$span());
      }
    }
  }
  else {
    this._topNames.$setindex(name, named);
  }
}
World.prototype._renameJavascriptTopName = function(named) {
  named._jsname = ("" + named.get$library().get$jsname() + "_" + named.get$jsname());
  var existing = this._topNames.$index(named.get$jsname());
  if (existing != null && $ne(existing, named)) {
    $globals.world.internalError(("name mangling failed for \"" + named.get$jsname() + "\" ") + ("(\"" + named.get$jsname() + "\" defined also in " + existing.get$span().get$locationText() + ")"), named.get$span());
  }
  this._topNames.$setindex(named.get$jsname(), named);
}
World.prototype._addType = function(type) {
  if (!type.get$isTop()) this._addTopName(type);
}
World.prototype.toJsIdentifier = function(name) {
  if (name == null) return null;
  if (this._jsKeywords == null) {
    this._jsKeywords = HashSetImplementation.HashSetImplementation$from$factory(["break", "case", "catch", "continue", "debugger", "default", "delete", "do", "else", "finally", "for", "function", "if", "in", "instanceof", "new", "return", "switch", "this", "throw", "try", "typeof", "var", "void", "while", "with", "class", "enum", "export", "extends", "import", "super", "implements", "interface", "let", "package", "private", "protected", "public", "static", "yield", "native"]);
  }
  if (this._jsKeywords.contains(name)) {
    return name + "_";
  }
  else {
    return name.replaceAll("$", "$$").replaceAll(":", "$");
  }
}
World.prototype.compileAndSave = function() {
  var success = this.compile();
  if ($globals.options.outfile != null) {
    if (success) {
      var code = $globals.world.getGeneratedCode();
      if (!$globals.options.outfile.endsWith(".js")) {
        code = "#!/usr/bin/env node\n" + code;
      }
      $globals.world.files.writeString($globals.options.outfile, code);
    }
    else {
      $globals.world.files.writeString($globals.options.outfile, "throw 'Sorry, but I could not generate reasonable code to run.\\n';");
    }
  }
  return success;
}
World.prototype.compile = function() {
  if ($globals.options.dartScript == null) {
    this.fatal("no script provided to compile");
    return false;
  }
  try {
    this.info(("compiling " + $globals.options.dartScript + " with corelib " + this.corelib));
    if (!this.runLeg()) this.runCompilationPhases();
  } catch (exc) {
    exc = _toDartException(exc);
    if (this.get$hasErrors() && !$globals.options.throwOnErrors) {
    }
    else {
      throw exc;
    }
  }
  this.printStatus();
  return !this.get$hasErrors();
}
World.prototype.runLeg = function() {
  var $this = this; // closure support
  if (!$globals.options.enableLeg) return false;
  if ($globals.legCompile == null) {
    this.fatal("requested leg enabled, but no leg compiler available");
  }
  var res = this.withTiming("try leg compile", (function () {
    return $globals.legCompile($this);
  })
  );
  if (!res && $globals.options.legOnly) {
    this.fatal(("Leg could not compile " + $globals.options.dartScript));
    return true;
  }
  return res;
}
World.prototype.runCompilationPhases = function() {
  var $this = this; // closure support
  var lib = this.withTiming("first pass", (function () {
    return $this.processDartScript();
  })
  );
  this.withTiming("resolve top level", this.get$resolveAll());
  if ($globals.experimentalAwaitPhase != null) {
    this.withTiming("await translation", to$call$0($globals.experimentalAwaitPhase));
  }
  this.withTiming("generate code", (function () {
    $this.generateCode(lib);
  })
  );
}
World.prototype.getGeneratedCode = function() {
  if (this.legCode != null) {
    return this.legCode;
  }
  else {
    return this.frogCode;
  }
}
World.prototype.readFile = function(filename) {
  try {
    var sourceFile = this.reader.readFile(filename);
    this.dartBytesRead = this.dartBytesRead + sourceFile.get$text().get$length();
    return sourceFile;
  } catch (e) {
    e = _toDartException(e);
    this.warning(("Error reading file: " + filename));
    return new SourceFile(filename, "");
  }
}
World.prototype.getOrAddLibrary = function(filename) {
  var library = this.libraries.$index(filename);
  if (library == null) {
    library = new Library(this.readFile(filename));
    this.info(("read library " + filename));
    if (!library.get$isCore() && !library.imports.some((function (li) {
      return li.get$library().get$isCore();
    })
    )) {
      library.imports.add(new LibraryImport(this.corelib));
    }
    this.libraries.$setindex(filename, library);
    this._todo.add(library);
    if (filename == "dart:dom") {
      this.dom = library;
    }
  }
  return library;
}
World.prototype.process = function() {
  while (this._todo.get$length() > (0)) {
    var todo = this._todo;
    this._todo = [];
    for (var $$i = todo.iterator$0(); $$i.hasNext$0(); ) {
      var lib = $$i.next$0();
      lib.visitSources$0();
    }
  }
}
World.prototype.processDartScript = function(script) {
  if (script == null) script = $globals.options.dartScript;
  var library = this.getOrAddLibrary(script);
  this.process();
  return library;
}
World.prototype.resolveAll = function() {
  var $$list = this.libraries.getValues();
  for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
    var lib = $$i.next$0();
    lib.resolve$0();
  }
  var $$list = this.libraries.getValues();
  for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
    var lib = $$i.next$0();
    lib.postResolveChecks$0();
  }
}
World.prototype.get$resolveAll = function() {
  return this.resolveAll.bind(this);
}
World.prototype.findMainMethod = function(lib) {
  var mainMembers = lib.topType.resolveMember("main");
  var main = null;
  if (mainMembers == null || $eq(mainMembers.get$members().get$length(), (0))) {
    this.fatal("no main method specified");
  }
  else if (mainMembers.get$members().get$length() > (1)) {
    var $$list = mainMembers.get$members();
    for (var $$i = $$list.iterator$0(); $$i.hasNext$0(); ) {
      var m = $$i.next$0();
      main = m;
      this.error("more than one main member (using last?)", main.get$span());
    }
  }
  else {
    main = mainMembers.get$members().$index((0));
  }
  return main;
}
World.prototype.generateCode = function(lib) {
  this.gen = new WorldGenerator(this.findMainMethod(lib), new CodeWriter());
  this.gen.run();
  this.frogCode = this.gen.writer.get$text();
  this.jsBytesWritten = this.frogCode.length;
  this.gen = null;
}
World.prototype._message = function(color, prefix, message, span, span1, span2, throwing) {
  if (this.messageHandler != null) {
    this.messageHandler(prefix, message, span);
    if (span1 != null) {
      this.messageHandler(prefix, message, span1);
    }
    if (span2 != null) {
      this.messageHandler(prefix, message, span2);
    }
  }
  else {
    var messageWithPrefix = $globals.options.useColors ? (color + prefix + $globals._NO_COLOR + message) : (prefix + message);
    var text = messageWithPrefix;
    if (span != null) {
      text = span.toMessageString(messageWithPrefix);
    }
    print(text);
    if (span1 != null) {
      print(span1.toMessageString(messageWithPrefix));
    }
    if (span2 != null) {
      print(span2.toMessageString(messageWithPrefix));
    }
  }
  if (throwing) {
    $throw(new CompilerException(prefix + message, span));
  }
}
World.prototype.error = function(message, span, span1, span2) {
  this.errors++;
  this._message($globals._RED_COLOR, "error: ", message, span, span1, span2, $globals.options.throwOnErrors);
}
World.prototype.warning = function(message, span, span1, span2) {
  if ($globals.options.warningsAsErrors) {
    this.error(message, span, span1, span2);
    return;
  }
  this.warnings++;
  if ($globals.options.showWarnings) {
    this._message($globals._MAGENTA_COLOR, "warning: ", message, span, span1, span2, $globals.options.throwOnWarnings);
  }
}
World.prototype.fatal = function(message, span, span1, span2) {
  this.errors++;
  this.seenFatal = true;
  this._message($globals._RED_COLOR, "fatal: ", message, span, span1, span2, $globals.options.throwOnFatal || $globals.options.throwOnErrors);
}
World.prototype.internalError = function(message, span, span1, span2) {
  this._message($globals._NO_COLOR, "We are sorry, but...", message, span, span1, span2, true);
}
World.prototype.info = function(message, span, span1, span2) {
  if ($globals.options.showInfo) {
    this._message($globals._GREEN_COLOR, "info: ", message, span, span1, span2, false);
  }
}
World.prototype.withoutForceDynamic = function(fn) {
  var oldForceDynamic = $globals.options.forceDynamic;
  $globals.options.forceDynamic = false;
  try {
    return fn();
  } finally {
    $globals.options.forceDynamic = oldForceDynamic;
  }
}
World.prototype.get$hasErrors = function() {
  return this.errors > (0);
}
World.prototype.printStatus = function() {
  this.counters.info();
  this.info(("compiled " + this.dartBytesRead + " bytes Dart -> " + this.jsBytesWritten + " bytes JS"));
  if (this.get$hasErrors()) {
    print(("compilation failed with " + this.errors + " errors"));
  }
  else {
    if (this.warnings > (0)) {
      this.info(("compilation completed successfully with " + this.warnings + " warnings"));
    }
    else {
      this.info("compilation completed sucessfully");
    }
  }
}
World.prototype.withTiming = function(name, f) {
  var sw = new StopwatchImplementation();
  sw.start$0();
  var result = f();
  sw.stop$0();
  this.info(("" + name + " in " + sw.elapsedInMs$0() + "msec"));
  return result;
}
// ********** Code for FrogOptions **************
function FrogOptions(homedir, args, files) {
  this.legOnly = false;
  this.throwOnFatal = false;
  this.maxInferenceIterations = (4);
  this.config = "dev";
  this.throwOnWarnings = false;
  this.inferTypes = false;
  this.verifyImplements = false;
  this.warningsAsErrors = false;
  this.enableLeg = false;
  this.enableAsserts = false;
  this.enableTypeChecks = false;
  this.forceDynamic = false;
  this.showInfo = false;
  this.dietParse = false;
  this.useColors = true;
  this.compileOnly = false;
  this.showWarnings = true;
  this.compileAll = false;
  this.throwOnErrors = false;
  if ($eq(this.config, "dev")) {
    this.libDir = joinPaths(homedir, "/lib");
  }
  else if ($eq(this.config, "sdk")) {
    this.libDir = joinPaths(homedir, "/../lib");
  }
  else {
    $globals.world.error(("Invalid configuration " + this.config));
    $throw("Invalid configuration");
  }
  var ignoreUnrecognizedFlags = false;
  var passedLibDir = false;
  this.childArgs = [];
  loop:
  for (var i = (2);
   i < args.get$length(); i++) {
    var arg = args.$index(i);
    switch (arg) {
      case "--enable_leg":

        this.enableLeg = true;
        break;

      case "--leg_only":

        this.enableLeg = true;
        this.legOnly = true;
        break;

      case "--enable_asserts":

        this.enableAsserts = true;
        break;

      case "--enable_type_checks":

        this.enableTypeChecks = true;
        this.enableAsserts = true;
        break;

      case "--verify_implements":

        this.verifyImplements = true;
        break;

      case "--compile_all":

        this.compileAll = true;
        break;

      case "--diet-parse":

        this.dietParse = true;
        break;

      case "--ignore-unrecognized-flags":

        ignoreUnrecognizedFlags = true;
        break;

      case "--verbose":

        this.showInfo = true;
        break;

      case "--suppress_warnings":

        this.showWarnings = false;
        break;

      case "--warnings_as_errors":

        this.warningsAsErrors = true;
        break;

      case "--throw_on_errors":

        this.throwOnErrors = true;
        break;

      case "--throw_on_warnings":

        this.throwOnWarnings = true;
        break;

      case "--compile-only":

        this.compileOnly = true;
        break;

      case "--force_dynamic":

        this.forceDynamic = true;
        break;

      case "--no_colors":

        this.useColors = false;
        break;

      case "--infer_types":

        this.inferTypes = true;
        break;

      default:

        if (arg.endsWith$1(".dart")) {
          this.dartScript = arg;
          this.childArgs = args.getRange(i + (1), args.get$length() - i - (1));
          break loop;
        }
        else if (arg.startsWith$1("--out=")) {
          this.outfile = arg.substring$1("--out=".length);
        }
        else if (arg.startsWith$1("--libdir=")) {
          this.libDir = arg.substring$1("--libdir=".length);
          passedLibDir = true;
        }
        else {
          if (!ignoreUnrecognizedFlags) {
            print(("unrecognized flag: \"" + arg + "\""));
          }
        }

    }
  }
  if (!passedLibDir && $eq(this.config, "dev") && !files.fileExists(this.libDir)) {
    var temp = "frog/lib";
    if (files.fileExists(temp)) {
      this.libDir = temp;
    }
    else {
      this.libDir = "lib";
    }
  }
}
// ********** Code for LibraryReader **************
function LibraryReader() {
  if ($eq($globals.options.config, "dev")) {
    this._specialLibs = _map(["dart:core", joinPaths($globals.options.libDir, "corelib.dart"), "dart:coreimpl", joinPaths($globals.options.libDir, "corelib_impl.dart"), "dart:html", joinPaths($globals.options.libDir, "../../client/html/release/html.dart"), "dart:htmlimpl", joinPaths($globals.options.libDir, "../../client/html/release/htmlimpl.dart"), "dart:dom", joinPaths($globals.options.libDir, "../../client/dom/frog/dom_frog.dart"), "dart:json", joinPaths($globals.options.libDir, "json_frog.dart")]);
  }
  else if ($eq($globals.options.config, "sdk")) {
    this._specialLibs = _map(["dart:core", joinPaths($globals.options.libDir, "core/core_frog.dart"), "dart:coreimpl", joinPaths($globals.options.libDir, "coreimpl/coreimpl_frog.dart"), "dart:html", joinPaths($globals.options.libDir, "html/html.dart"), "dart:htmlimpl", joinPaths($globals.options.libDir, "htmlimpl/htmlimpl.dart"), "dart:dom", joinPaths($globals.options.libDir, "dom/frog/dom_frog.dart"), "dart:json", joinPaths($globals.options.libDir, "json/json_frog.dart")]);
  }
  else {
    $globals.world.error(("Invalid configuration " + $globals.options.config));
  }
}
LibraryReader.prototype.readFile = function(fullname) {
  var filename = this._specialLibs.$index(fullname);
  if (filename == null) {
    filename = fullname;
  }
  if ($globals.world.files.fileExists(filename)) {
    return new SourceFile(filename, $globals.world.files.readAll(filename));
  }
  else {
    $globals.world.error(("File not found: " + filename));
    return new SourceFile(filename, "");
  }
}
// ********** Code for VarMember **************
function VarMember(name) {
  this.isGenerated = false;
  this.name = name;
}
VarMember.prototype.get$name = function() { return this.name; };
VarMember.prototype.get$isGenerated = function() { return this.isGenerated; };
VarMember.prototype.set$isGenerated = function(value) { return this.isGenerated = value; };
VarMember.prototype.get$returnType = function() {
  return $globals.world.varType;
}
VarMember.prototype.invoke = function(context, node, target, args) {
  return new Value(this.get$returnType(), ("" + target.get$code() + "." + this.name + "(" + args.getCode() + ")"), node.span, true);
}
VarMember.prototype.generate$1 = VarMember.prototype.generate;
VarMember.prototype.invoke$4 = VarMember.prototype.invoke;
// ********** Code for VarFunctionStub **************
$inherits(VarFunctionStub, VarMember);
function VarFunctionStub(name, callArgs) {
  this.args = callArgs.toCallStubArgs();
  VarMember.call(this, name);
  $globals.world.functionImplType.markUsed();
  $globals.world.gen.genMethod($globals.world.functionImplType.getMember("_genStub"));
}
VarFunctionStub.prototype.invoke = function(context, node, target, args) {
  return VarMember.prototype.invoke.call(this, context, node, target, args);
}
VarFunctionStub.prototype.generate = function(code) {
  this.isGenerated = true;
  if (this.args.get$hasNames()) {
    this.generateNamed(code);
  }
  else {
    this.generatePositional(code);
  }
}
VarFunctionStub.prototype.generatePositional = function(w) {
  var arity = this.args.get$length();
  w.enterBlock(("Function.prototype.to$" + this.name + " = function() {"));
  w.writeln(("this." + this.name + " = this._genStub(" + arity + ");"));
  w.writeln(("this.to$" + this.name + " = function() { return this." + this.name + "; };"));
  w.writeln(("return this." + this.name + ";"));
  w.exitBlock("};");
  var argsCode = this.args.getCode();
  w.enterBlock(("Function.prototype." + this.name + " = function(" + argsCode + ") {"));
  w.writeln(("return this.to$" + this.name + "()(" + argsCode + ");"));
  w.exitBlock("};");
  w.writeln(("function to$" + this.name + "(f) { return f && f.to$" + this.name + "(); }"));
}
VarFunctionStub.prototype.generateNamed = function(w) {
  var named = Strings.join(this.args.getNames(), "\", \"");
  var argsCode = this.args.getCode();
  w.enterBlock(("Function.prototype." + this.name + " = function(" + argsCode + ") {"));
  w.writeln(("this." + this.name + " = this._genStub(" + this.args.get$length() + ", [\"" + named + "\"]);"));
  w.writeln(("return this." + this.name + "(" + argsCode + ");"));
  w.exitBlock("}");
}
VarFunctionStub.prototype.generate$1 = VarFunctionStub.prototype.generate;
VarFunctionStub.prototype.invoke$4 = VarFunctionStub.prototype.invoke;
// ********** Code for VarMethodStub **************
$inherits(VarMethodStub, VarMember);
function VarMethodStub(name, member, args, body) {
  this.body = body;
  this.member = member;
  this.args = args;
  VarMember.call(this, name);
}
VarMethodStub.prototype.get$body = function() { return this.body; };
VarMethodStub.prototype.get$isHidden = function() {
  return this.member != null ? this.member.declaringType.get$isHiddenNativeType() : false;
}
VarMethodStub.prototype.get$returnType = function() {
  return this.member != null ? this.member.get$returnType() : $globals.world.varType;
}
VarMethodStub.prototype.get$declaringType = function() {
  return this.member != null ? this.member.declaringType : $globals.world.objectType;
}
VarMethodStub.prototype.generate = function(code) {
  this.isGenerated = true;
  if (!this.get$isHidden() && this._useDirectCall(this.args)) {
    $globals.world.gen._writePrototypePatch(this.get$declaringType(), this.name, $globals.world.gen._prototypeOf(this.get$declaringType(), this.member.get$jsname()), code, true);
  }
  else {
    var suffix = $globals.world.gen._writePrototypePatch(this.get$declaringType(), this.name, ("function(" + this.args.getCode() + ") {"), code, false);
    if (!suffix.endsWith(";")) {
      suffix = suffix + ";";
    }
    if (this._needsExactTypeCheck()) {
      code.enterBlock(("if (Object.getPrototypeOf(this).hasOwnProperty(\"" + this.name + "\")) {"));
      code.writeln(("" + this.body + ";"));
      code.exitBlock("}");
      var argsCode = this.args.getCode();
      if (argsCode != "") argsCode = ", " + argsCode;
      code.writeln(("return Object.prototype." + this.name + ".call(this" + argsCode + ");"));
      code.exitBlock(suffix);
    }
    else {
      code.writeln(("" + this.body + ";"));
      code.exitBlock(suffix);
    }
  }
}
VarMethodStub.prototype._needsExactTypeCheck = function() {
  var $this = this; // closure support
  if (this.member == null || this.member.declaringType.get$isObject()) return false;
  var members = this.member.declaringType.resolveMember(this.member.name).members;
  return members.filter$1((function (m) {
    return $ne(m, $this.member) && m.get$declaringType().get$isHiddenNativeType();
  })
  ).get$length() >= (1);
}
VarMethodStub.prototype._useDirectCall = function(args) {
  if ((this.member instanceof MethodMember) && !this.member.declaringType.get$hasNativeSubtypes()) {
    var method = this.member;
    if (method.needsArgumentConversion(args)) {
      return false;
    }
    for (var i = args.get$length();
     i < method.parameters.get$length(); i++) {
      if ($ne(method.parameters.$index(i).get$value().get$code(), "null")) {
        return false;
      }
    }
    return method.namesInHomePositions(args);
  }
  else {
    return false;
  }
}
VarMethodStub.prototype.generate$1 = VarMethodStub.prototype.generate;
// ********** Code for VarMethodSet **************
$inherits(VarMethodSet, VarMember);
function VarMethodSet(baseName, name, members, callArgs, returnType) {
  this.args = callArgs.toCallStubArgs();
  this.invoked = false;
  this.baseName = baseName;
  this.members = members;
  this.returnType = returnType;
  VarMember.call(this, name);
}
VarMethodSet.prototype.get$members = function() { return this.members; };
VarMethodSet.prototype.get$returnType = function() { return this.returnType; };
VarMethodSet.prototype.invoke = function(context, node, target, args) {
  this._invokeMembers(context, node);
  return VarMember.prototype.invoke.call(this, context, node, target, args);
}
VarMethodSet.prototype._invokeMembers = function(context, node) {
  if (this.invoked) return;
  this.invoked = true;
  var hasObjectType = false;
  var $$list = this.members;
  for (var $$i = 0;$$i < $$list.get$length(); $$i++) {
    var member = $$list.$index($$i);
    var type = member.get$declaringType();
    var target = new Value(type, "this", node.span, true);
    var result = member.invoke$4$isDynamic(context, node, target, this.args, true);
    var stub = new VarMethodStub(this.name, member, this.args, "return " + result.get$code());
    type.get$varStubs().$setindex(stub.get$name(), stub);
    if (type.get$isObject()) hasObjectType = true;
  }
  if (!hasObjectType) {
    var target = new Value($globals.world.objectType, "this", node.span, true);
    var result = target.invokeNoSuchMethod$4(context, this.baseName, node, this.args);
    var stub = new VarMethodStub(this.name, null, this.args, "return " + result.get$code());
    $globals.world.objectType.varStubs.$setindex(stub.get$name(), stub);
  }
}
VarMethodSet.prototype.generate = function(code) {

}
VarMethodSet.prototype.generate$1 = VarMethodSet.prototype.generate;
VarMethodSet.prototype.invoke$4 = VarMethodSet.prototype.invoke;
// ********** Code for top level **************
function _otherOperator(jsname, op) {
  return ("function " + jsname + "(x, y) {\n  return (typeof(x) == 'number' && typeof(y) == 'number')\n    ? x " + op + " y : x." + jsname + "(y);\n}");
}
function map(source, mapper) {
  var result = new Array();
  if (!!(source && source.is$List())) {
    var list = source;
    result.set$length(list.get$length());
    for (var i = (0);
     i < list.get$length(); i++) {
      result.$setindex(i, mapper(list.$index(i)));
    }
  }
  else {
    for (var $$i = source.iterator(); $$i.hasNext$0(); ) {
      var item = $$i.next$0();
      result.add(mapper(item));
    }
  }
  return result;
}
function reduce(source, callback, initialValue) {
  var i = source.iterator();
  var current = initialValue;
  if (current == null && i.hasNext$0()) {
    current = i.next$0();
  }
  while (i.hasNext$0()) {
    current = callback.call$2(current, i.next$0());
  }
  return current;
}
function orderValuesByKeys(map) {
  var keys = map.getKeys();
  keys.sort((function (x, y) {
    return x.compareTo$1(y);
  })
  );
  var values = [];
  for (var $$i = 0;$$i < keys.get$length(); $$i++) {
    var k = keys.$index($$i);
    values.add$1(map.$index(k));
  }
  return values;
}
var world;
var experimentalAwaitPhase;
var legCompile;
function initializeWorld(files) {
  $globals.world = new World(files);
  $globals.world.init();
}
function compile(homedir, args, files) {
  parseOptions(homedir, args, files);
  initializeWorld(files);
  return $globals.world.compileAndSave();
}
var options;
function parseOptions(homedir, args, files) {
  $globals.options = new FrogOptions(homedir, args, files);
}
function _getCallStubName(name, args) {
  var nameBuilder = new StringBufferImpl(("" + name + "$" + args.get$bareCount()));
  for (var i = args.get$bareCount();
   i < args.get$length(); i++) {
    var name0 = args.getName(i);
    nameBuilder.add$1("$");
    if (name0.contains$1("$")) {
      nameBuilder.add$1(("" + name0.get$length()));
    }
    nameBuilder.add$1(name0);
  }
  return nameBuilder.toString$0();
}
//  ********** Library minfrog **************
// ********** Code for top level **************
function main() {
  var homedir = path.dirname(fs.realpathSync(get$process().get$argv().$index((1))));
  var argv = [];
  for (var i = (0);
   i < get$process().get$argv().get$length(); i++) {
    argv.add$1(get$process().get$argv().$index(i));
    if (i == (1)) {
      var terminal = get$process().get$env().$index("TERM");
      if (terminal == null || !terminal.startsWith$1("xterm")) {
        argv.add$1("--no_colors");
      }
    }
  }
  if (compile(homedir, argv, new NodeFileSystem())) {
    var code = $globals.world.getGeneratedCode();
    if ($globals.options.compileOnly) {
      if ($globals.options.outfile != null) {
        print(("Compilation succeded. Code generated in: " + $globals.options.outfile));
      }
      else {
        print("Compilation succeded.");
      }
    }
    else {
      get$process().set$argv([argv.$index((0)), argv.$index((1))]);
      get$process().get$argv().addAll($globals.options.childArgs);
      vm.runInNewContext(code, createSandbox());
    }
  }
  else {
    get$process().exit((1));
  }
}
// ********** Generic Type Inheritance **************
/** Implements extends for generic types. */
function $inheritsMembers(child, parent) {
  child = child.prototype;
  parent = parent.prototype;
  Object.getOwnPropertyNames(parent).forEach(function(name) {
    if (typeof(child[name]) == 'undefined') child[name] = parent[name];
  });
}
$inheritsMembers(_DoubleLinkedQueueEntrySentinel_E, DoubleLinkedQueueEntry_E);
$inheritsMembers(_DoubleLinkedQueueEntrySentinel_KeyValuePair_K$V, DoubleLinkedQueueEntry_KeyValuePair_K$V);
$inheritsMembers(_SharedBackingMap_K$V, HashMapImplementation_K$V);
$inheritsMembers(_SharedBackingMap_dart_core_String$Value, HashMapImplementation_dart_core_String$Value);
// 1 dynamic types.
// 1 types
// 0 !leaf
//  ********** Globals **************
function $static_init(){
  $globals._GREEN_COLOR = "\x1b[32m";
  $globals._MAGENTA_COLOR = "\x1b[35m";
  $globals._NO_COLOR = "\x1b[0m";
  $globals._RED_COLOR = "\x1b[31m";
}
var const$0000 = Object.create(EmptyQueueException.prototype, {});
var const$0001 = Object.create(_DeletedKeySentinel.prototype, {});
var const$0005 = Object.create(NoMoreElementsException.prototype, {});
var const$0007 = Object.create(IllegalAccessException.prototype, {});
var const$0008 = ImmutableList.ImmutableList$from$factory([]);
var $globals = {};
$static_init();
main();
